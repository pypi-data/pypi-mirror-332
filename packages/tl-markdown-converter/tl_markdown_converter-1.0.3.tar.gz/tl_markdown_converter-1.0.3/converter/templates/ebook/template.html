<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <!-- 外部CSS将在此处通过链接标签插入 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap">
</head>
<body>
    <!-- 阅读进度条 -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div class="book-container">
        <!-- 侧边导航栏 -->
        <aside class="book-sidebar">
            <div class="book-info">
                <h2 class="toc-title">{{ book_title }}</h2>
                <div class="book-meta">
                    {% if author %}
                    <div class="book-author">{{ author }}</div>
                    {% endif %}
                </div>
            </div>
            
            <!-- 目录 -->
            <nav>
                <ul class="toc">
                    {% if chapters %}
                    {% for chapter in chapters %}
                    <li {% if chapter.current %}class="current-chapter"{% endif %}>
                        <a href="{{ chapter.link }}">{{ chapter.title }}</a>
                    </li>
                    {% endfor %}
                    {% else %}
                    <!-- 默认目录 -->
                    <li><a href="#chapter1">第一章</a></li>
                    <li><a href="#chapter2">第二章</a></li>
                    <li><a href="#chapter3">第三章</a></li>
                    {% endif %}
                </ul>
            </nav>
        </aside>
        
        <!-- 主要内容 -->
        <main class="book-content">
            <!-- 正文内容 -->
            <div class="chapter" id="current-chapter">
                {% if title %}
                <h1>{{ title }}</h1>
                {% endif %}
                
                {{ content }}
            </div>
            
            <!-- 页脚 -->
            <footer class="book-footer">
                <div class="chapter-navigation">
                    {% if prev_chapter %}
                    <a href="{{ prev_chapter.link }}" class="prev-chapter">上一章: {{ prev_chapter.title }}</a>
                    {% endif %}
                    
                    {% if next_chapter %}
                    <a href="{{ next_chapter.link }}" class="next-chapter">下一章: {{ next_chapter.title }}</a>
                    {% endif %}
                </div>
            </footer>
        </main>
    </div>
    
    <!-- 主题切换按钮 -->
    <div class="theme-toggle" id="themeToggle">
        <span>☀</span>
    </div>
    
    <!-- 字体大小控制 -->
    <div class="font-controls">
        <div class="font-control" id="fontDecrease">A-</div>
        <div class="font-control" id="fontIncrease">A+</div>
    </div>
    
    <script>
        // 阅读进度条
        window.addEventListener('scroll', function() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
        });
        
        // 主题切换
        const themeToggle = document.getElementById('themeToggle');
        let isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        themeToggle.addEventListener('click', function() {
            document.body.classList.toggle('dark-theme');
            isDarkMode = !isDarkMode;
            themeToggle.innerHTML = isDarkMode ? '<span>☀</span>' : '<span>☾</span>';
        });
        
        // 初始化主题
        if (isDarkMode) {
            document.body.classList.add('dark-theme');
            themeToggle.innerHTML = '<span>☀</span>';
        } else {
            themeToggle.innerHTML = '<span>☾</span>';
        }
        
        // 字体大小调整
        const fontIncrease = document.getElementById('fontIncrease');
        const fontDecrease = document.getElementById('fontDecrease');
        let currentFontSize = parseInt(getComputedStyle(document.body).fontSize);
        
        fontIncrease.addEventListener('click', function() {
            if (currentFontSize < 24) {
                currentFontSize += 1;
                document.body.style.fontSize = currentFontSize + 'px';
            }
        });
        
        fontDecrease.addEventListener('click', function() {
            if (currentFontSize > 14) {
                currentFontSize -= 1;
                document.body.style.fontSize = currentFontSize + 'px';
            }
        });
    </script>
</body>
</html> 