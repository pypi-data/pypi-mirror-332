import{g as de,p as me,cd as Ue,j as Ve,t as B,m as Ne,k as We,A as ce,B as t,an as L,F as Ge,K as Te,ce as Pe,J as Fe,N as fe,c8 as $e,ad as Qe,s as je,x as H,w as W,a as ne,I as qe,ae as Ke,h as Xe,ai as Ye,f as Je,z as Ze,c as j,H as el,al as ll,cf as tl,Q as te,ah as Ae,R as S,S as V,U as a,Z as le,as as Z,bF as G,ao as C,ab as $,G as se,$ as De,az as al,a3 as nl,bx as sl,by as pe,a8 as E,a7 as Q,W as J,cg as b,o as ke,a9 as D,ch as Ce,a0 as F,bo as il,bq as ie,P as ol,bt as rl,ci as N,l as ul,b4 as dl,a4 as oe,b0 as ml,bz as cl,bG as fl}from"./index-Dgb2Jv0W.js";import{a as O}from"./VBtn-DuScqEn1.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as pl}from"./VSlider-D58wYNEc.js";import{V as vl}from"./VTextField-ERCRwdIS.js";import{V as Oe}from"./VContainer-K2Wdm5wk.js";import{V as we,a as re}from"./VRow-JDKZEIW_.js";import{V as ue,a as xe}from"./VSwitch-DM3Rm0eZ.js";import{V as Ee}from"./VSpacer-BOxMbL4y.js";import{V as he,a as Se}from"./VToolbar-1AtlnPW5.js";import{V as gl}from"./VDialog-YxDgK53D.js";import{V as yl}from"./VAlert-D-qqP7Pv.js";import"./VCheckboxBtn-CmCi1_nS.js";/* empty css              */import"./VVirtualScroll-Dsnd1ROl.js";const bl=me({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:$e,iconColor:String,lineColor:String,...fe(),...Fe(),...Pe(),...Te()},"VTimelineDivider"),_l=de()({name:"VTimelineDivider",props:bl(),setup(l,_){let{slots:m}=_;const{sizeClasses:o,sizeStyles:i}=Ue(l,"v-timeline-divider__dot"),{backgroundColorStyles:h,backgroundColorClasses:T}=Ve(B(l,"dotColor")),{roundedClasses:c}=Ne(l,"v-timeline-divider__dot"),{elevationClasses:k}=We(l),{backgroundColorClasses:f,backgroundColorStyles:q}=Ve(B(l,"lineColor"));return ce(()=>t("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":l.fillDot},l.class],style:l.style},[t("div",{class:["v-timeline-divider__before",f.value],style:q.value},null),!l.hideDot&&t("div",{key:"dot",class:["v-timeline-divider__dot",k.value,c.value,o.value],style:i.value},[t("div",{class:["v-timeline-divider__inner-dot",T.value,c.value],style:h.value},[m.default?t(Ge,{key:"icon-defaults",disabled:!l.icon,defaults:{VIcon:{color:l.iconColor,icon:l.icon,size:l.size}}},m.default):t(L,{key:"icon",color:l.iconColor,icon:l.icon,size:l.size},null)])]),t("div",{class:["v-timeline-divider__after",f.value],style:q.value},null)])),{}}}),He=me({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:$e,iconColor:String,lineInset:[Number,String],...fe(),...Ke(),...Te(),...Fe(),...Pe(),...qe()},"VTimelineItem"),Y=de()({name:"VTimelineItem",props:He(),setup(l,_){let{slots:m}=_;const{dimensionStyles:o}=Qe(l),i=je(0),h=H();return W(h,T=>{var c;T&&(i.value=((c=T.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:c.getBoundingClientRect().width)??0)},{flush:"post"}),ce(()=>{var T,c;return t("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":l.fillDot},l.class],style:[{"--v-timeline-dot-size":ne(i.value),"--v-timeline-line-inset":l.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${ne(l.lineInset)})`:ne(0)},l.style]},[t("div",{class:"v-timeline-item__body",style:o.value},[(T=m.default)==null?void 0:T.call(m)]),t(_l,{ref:h,hideDot:l.hideDot,icon:l.icon,iconColor:l.iconColor,size:l.size,elevation:l.elevation,dotColor:l.dotColor,fillDot:l.fillDot,rounded:l.rounded},{default:m.icon}),l.density!=="compact"&&t("div",{class:"v-timeline-item__opposite"},[!l.hideOpposite&&((c=m.opposite)==null?void 0:c.call(m))])])}),{}}}),Vl=me({align:{type:String,default:"center",validator:l=>["center","start"].includes(l)},direction:{type:String,default:"vertical",validator:l=>["vertical","horizontal"].includes(l)},justify:{type:String,default:"auto",validator:l=>["auto","center"].includes(l)},side:{type:String,validator:l=>l==null||["start","end"].includes(l)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:l=>["start","end","both"].includes(l)},...tl(He({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...fe(),...ll(),...qe(),...el()},"VTimeline"),kl=de()({name:"VTimeline",props:Vl(),setup(l,_){let{slots:m}=_;const{themeClasses:o}=Xe(l),{densityClasses:i}=Ye(l),{rtlClasses:h}=Je();Ze({VTimelineDivider:{lineColor:B(l,"lineColor")},VTimelineItem:{density:B(l,"density"),dotColor:B(l,"dotColor"),fillDot:B(l,"fillDot"),hideOpposite:B(l,"hideOpposite"),iconColor:B(l,"iconColor"),lineColor:B(l,"lineColor"),lineInset:B(l,"lineInset"),size:B(l,"size")}});const T=j(()=>{const k=l.side?l.side:l.density!=="default"?"end":null;return k&&`v-timeline--side-${k}`}),c=j(()=>{const k=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(l.truncateLine){case"both":return k;case"start":return k[0];case"end":return k[1];default:return null}});return ce(()=>t(l.tag,{class:["v-timeline",`v-timeline--${l.direction}`,`v-timeline--align-${l.align}`,`v-timeline--justify-${l.justify}`,c.value,{"v-timeline--inset-line":!!l.lineInset},o.value,i.value,T.value,h.value,l.class],style:[{"--v-timeline-line-thickness":ne(l.lineThickness)},l.style]},m)),{}}}),Cl=te({__name:"DSPPipeline",props:{dsp:{},selected:{}},emits:["onSelect","onAddFilter","onMoveFilter","onDeleteFilter"],setup(l,{emit:_}){const m=Ae(),o=l,i=_,h=v=>o.selected===v?"primary":"secondary",T=v=>v==="input"||v==="output"?!1:!o.dsp.filters[v].enabled,c=v=>o.selected===v?"primary":m.global.current.value.dark?"grey-darken-3":"grey-lighten-3",k=v=>({"filter-selected":o.selected===v}),f=v=>{i("onSelect",v)},q=(v,p)=>{i("onMoveFilter",{index:v,direction:p})},z=v=>{i("onDeleteFilter",v)},K=function(v,p){const P=[{label:"settings.dsp.move_up",labelArgs:[],action:()=>{q(p,"up")},disabled:p===0,icon:"mdi-arrow-up"},{label:"settings.dsp.move_down",labelArgs:[],action:()=>{q(p,"down")},disabled:p===o.dsp.filters.length-1,icon:"mdi-arrow-down"},{label:"settings.dsp.delete_filter",labelArgs:[],action:()=>{z(p)},icon:"mdi-delete"}];nl.emit("contextmenu",{items:P,posX:v.clientX,posY:v.clientY})};return(v,p)=>(V(),S(kl,{density:"compact",side:"end"},{default:a(()=>[t(Y,{"dot-color":h("input"),size:"x-small",onClick:p[0]||(p[0]=P=>f("input"))},{default:a(()=>[t(O,{flat:"",rounded:"pill",color:c("input"),class:Z([k("input"),"dsp-pipeline-card"])},{default:a(()=>[t(G,{class:"px-3 py-1"},{default:a(()=>[C($(v.$t("settings.dsp.input")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"]),t(Y,{"hide-dot":!0,size:"x-small"}),(V(!0),le(se,null,De(v.dsp.filters,(P,w)=>(V(),S(Y,{key:w,"dot-color":h(w),size:"x-small","hide-dot":T(w),onClick:u=>f(w),onContextmenu:al(u=>K(u,w),["prevent"])},{default:a(()=>[t(O,{flat:"",rounded:"pill",color:c(w),class:Z([k(w),"dsp-pipeline-card"])},{default:a(()=>[t(G,{class:"px-3 py-1"},{default:a(()=>[C($(v.$t(`settings.dsp.types.${P.type}`)),1)]),_:2},1024)]),_:2},1032,["color","class"])]),_:2},1032,["dot-color","hide-dot","onClick","onContextmenu"]))),128)),t(Y,{"dot-color":"secondary",size:"x-small","hide-dot":!0},{default:a(()=>[t(O,{outlined:"",rounded:"pill",class:"dsp-pipeline-card add-filter-btn",elevation:0,onClick:p[1]||(p[1]=P=>i("onAddFilter"))},{default:a(()=>[t(G,{class:"py-1 d-flex align-center"},{default:a(()=>[t(L,{size:"small",class:"mr-1"},{default:a(()=>p[3]||(p[3]=[C("mdi-plus")])),_:1}),C(" "+$(v.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1}),t(Y,{"hide-dot":!0,size:"x-small"}),t(Y,{"dot-color":h("output"),size:"x-small",onClick:p[2]||(p[2]=P=>f("output"))},{default:a(()=>[t(O,{flat:"",rounded:"pill",color:c("output"),class:Z([k("output"),"dsp-pipeline-card"])},{default:a(()=>[t(G,{class:"px-3 py-1"},{default:a(()=>[C($(v.$t("settings.dsp.output")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"])]),_:1}))}}),hl=Ie(Cl,[["__scopeId","data-v-f292f100"]]),Sl={style:{"min-width":"100px"},class:"v-label pl-2"},Tl={style:{"min-width":"40px"},class:"pl-2"},U=te({__name:"DSPSlider",props:sl({type:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const _=l,m=pe(l,"modelValue"),o=H(!1),i=j(()=>_.type==="gain"?{min:-15,max:15,step:.1,label:E("settings.dsp.parameter.gain"),unit:"dB"}:_.type==="q"?{min:.1,max:20,step:.1,label:E("settings.dsp.parameter.q_factor"),unit:""}:_.type==="frequency"?{min:20,max:2e4,step:1,label:E("settings.dsp.parameter.frequency"),unit:"Hz"}:_.type),h=j({get:()=>o.value?m.value.toString():m.value>1e3?m.value.toFixed(0):m.value>100?m.value.toFixed(1):m.value.toFixed(2),set:T=>{m.value=Number(T)}});return(T,c)=>(V(),S(Q,{flat:"",color:"transparent"},{default:a(()=>[t(G,{class:"d-flex align-center gap-4"},{default:a(()=>[J("span",Sl,$(i.value.label),1),t(pl,{modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=k=>m.value=k),min:i.value.min,max:i.value.max,step:i.value.step,"hide-details":"",class:"flex-grow-1 pr-4",density:"compact",color:"primary"},null,8,["modelValue","min","max","step"]),t(vl,{modelValue:h.value,"onUpdate:modelValue":c[1]||(c[1]=k=>h.value=k),type:"number","hide-details":"",density:"compact",style:{"max-width":"100px"},onFocus:c[2]||(c[2]=k=>o.value=!0),onBlur:c[3]||(c[3]=k=>o.value=!1)},null,8,["modelValue"]),J("span",Tl,$(i.value.unit),1)]),_:1})]),_:1}))}}),Pl={class:"d-flex align-center"},Fl=te({__name:"DSPParametricEQ",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const _={PK:b.PEAK,PEQ:b.PEAK,HP:b.HIGH_PASS,HPQ:b.HIGH_PASS,LP:b.LOW_PASS,LPQ:b.LOW_PASS,LS:b.LOW_SHELF,HS:b.HIGH_SHELF,NO:b.NOTCH},m={[b.PEAK]:"PK",[b.HIGH_PASS]:"HP",[b.LOW_PASS]:"LP",[b.LOW_SHELF]:"LS",[b.HIGH_SHELF]:"HS",[b.NOTCH]:"NO"},o=s=>{const e=s.split(`
`),r=[];f.value.preamp=0;for(const g of e)if(g.startsWith("Filter")){const y=g.match(/Filter(?:\s+\d+)?:\s+(ON|OFF)\s+(\w+)\s+(?:Fc\s+)?(\d+\.?\d*)\s*(?:Hz)?\s+(?:Gain\s+)?(-?\d+\.?\d*)\s+dB\s+(?:(?:Q\s+)?(\d+\.?\d*)|(?:BW\s+Oct\s+)(\d+\.?\d*))/);if(y){const[I,M,X,A,R,ge,ye]=y;X!=="None"&&r.push({frequency:parseFloat(A),gain:parseFloat(R),q:parseFloat(ge),type:_[X]||b.PEAK,enabled:M==="ON"})}}else if(g.startsWith("Preamp")){const y=g.match(/Preamp:\s*(-?\d+\.?\d*)\s+dB/);y&&(f.value.preamp=parseFloat(y[1]))}f.value.bands=r,n.value=-1},i=s=>{const e=s.target;if(e.files&&e.files[0]){const r=e.files[0],g=new FileReader;g.onload=y=>{var I;(I=y.target)!=null&&I.result&&o(y.target.result)},g.readAsText(r)}},h=H(null),T=()=>{var s;(s=h.value)==null||s.click()},c=()=>{let s=`Preamp: ${ee.value.toFixed(2)} dB
`;f.value.bands.forEach((y,I)=>{const M=m[y.type];s+=`Filter ${I+1}: ${y.enabled?"ON":"OFF"} ${M} Fc ${y.frequency.toFixed(1)} Hz Gain ${y.gain.toFixed(2)} dB Q ${y.q.toFixed(3)}
`});const e=new Blob([s],{type:"text/plain"}),r=URL.createObjectURL(e),g=document.createElement("a");g.href=r,g.download=`music_assistant_eq_settings_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(r)},k=Ae(),f=pe(l,"modelValue"),q=H(null),z=H(null),K=Object.values(b).map(s=>({title:E(`settings.dsp.parametric_eq.filter_types.${s}`),value:s})),v=s=>![b.HIGH_PASS,b.LOW_PASS,b.NOTCH].includes(s),p=H({width:0,height:0,min_gain:-20,max_gain:20,min_freq:20,max_freq:2e4,padding_lr:40,padding_tb:20}),P=()=>{if(!q.value||!z.value)return;const s=k.global.current.value.dark,e=q.value.getContext("2d");if(!e)return;q.value.width=z.value.clientWidth*2,q.value.height=z.value.clientHeight*2,p.value.width=q.value.width/2,p.value.height=q.value.height/2,e.scale(2,2),e.clearRect(0,0,q.value.width,q.value.height),Le(e,p.value);const r=e.canvas.width/2;e.canvas.height/2;const g=new Float32Array(r).fill(f.value.preamp??0);f.value.bands.forEach((y,I)=>{if(y.enabled){let M=`hsla(${I*360/f.value.bands.length}, 60%, ${s?70:50}%, 0.5)`;e.beginPath(),I===n.value?(e.lineWidth=5,M=`hsla(${I*360/f.value.bands.length}, 70%, ${s?70:60}%, 1)`):e.lineWidth=2,e.strokeStyle=M;const X=new Float32Array(r);for(let x=0;x<r;x++)X[x]=ze(x,p.value);const A=new Float32Array(r),R=new Float32Array(r);w(u,y).getFrequencyResponse(X,A,R);for(let x=p.value.padding_lr;x<r-p.value.padding_lr;x++){const be=20*Math.log10(A[x]);g[x]+=be;const _e=ae(be,p.value);x===0?e.moveTo(x,_e):e.lineTo(x,_e)}e.stroke();const ye=ve(y.frequency,p.value),Me=ae(y.gain,p.value);e.beginPath(),e.fillStyle=M,e.arc(ye,Me,6,0,2*Math.PI),e.fill()}}),e.lineWidth=2,s?e.strokeStyle="#fff":e.strokeStyle="#000",e.beginPath();for(let y=p.value.padding_lr;y<r-p.value.padding_lr;y++){const I=ae(g[y],p.value);y===0?e.moveTo(y,I):e.lineTo(y,I)}e.stroke()},w=(s,e)=>{const r=s.createBiquadFilter();switch(e.type){case b.HIGH_PASS:r.type="highpass";break;case b.LOW_PASS:r.type="lowpass";break;case b.HIGH_SHELF:r.type="highshelf";break;case b.LOW_SHELF:r.type="lowshelf";break;case b.NOTCH:r.type="notch";break;case b.PEAK:r.type="peaking";break}return r.frequency.value=e.frequency,r.Q.value=e.q,r.gain.value=e.gain,r},u=new AudioContext;j(()=>f.value.bands.map(s=>w(u,s)));const n=H(-1),d=j(()=>f.value.bands[n.value]),ee=j({get:()=>f.value.preamp??0,set:s=>{f.value.preamp=s}}),Re=s=>{f.value.bands.splice(s,1),n.value>=f.value.bands.length&&(n.value=f.value.bands.length-1)},Be=()=>{const s=f.value.bands.length;f.value.bands.push({frequency:1e3,q:1,gain:0,type:b.PEAK,enabled:!0}),ol(()=>{n.value=s})};W(()=>f.value.bands,P,{deep:!0}),W(()=>f.value.preamp,P),W(()=>n.value,P),W(()=>k.global.current.value.dark,P),ke(()=>{P(),window.addEventListener("resize",P)});const ve=(s,e)=>{const r=Math.log2(s/e.min_freq),g=Math.log2(e.max_freq/e.min_freq);return r/g*(e.width-e.padding_lr*2)+e.padding_lr},ze=(s,e)=>{const r=Math.log2(e.max_freq/e.min_freq),g=e.min_freq*Math.pow(2,(s-e.padding_lr)/(e.width-e.padding_lr*2)*r);return Math.min(Math.max(g,e.min_freq),e.max_freq)},ae=(s,e)=>e.height/2-s*(e.height-2*e.padding_tb)/(2*Math.max(Math.abs(e.min_gain),Math.abs(e.max_gain))),Le=(s,e)=>{const r=s.canvas.width/2,g=s.canvas.height/2;k.global.current.value.dark?(s.fillStyle="#eee",s.strokeStyle="#eee"):(s.fillStyle="#222",s.strokeStyle="#666"),s.lineWidth=1,[20,50,100,200,500,1e3,2e3,5e3,1e4,2e4].forEach(A=>{const R=ve(A,e);s.beginPath(),s.moveTo(R,e.padding_tb),s.lineTo(R,g-e.padding_tb),s.stroke(),s.font="10px Arial",s.textAlign="center",s.fillText(A>=1e3?`${A/1e3}k`:A.toString(),R,g-5)});const M=e.max_gain-e.min_gain,X=Math.ceil(M/(e.height/30));for(let A=e.min_gain;A<=e.max_gain;A+=X){const R=ae(A,e);s.beginPath(),s.moveTo(e.padding_lr,R),s.lineTo(r-e.padding_lr,R),s.stroke(),s.font="10px Arial",s.textAlign="right",s.fillText(`${A}dB`,e.padding_lr-3,R+3)}};return ke(()=>{const s=new ResizeObserver(()=>{P()});return z.value&&s.observe(z.value),()=>{s.disconnect()}}),(s,e)=>(V(),S(Oe,{class:"pa-2"},{default:a(()=>[t(Ce,{class:"d-flex justify-end"},{default:a(()=>[t(O,{variant:"outlined",class:"mr-2",onClick:T},{default:a(()=>[t(L,{start:""},{default:a(()=>e[8]||(e[8]=[C("mdi-file-import")])),_:1}),C(" "+$(F(E)("settings.dsp.parametric_eq.import_apo")),1)]),_:1}),t(O,{variant:"outlined",class:"mr-2",onClick:c},{default:a(()=>[t(L,{start:""},{default:a(()=>e[9]||(e[9]=[C("mdi-file-export")])),_:1}),C(" "+$(F(E)("settings.dsp.parametric_eq.export_apo")),1)]),_:1}),J("input",{ref_key:"fileInputRef",ref:h,type:"file",accept:".txt",class:"d-none",onChange:i},null,544)]),_:1}),t(Q,{elevation:"0",color:"transparent"},{default:a(()=>[J("div",{ref_key:"graphContainer",ref:z,class:"graph-container"},[J("canvas",{ref_key:"canvas",ref:q,class:"frequency-graph"},null,512)],512)]),_:1}),t(Q,{elevation:"0",color:"transparent",class:"border-t border-b rounded-0"},{default:a(()=>[t(G,{class:"pa-0"},{default:a(()=>[t(il,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),class:"mb-0 pa-2",mandatory:"","selected-class":"primary"},{default:a(()=>[(V(),S(ie,{key:-1,value:-1,filter:"",variant:"elevated"},{default:a(()=>[C($(F(E)("settings.dsp.parametric_eq.preamp",{index:100})),1)]),_:1})),(V(!0),le(se,null,De(f.value.bands,(r,g)=>(V(),S(ie,{key:g,value:g,class:Z({"opacity-50":!r.enabled}),filter:"",variant:"elevated"},{default:a(()=>[C($(F(E)("settings.dsp.parametric_eq.band",{index:g+1})),1)]),_:2},1032,["value","class"]))),128)),t(ie,{variant:"outlined",onClick:Be},{default:a(()=>[t(L,{icon:"mdi-plus",start:""}),C(" "+$(F(E)("settings.dsp.parametric_eq.add_band")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n.value===-1?(V(),S(Q,{key:0,elevation:"0",color:"transparent"},{default:a(()=>[t(G,null,{default:a(()=>[t(we,{dense:""},{default:a(()=>[t(re,{cols:"12"},{default:a(()=>[t(U,{modelValue:ee.value,"onUpdate:modelValue":e[1]||(e[1]=r=>ee.value=r),type:"gain"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0),d.value?(V(),le(se,{key:1},[t(Ce,null,{default:a(()=>[J("div",Pl,[t(ue,{modelValue:d.value.enabled,"onUpdate:modelValue":e[2]||(e[2]=r=>d.value.enabled=r),label:F(E)("settings.dsp.parametric_eq.enable_band"),density:"comfortable","hide-details":"",color:"primary"},null,8,["modelValue","label"]),t(Ee),t(O,{color:"error",variant:"tonal",onClick:e[3]||(e[3]=r=>Re(n.value))},{default:a(()=>[t(L,null,{default:a(()=>e[10]||(e[10]=[C("mdi-delete")])),_:1}),C(" "+$(F(E)("settings.dsp.parametric_eq.delete_band")),1)]),_:1})])]),_:1}),t(xe,{modelValue:d.value.type,"onUpdate:modelValue":e[4]||(e[4]=r=>d.value.type=r),items:F(K),label:F(E)("settings.dsp.parametric_eq.filter_type"),variant:"outlined",density:"comfortable",class:"pa-4","hide-details":""},null,8,["modelValue","items","label"]),t(U,{modelValue:d.value.frequency,"onUpdate:modelValue":e[5]||(e[5]=r=>d.value.frequency=r),type:"frequency"},null,8,["modelValue"]),v(d.value.type)?(V(),S(U,{key:0,modelValue:d.value.gain,"onUpdate:modelValue":e[6]||(e[6]=r=>d.value.gain=r),type:"gain"},null,8,["modelValue"])):D("",!0),t(U,{modelValue:d.value.q,"onUpdate:modelValue":e[7]||(e[7]=r=>d.value.q=r),type:"q"},null,8,["modelValue"])],64)):D("",!0)]),_:1}))}}),$l=Ie(Fl,[["__scopeId","data-v-abba8e6b"]]),ql=te({__name:"DSPToneControl",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const _=pe(l,"modelValue");return(m,o)=>(V(),le(se,null,[t(U,{modelValue:_.value.bass_level,"onUpdate:modelValue":o[0]||(o[0]=i=>_.value.bass_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.bass_level"),unit:"dB"}},null,8,["modelValue","type"]),t(U,{modelValue:_.value.mid_level,"onUpdate:modelValue":o[1]||(o[1]=i=>_.value.mid_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.mid_level"),unit:"dB"}},null,8,["modelValue","type"]),t(U,{modelValue:_.value.treble_level,"onUpdate:modelValue":o[2]||(o[2]=i=>_.value.treble_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.treble_level"),unit:"dB"}},null,8,["modelValue","type"])],64))}}),Al={key:0},Gl=te({__name:"EditPlayerDsp",props:{playerId:{}},setup(l){const{t:_}=rl();fl();const m=l,o=H(),i=H(null),h=H(!1),T=H(N.PARAMETRIC_EQ);H(window.innerWidth);const{mobile:c}=ul(),k=Object.values(N).map(u=>({value:u,title:_(`settings.dsp.types.${u}`)})),f=u=>{i.value=u},q=u=>{var n;return _(u==="input"?"settings.dsp.input":u==="output"?"settings.dsp.output":`settings.dsp.types.${(n=o.value)==null?void 0:n.filters[u].type}`)},z=()=>{if(!o.value)return;let u;switch(T.value){case N.PARAMETRIC_EQ:u={preamp:0,enabled:!0,type:N.PARAMETRIC_EQ,bands:[]};break;case N.TONE_CONTROL:u={enabled:!0,type:N.TONE_CONTROL,bass_level:0,mid_level:0,treble_level:0};break;default:return}o.value.filters.push(u),h.value=!1,f(o.value.filters.length-1)},K=(u,n)=>{if(!o.value)return;const d=n==="up"?u-1:u+1;if(d<0||d>=o.value.filters.length)return;const[ee]=o.value.filters.splice(u,1);o.value.filters.splice(d,0,ee),i.value===u?i.value=d:i.value===d&&(i.value=u)},v=u=>{var n;i.value===u&&(i.value="input"),(n=o.value)==null||n.filters.splice(u,1)};W(c,u=>{!u&&i.value===null&&f("input")},{immediate:!0});const p=j(()=>dl(oe.players[m.playerId],27));W(()=>m.playerId,async u=>{u&&(o.value=await oe.getDSPConfig(u))},{immediate:!0});let P=null;const w=u=>{P&&clearTimeout(P),P=setTimeout(async()=>{m.playerId&&await oe.saveDSPConfig(m.playerId,u)},2e3)};return W(o,(u,n)=>{u!==null&&n&&w(n)},{deep:!0}),(u,n)=>o.value?(V(),le("section",Al,[t(he,{color:"transparent",class:"border-b"},{default:a(()=>[t(ue,{modelValue:o.value.enabled,"onUpdate:modelValue":n[0]||(n[0]=d=>o.value.enabled=d),"hide-details":"",color:"primary",class:"pl-4"},null,8,["modelValue"]),t(Se,null,{default:a(()=>[C($(u.$t("settings.dsp.configure_on",{name:p.value})),1)]),_:1})]),_:1}),t(Oe,{class:"pa-4"},{default:a(()=>[o.value.enabled?D("",!0):(V(),S(yl,{key:0,type:"info",class:"mt-4",color:"transparent"},{default:a(()=>[C($(u.$t("settings.dsp.disabled_message")),1)]),_:1})),t(we,{class:Z([{"justify-center":F(c)},"flex-nowrap"])},{default:a(()=>[!F(c)||i.value===null?(V(),S(re,{key:0,class:Z(["flex-grow-0 flex-shrink-0",{"border-e pr-4":!F(c)}]),"align-self":"start"},{default:a(()=>[t(hl,{dsp:o.value,selected:i.value,onOnSelect:f,onOnAddFilter:n[1]||(n[1]=d=>h.value=!0),onOnMoveFilter:n[2]||(n[2]=d=>K(d.index,d.direction)),onOnDeleteFilter:v},null,8,["dsp","selected"])]),_:1},8,["class"])):D("",!0),i.value!=null?(V(),S(re,{key:1,style:{"min-width":"0"}},{default:a(()=>[t(he,{density:"compact",color:u.$vuetify.theme.current.dark?"surface":"surface-light",class:"border-b"},{default:a(()=>[F(c)?(V(),S(O,{key:0,class:"hidden-xs-only",icon:"",onClick:n[3]||(n[3]=d=>i.value=null)},{default:a(()=>[t(L,null,{default:a(()=>n[15]||(n[15]=[C("mdi-arrow-left")])),_:1})]),_:1})):D("",!0),t(Se,null,{default:a(()=>[C($(q(i.value)),1)]),_:1}),typeof i.value=="number"&&!F(c)&&i.value>0?(V(),S(O,{key:1,icon:"",onClick:n[4]||(n[4]=d=>K(i.value,"up"))},{default:a(()=>[t(L,null,{default:a(()=>n[16]||(n[16]=[C("mdi-arrow-up")])),_:1})]),_:1})):D("",!0),typeof i.value=="number"&&!F(c)&&i.value<o.value.filters.length-1?(V(),S(O,{key:2,icon:"",onClick:n[5]||(n[5]=d=>K(i.value,"down"))},{default:a(()=>[t(L,null,{default:a(()=>n[17]||(n[17]=[C("mdi-arrow-down")])),_:1})]),_:1})):D("",!0),typeof i.value=="number"?(V(),S(ue,{key:3,modelValue:o.value.filters[i.value].enabled,"onUpdate:modelValue":n[6]||(n[6]=d=>o.value.filters[i.value].enabled=d),"hide-details":"",color:"primary",class:"mr-4"},null,8,["modelValue"])):D("",!0),typeof i.value=="number"?(V(),S(O,{key:4,icon:"",onClick:n[7]||(n[7]=d=>v(i.value))},{default:a(()=>[t(L,null,{default:a(()=>n[18]||(n[18]=[C("mdi-delete")])),_:1})]),_:1})):D("",!0)]),_:1},8,["color"]),i.value==="input"?(V(),S(Q,{key:0,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[t(U,{modelValue:o.value.input_gain,"onUpdate:modelValue":n[8]||(n[8]=d=>o.value.input_gain=d),type:"gain"},null,8,["modelValue"])]),_:1},8,["color"])):i.value==="output"?(V(),S(Q,{key:1,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[t(U,{modelValue:o.value.output_gain,"onUpdate:modelValue":n[9]||(n[9]=d=>o.value.output_gain=d),type:"gain"},null,8,["modelValue"])]),_:1},8,["color"])):(V(),S(Q,{key:2,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[o.value.filters[i.value].type===F(N).PARAMETRIC_EQ?(V(),S($l,{key:0,modelValue:o.value.filters[i.value],"onUpdate:modelValue":n[10]||(n[10]=d=>o.value.filters[i.value]=d)},null,8,["modelValue"])):D("",!0),o.value.filters[i.value].type===F(N).TONE_CONTROL?(V(),S(ql,{key:1,modelValue:o.value.filters[i.value],"onUpdate:modelValue":n[11]||(n[11]=d=>o.value.filters[i.value]=d)},null,8,["modelValue"])):D("",!0)]),_:1},8,["color"]))]),_:1})):D("",!0)]),_:1},8,["class"])]),_:1}),t(gl,{modelValue:h.value,"onUpdate:modelValue":n[14]||(n[14]=d=>h.value=d),"max-width":"300"},{default:a(()=>[t(Q,null,{default:a(()=>[t(ml,null,{default:a(()=>[C($(u.$t("settings.dsp.filter.add")),1)]),_:1}),t(G,null,{default:a(()=>[t(xe,{modelValue:T.value,"onUpdate:modelValue":n[12]||(n[12]=d=>T.value=d),items:F(k),label:u.$t("settings.dsp.filter.type")},null,8,["modelValue","items","label"])]),_:1}),t(cl,null,{default:a(()=>[t(Ee),t(O,{onClick:n[13]||(n[13]=d=>h.value=!1)},{default:a(()=>[C($(u.$t("cancel")),1)]),_:1}),t(O,{color:"primary",onClick:z},{default:a(()=>[C($(u.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):D("",!0)}});export{Gl as default};
