(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{759:function(e,t,r){"use strict";var n=r(5893);r(7294);var l=r(8659),s=r(6350),i=r(9603),a=r(9417),o=r(485),c=r.n(o);t.Z=e=>(0,n.jsx)(l.Z,{placement:e.placement||"right",delay:{show:100,hide:1e3},overlay:t=>(0,n.jsx)(s.Z,{...t,children:e.tooltipContent}),children:e.children||(0,n.jsx)(i.G,{className:c().infoTooltip,icon:a.Fuz})})},2105:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(5893),l=r(7294),s=r(92),i=r(6299),a=r(759),o=r(7848);function c(e){return"Image"===e.inputDataType?(0,n.jsx)(d,{...e}):(0,n.jsx)(p,{...e})}function d(e){let{dataIndex:t,getInferenceSampleImageSrc:r,getSupportExampleImageSrc:l}=e;if(r&&l){let e="The RenderInputAsImage component expects either getInferenceSampleImageSrc or getSupportExampleImageSrc props to be defined, but not both to be defined";return console.warn(e),(0,n.jsx)("p",{children:e})}if(r)return(0,n.jsx)("img",{src:r(t),alt:"inference sample"});if(l)return(0,n.jsx)("img",{src:l(t),alt:"support example"});{let e="The RenderInputAsImage component expects either getInferenceSampleImageSrc or getSupportExampleImageSrc props to be defined, but both are undefined";return console.warn(e),(0,n.jsx)("p",{children:e})}}function p(e){let{dataIndex:t,getInferenceSampleTabularData:r,getSupportExampleTabularData:l}=e,{data:s,error:i,isLoading:a}=(0,o.a)({queryKey:[r?"renderInferenceFeatureData-".concat(t):"renderSupportFeatureData-".concat(t)],queryFn:async()=>{var e,n;if(!r||!l)return r?null===(e=await r(t))||void 0===e?void 0:e.renderInferenceFeatureData:l?null===(n=await l(t))||void 0===n?void 0:n.renderSupportFeatureData:void 0}});if(a)return(0,n.jsx)("p",{children:"Loading..."});if(s){let e=s.columnHeaders.reduce((e,t,r)=>(r<s.featureData.length&&(e[t]=parseFloat(s.featureData[r].toFixed(2))),e),{});return(0,n.jsx)("pre",{children:JSON.stringify(e,void 0,2)})}if(i){if(i instanceof Error)return(0,n.jsx)("p",{children:i.message})}else if(r&&l){let e="The QueryAndRenderInputAsTabular component expects either getInferenceSampleTabularData or getSupportExampleTabularData props to be defined, but not both to be defined";return console.warn(e),(0,n.jsx)("p",{children:e})}else if(!r&&!l){let e="The QueryAndRenderInputAsTabular component expects either getInferenceSampleTabularData or getSupportExampleTabularData props to be defined, but both are undefined";return console.warn(e),(0,n.jsx)("p",{children:e})}return(0,n.jsx)("p",{children:"Something in the component went wrong"})}var u=r(3275),h=r.n(u);let x=(0,s.l49)(),m=e=>e.x,g=e=>e.y,f=e=>e.weight;function b(e){let{continuity:t,getInferenceSampleImageSrc:r,getInferenceSampleTabularData:o,getSupportExampleImageSrc:c,getSupportExampleTabularData:d,inDistributionThreshold:p,inputDataType:u,stress:b,processedClassesProbabilities:S,samples:D,scree:k,srho:_,startingHeight:C=400,startingWidth:M=500,structuredEmbeddings:A,thresholds:N=10,trustworthiness:F,prototypeSupportEmbeddings:R}=e,[P,z]=(0,l.useState)(M),U=(0,l.useRef)(null),q=(0,l.useRef)(null);(0,l.useEffect)(()=>{U.current=new ResizeObserver(e=>{window.requestAnimationFrame(()=>{Array.isArray(e)&&e.length&&z(e[0].contentRect.width)})})},[]),(0,l.useEffect)(()=>(U.current&&q.current&&U.current.observe(q.current),()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.disconnect()}),[U,q]);let{domainX:O,domainY:Q}=(0,l.useMemo)(()=>{let e=[0,0],t=[0,0];return A.labels.forEach((r,n)=>{I(e,t,m(r.prototype),g(r.prototype),0===n),r.trainingExamples.forEach(r=>I(e,t,m(r),g(r)))}),A.samples.forEach(r=>{I(e,t,m(r),g(r))}),{domainX:e,domainY:t}},[A]),{rangeX:Z,rangeY:B,usedWidth:Y}=(0,l.useMemo)(()=>{let e=(O[1]-O[0])/(Q[1]-Q[0]),t=Math.min(P-10-40,(C-30-10)*e),r=t/e;return{rangeX:[40,40+t],rangeY:[10+r,10],usedHeight:r,usedWidth:t}},[O,Q,C,P]),L=(0,l.useMemo)(()=>(0,s.BYU)().domain(O).range(Z),[O,Z]),W=(0,l.useMemo)(()=>(0,s.BYU)().domain(Q).range(B),[Q,B]),X=(0,i.Z)(),H=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t=(0,s.LLu)(L).ticks(Math.max(5,Y/100));null===(e=H.current)||void 0===e||e.replaceChildren(),(0,s.Ys)(H.current).append("g").call(t)},[L,Y]);let G=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t=(0,s.y4O)(W).ticks(5);null===(e=G.current)||void 0===e||e.replaceChildren(),(0,s.Ys)(G.current).append("g").call(t)},[W]);let J=(0,l.useMemo)(()=>A.labels.map((e,t)=>[e.prototype].concat(e.trainingExamples)).map((e,t)=>(0,s._K_)().size([P,C]).cellSize(4).thresholds(N).bandwidth(40).weight(f).x(m).y(g)(e.map(e=>({weight:f(e),x:L(m(e)),y:W(g(e))})))),[C,L,W,A,N,P]),K=J.map((e,t)=>(0,s.BYU)().domain([0,e.length]).range([.08,.5])),[$,V]=(0,l.useState)(null),[ee,et]=(0,l.useState)(null),er=(0,l.useCallback)((e,t,r)=>{et({msg:r,x:e,y:t})},[D]),en=(0,l.useCallback)((e,t,r)=>{(!D||D.length>1)&&V({msg:r,x:e,y:t})},[D]);return(0,l.useEffect)(()=>{if(R&&A.labels.length>0){if(p&&S&&D){if(V(w({sampleIndex:0,getInferenceSampleImageSrc:r,getInferenceSampleTabularData:o,inputDataType:u,processedClassesProbabilities:S,samples:D,scaleX:L,scaleY:W,structuredEmbeddings:A})),(null==D?void 0:D.length)>1)et(w({sampleIndex:1,getInferenceSampleImageSrc:r,getInferenceSampleTabularData:o,inputDataType:u,processedClassesProbabilities:S,samples:D,scaleX:L,scaleY:W,structuredEmbeddings:A}));else{let e=D[0],{closestLabelIdx:t,closestPointIdx:r}=R.getPrototypeSupportEmbeddings.reduce((t,r,n)=>(r.trainingExamples.forEach((r,l)=>{let s=Math.hypot(...r.coordinates.map((t,r)=>t-e.coordinates[r]));(null===t.closestDistance||t.closestDistance>s)&&(t.closestDistance=s,t.closestLabelIdx=n,t.closestPointIdx=l)}),t),{closestLabelIdx:null,closestPointIdx:null,closestDistance:null});null!==t&&null!==r&&et(T({getSupportExampleImageSrc:c,getSupportExampleTabularData:d,inputDataType:u,labelIdx:t,pointIdx:r,scaleX:L,scaleY:W,structuredEmbeddings:A,prototypeSupportEmbeddings:R}))}}else{let e={getSupportExampleImageSrc:c,getSupportExampleTabularData:d,inputDataType:u,scaleX:L,scaleY:W,structuredEmbeddings:A,prototypeSupportEmbeddings:R};V(T({labelIdx:0,pointIdx:0,...e})),et(T({labelIdx:1,pointIdx:0,...e}))}}},[r,o,c,d,p,u,S,D,L,W,A,R]),(0,n.jsxs)("div",{className:h()["uq-viz-container"],children:[(0,n.jsx)("div",{className:h()["uq-viz-sidebar"],style:{marginRight:"1rem"},children:$&&$.msg}),(0,n.jsx)("div",{children:(0,n.jsxs)("div",{ref:q,style:{position:"relative"},children:[(0,n.jsxs)("svg",{style:{width:P,height:C},children:[(0,n.jsx)("g",{className:"xAxis",ref:H,transform:"translate(0,".concat(C-20,")")}),(0,n.jsx)("g",{className:"yAxis",ref:G,transform:"translate(30,0)"}),J.map((e,t)=>{let r=X(null==R?void 0:R.getPrototypeSupportEmbeddings[t].label),l=K[t];return e.map((e,t)=>{let s=x(e)||"";return(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fill:r,d:s,opacity:.05,stroke:"none",strokeWidth:0}),(0,n.jsx)("path",{fill:"none",d:s,opacity:l(t),stroke:r,strokeWidth:1})]},t)})}),null==R?void 0:R.getPrototypeSupportEmbeddings.map((e,t)=>{let r=A.labels[t];return(0,n.jsx)("g",{children:e.trainingExamples.map((t,l)=>{var s;let i=(null===(s=t.labels.find(t=>t.label===e.label))||void 0===s?void 0:s.confidence)||1,a=r.trainingExamples[l],o=L(m(a)),p=W(g(a)),h=(0,n.jsx)(j,{getSupportExampleImageSrc:c,getSupportExampleTabularData:d,inputDataType:u,label:e.label,sample:t});return(0,n.jsx)("circle",{className:"point",cx:o,cy:p,fill:X(e.label),onClick:()=>en(o,p,h),onMouseEnter:()=>er(o,p,h),opacity:D?i/2+.5:1,r:5,stroke:"white",strokeWidth:"2"},l)})},t)}),null==R?void 0:R.getPrototypeSupportEmbeddings.map((e,t)=>{let r=A.labels[t].prototype,l=L(m(r)),s=W(g(r)),i=(0,n.jsx)(v,{label:e.label});return(0,n.jsx)("g",{children:(0,n.jsx)("circle",{className:"prototype point",cx:l,cy:s,fill:"black",onClick:()=>en(l,s,i),onMouseEnter:()=>er(l,s,i),r:5,stroke:"white",strokeWidth:"2"})},t)}),(0,n.jsx)("g",{children:S&&D&&D.map((e,t)=>{let l,s;let i=S[t],a=A.samples[t],c=L(m(a)),d=W(g(a)),p=(0,n.jsx)(y,{getInferenceSampleImageSrc:r,getInferenceSampleTabularData:o,inputDataType:u,processedClassProbabilities:i,sample:e});return(0,n.jsx)("circle",{className:"point",cx:c,cy:d,fill:X((l="",s=0,Object.keys(i).forEach(e=>{i[e]>s&&(l=e,s=i[e])}),l)),onClick:()=>en(c,d,p),onMouseEnter:()=>er(c,d,p),r:7,stroke:"black",strokeWidth:"2"},t)})})]}),ee&&(0,n.jsx)("div",{style:{position:"absolute",top:ee.y-2,left:ee.x+7,right:"-1rem",border:"2px dashed gray"}}),$&&(0,n.jsx)("div",{style:{position:"absolute",top:$.y-2,left:"-1rem",right:P-$.x+7,border:"2px dashed gray"}}),(0,n.jsx)("div",{style:{position:"absolute",top:0,right:0},children:(0,n.jsx)(a.Z,{placement:"left",tooltipContent:(0,n.jsxs)("div",{style:{textAlign:"left"},children:[(0,n.jsx)("p",{children:(0,n.jsx)("b",{children:"Dimensionality Reduction Metrics"})}),(0,n.jsxs)("div",{style:{width:"100%"},children:[(0,n.jsxs)("p",{style:{marginBottom:"0"},children:[(0,n.jsx)("b",{children:"Continuity:"})," ",(0,n.jsx)("span",{style:{float:"right"},children:E(t,5)})]}),(0,n.jsxs)("p",{style:{marginBottom:"0"},children:[(0,n.jsx)("b",{children:"Stress: \xa0"})," ",(0,n.jsx)("span",{style:{float:"right"},children:E(b,5)})]}),k&&(0,n.jsxs)("p",{style:{marginBottom:"0"},children:[(0,n.jsx)("b",{children:"Scree Values:"}),"\xa0",(0,n.jsxs)("span",{style:{float:"right"},children:["[",k.map(e=>e.toFixed(2)).join(", "),"]"]})]}),(0,n.jsxs)("p",{style:{marginBottom:"0"},children:[(0,n.jsx)("b",{children:"Spearman's Rank:"})," ",(0,n.jsx)("span",{style:{float:"right"},children:E(_,5)})]}),(0,n.jsxs)("p",{style:{marginBottom:"0"},children:[(0,n.jsx)("b",{children:"Trustworthiness:"})," ",(0,n.jsx)("span",{style:{float:"right"},children:E(F,5)})]})]})]})})})]})}),(0,n.jsx)("div",{className:h()["uq-viz-sidebar"],style:{marginLeft:"1rem"},children:ee&&ee.msg})]})}let j=e=>{let{getSupportExampleImageSrc:t,getSupportExampleTabularData:r,inputDataType:l,label:s,sample:i}=e,a=[...i.labels].sort((e,t)=>Math.sign(t.confidence-e.confidence));return(0,n.jsxs)("div",{children:[(0,n.jsx)(c,{dataIndex:i.inputData.dataIndex,getSupportExampleImageSrc:t,getSupportExampleTabularData:r,inputDataType:l}),(0,n.jsxs)("div",{style:{padding:"0.5em"},children:[(0,n.jsxs)("p",{children:["This is an example from training with a true label of ",(0,n.jsx)(S,{label:s})]}),(0,n.jsx)("p",{children:(0,n.jsx)("b",{children:"Class Confidence Scores"})}),(0,n.jsx)("div",{style:{height:"3rem",overflowY:"auto"},children:(0,n.jsx)("table",{children:(0,n.jsx)("tbody",{children:a.map(e=>{let{label:t,confidence:r}=e;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{style:{textAlign:"left"},children:(0,n.jsxs)("b",{children:[t,":"]})}),(0,n.jsx)("td",{style:{textAlign:"right"},children:E(r)})]},t)})})})}),(0,n.jsx)("hr",{}),(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:"Outlier Score:"})," ",i.ood.toFixed(2)]})]})]})},y=e=>{let{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:r,inputDataType:l,processedClassProbabilities:s,sample:i}=e;return(0,n.jsxs)("div",{children:[(0,n.jsx)(c,{dataIndex:i.inputData.dataIndex,getInferenceSampleImageSrc:t,getInferenceSampleTabularData:r,inputDataType:l}),(0,n.jsxs)("div",{style:{padding:"0.5em"},children:[(0,n.jsx)("div",{children:Object.entries(s).filter(e=>{let[t,r]=e;return 1===r}).map(e=>{let[t,r]=e;return(0,n.jsxs)("p",{children:["This is an inference sample with prediction ",(0,n.jsx)(S,{label:t})]},t)})}),(0,n.jsx)("p",{children:(0,n.jsx)("b",{children:"Class Confidence Scores"})}),(0,n.jsx)("div",{style:{height:"3rem",overflowY:"auto"},children:(0,n.jsx)("table",{children:(0,n.jsx)("tbody",{children:Object.entries(i.classProbabilities).sort((e,t)=>{let[r,n]=e,[l,s]=t;return Math.sign(s-n)}).map(e=>{let[t,r]=e;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{style:{textAlign:"left"},children:(0,n.jsxs)("b",{children:[t,":"]})}),(0,n.jsx)("td",{style:{textAlign:"right"},children:E(r)})]},t)})})})}),(0,n.jsx)("hr",{}),(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:"Outlier Score:"})," ",i.ood.toFixed(2)]})]})]})};function v(e){let{label:t}=e;return(0,n.jsxs)("div",{style:{padding:"0.5em"},children:[(0,n.jsxs)("p",{children:["This is the prototype for the label ",(0,n.jsx)(S,{label:t}),"."]}),(0,n.jsx)("p",{children:"There is no input associated with the prototype."})]})}let S=e=>{let t=e.label,r=(0,i.Z)();return(0,n.jsxs)("b",{style:{whiteSpace:"nowrap"},children:[t," ",(0,n.jsx)("span",{className:"circle",style:{backgroundColor:r(t)}})]})};function I(e,t,r,n){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e[0]=l?r:Math.min(e[0],r),e[1]=l?r:Math.max(e[1],r),t[0]=l?n:Math.min(t[0],n),t[1]=l?n:Math.max(t[1],n)}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=e.toFixed(t);return"0.00"===r?e.toExponential(1):r}function w(e){let{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:r,inputDataType:l,processedClassesProbabilities:s,sampleIndex:i,samples:a,scaleX:o,scaleY:c,structuredEmbeddings:d}=e,p=d.samples[i],u=o(m(p)),h=c(g(p)),x=s[i];return{x:u,y:h,msg:(0,n.jsx)(y,{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:r,inputDataType:l,processedClassProbabilities:x,sample:a[i]})}}function T(e){let{getSupportExampleImageSrc:t,getSupportExampleTabularData:r,inputDataType:l,labelIdx:s,pointIdx:i,scaleX:a,scaleY:o,structuredEmbeddings:c,prototypeSupportEmbeddings:d}=e,p=c.labels[s].trainingExamples[i],u=a(m(p)),h=o(g(p)),x=d.getPrototypeSupportEmbeddings[s];return{x:u,y:h,msg:(0,n.jsx)(j,{getSupportExampleImageSrc:t,getSupportExampleTabularData:r,inputDataType:l,label:x.label,sample:x.trainingExamples[i]})}}},6299:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(5567),l=r(8697),s=r(8468);let i=(0,l.P1)(e=>e.uiSettings,e=>{let{colorBlindMode:t,oodColorMode:r}=e;return t?(0,s.rg)(s.bU,r,s.$_):(0,s.rg)(s.O9,r,s.Q$)});function a(){return(0,n.C)(i)}},5316:function(e,t,r){"use strict";r.d(t,{y:function(){return n}});let n={plugins:{legend:{labels:{color:"white"},title:{color:"white"}}},scales:{x:{grid:{borderColor:"#777",color:"#777"},ticks:{color:"white"}},y:{grid:{borderColor:"#777",color:"#777"},ticks:{color:"white"}}}}},7765:function(e,t,r){"use strict";function n(e){document.title="EQUI(NE)\xb2 - ".concat(e)}r.d(t,{Z:function(){return n}})},485:function(e){e.exports={infoTooltip:"InfoTooltip_infoTooltip__XHOEb"}},3275:function(e){e.exports={"uq-viz-container":"ScatterUQ_uq-viz-container__Nsp3M",circle:"ScatterUQ_circle__GDFw0",arrow:"ScatterUQ_arrow__oXuJU",prototype:"ScatterUQ_prototype__Si4Xc","uq-viz-sidebar":"ScatterUQ_uq-viz-sidebar__PeHXh"}}}]);