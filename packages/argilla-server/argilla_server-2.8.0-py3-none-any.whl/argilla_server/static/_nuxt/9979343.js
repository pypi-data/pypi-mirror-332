(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1018:function(t,e,r){"use strict";r.r(e);r(171),r(415),r(864),r(865),r(783);var o={props:{category:{type:Object},availableCategories:{type:Array}},data:function data(){return{visibleDropdown:!1}},methods:{onToggleVisibility:function onToggleVisibility(t){this.visibleDropdown=t},replaceCategory:function replaceCategory(t){this.$emit("replace-sort-category",t),this.visibleDropdown=!1}}},n=(r(999),r(26)),i=Object(n.a)(o,(function render(){var t=this,e=t._self._c;return e("div",{staticClass:"sort-selector-item"},[e("BaseDropdown",{staticClass:"sort-selector-item__dropdown",attrs:{visible:t.visibleDropdown},on:{visibility:t.onToggleVisibility}},[e("span",{staticClass:"sort-selector-item__dropdown__header",attrs:{slot:"dropdown-header"},slot:"dropdown-header"},[e("div",{staticClass:"sort-selector-item__dropdown__header__item"},[e("span",{staticClass:"sort-selector-item__dropdown__header__group",domProps:{textContent:t._s(t.$t("sorting.".concat(t.category.group)))}}),t._v(" "),e("span",{staticClass:"sort-selector-item__dropdown__header__text",attrs:{title:"category.title"},domProps:{textContent:t._s(t.category.title)}})]),t._v(" "),e("svgicon",{attrs:{width:"12",height:"12",name:"chevron-down"}})],1),t._v(" "),e("span",{attrs:{slot:"dropdown-content"},slot:"dropdown-content"},[t.availableCategories.length?e("SortCategoriesList",{attrs:{categories:t.availableCategories},on:{"include-category":t.replaceCategory}}):t._e()],1)]),t._v(" "),e("BaseButton",{staticClass:"sort-selector-item__direction secondary clear",attrs:{title:"sort direction"},on:{click:function click(e){return t.$emit("change-sort-direction")}}},[e("svgicon",{attrs:{width:"16",height:"16",name:"asc"===t.category.sort?"arrow-up":"arrow-down","aria-label":"Change sort direction to "+("asc"===t.category.sort?"up":"down")}})],1),t._v(" "),e("BaseButton",{staticClass:"sort-selector-item__close-button secondary clear",on:{click:function click(e){return t.$emit("clear-category")}}},[e("svgicon",{staticClass:"sort-selector-item__close-button__icon",attrs:{name:"close",width:"14",height:"14"}})],1)],1)}),[],!1,null,"6860cfe1",null);e.default=i.exports;installComponents(i,{SortCategoriesList:r(837).default,BaseDropdown:r(780).default,BaseButton:r(259).default})},1034:function(t,e,r){"use strict";r(902)},1035:function(t,e,r){"use strict";r(903)},1074:function(t,e,r){"use strict";r.r(e);r(796);var o={props:{activeSortItems:{type:Array,default:function _default(){return[]}},isActive:{type:Boolean,default:!1}},computed:{isButtonActive:function isButtonActive(){return this.isActive||!!this.activeSortItemsCounter},activeSortItemsCounter:function activeSortItemsCounter(){return this.activeSortItems.length}}},n=(r(1034),r(26)),i=Object(n.a)(o,(function render(){var t=this,e=t._self._c;return e("FilterButton",{attrs:{"button-name":t.$t("sorting.label"),"icon-name":"sort","is-button-active":t.isButtonActive}},[t.activeSortItemsCounter?e("span",{staticClass:"sort-button__text",domProps:{textContent:t._s("(".concat(t.activeSortItemsCounter,")"))}}):t._e()])}),[],!1,null,"683ef781",null);e.default=i.exports;installComponents(i,{FilterButton:r(805).default})},1075:function(t,e,r){"use strict";r.r(e);r(41),r(39),r(24),r(75);var o={props:{sortingItems:{type:Object,required:!0}},data:function data(){return{visibleDropdown:!1}},computed:{nonSelectedSortingItems:function nonSelectedSortingItems(){return this.sortingItems.noSelected},selectedSortingItems:function selectedSortingItems(){return this.sortingItems.selected}},methods:{onToggleVisibility:function onToggleVisibility(){this.visibleDropdown=!this.visibleDropdown},includeSortCategory:function includeSortCategory(t){this.sortingItems.select(t),this.visibleDropdown=!1},applySorting:function applySorting(){this.$emit("apply-sort")},onClear:function onClear(t){this.sortingItems.unselect(t),this.selectedSortingItems.length||this.applySorting()},onChangeSortDirection:function onChangeSortDirection(t){this.sortingItems.toggleSort(t)},onReplaceSortCategory:function onReplaceSortCategory(t,e){this.sortingItems.replace(t,e),this.visibleDropdown=!1}}},n=(r(1035),r(26)),i=Object(n.a)(o,(function render(){var t=this,e=t._self._c;return e("div",{staticClass:"sort-selector"},[t._l(t.selectedSortingItems,(function(r){return e("SortSelectorItem",{key:r.id,attrs:{category:r,"available-categories":t.nonSelectedSortingItems},on:{"clear-category":function clearCategory(e){return t.onClear(r)},"change-sort-direction":function changeSortDirection(e){return t.onChangeSortDirection(r)},"replace-sort-category":function replaceSortCategory(e){return t.onReplaceSortCategory.apply(t,[r].concat(Array.prototype.slice.call(arguments)))}}})})),t._v(" "),t.nonSelectedSortingItems.length?e("BaseDropdown",{attrs:{visible:t.visibleDropdown}},[e("span",{attrs:{slot:"dropdown-header"},slot:"dropdown-header"},[e("BaseButton",{staticClass:"secondary small light",on:{click:t.onToggleVisibility}},[t._v("\n        "+t._s(t.$t("sorting.addOtherField")))])],1),t._v(" "),e("span",{attrs:{slot:"dropdown-content"},slot:"dropdown-content"},[e("SortCategoriesList",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onToggleVisibility,expression:"onToggleVisibility"}],attrs:{categories:t.nonSelectedSortingItems},on:{"include-category":t.includeSortCategory}})],1)]):t._e()],2)}),[],!1,null,"9b3b7e02",null);e.default=i.exports;installComponents(i,{SortSelectorItem:r(1018).default,BaseButton:r(259).default,SortCategoriesList:r(837).default,BaseDropdown:r(780).default})},1093:function(t,e,r){"use strict";r(963)},1107:function(t,e,r){"use strict";r.r(e);var o=r(17),n=(r(10),r(171),r(85)),i=r(43),s=r(21),a=r(30),c=r(1),l=r(2);r(41),r(34),r(60),r(261),r(48),r(23),r(145),r(11),r(76),r(4),r(53),r(32);function _callSuper(t,e,r){return e=Object(s.a)(e),Object(i.a)(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],Object(s.a)(t).constructor):e.apply(t,r))}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}var u="asc",d=function(){return Object(l.a)((function Sort(t,e){Object(c.a)(this,Sort),this.key=t,this.property=e,this.sort=u}),[{key:"toggleSort",value:function toggleSort(){this.sort=this.sort===u?"desc":u}},{key:"id",get:function get(){return this.property?"".concat(this.key,".").concat(this.name,".").concat(this.property):"".concat(this.key,".").concat(this.name)}},{key:"group",get:function get(){return this.property?"".concat(this.key,".").concat(this.property):this.key}},{key:"canSort",get:function get(){return!0}},{key:"tooltip",get:function get(){return this.title}}])}(),g=function(t){function MetadataSort(t){var e;return Object(c.a)(this,MetadataSort),(e=_callSuper(this,MetadataSort,["metadata"])).metadata=t,e}return Object(a.a)(MetadataSort,t),Object(l.a)(MetadataSort,[{key:"name",get:function get(){return this.metadata.name}},{key:"title",get:function get(){return this.metadata.title}},{key:"canSort",get:function get(){return this.metadata.hasValues}}])}(d),p=function(t){function SuggestionScoreSort(t){var e;return Object(c.a)(this,SuggestionScoreSort),(e=_callSuper(this,SuggestionScoreSort,["suggestion","score"])).question=t,e}return Object(a.a)(SuggestionScoreSort,t),Object(l.a)(SuggestionScoreSort,[{key:"name",get:function get(){return this.question.name}},{key:"title",get:function get(){return this.question.name}},{key:"tooltip",get:function get(){return this.question.title}}])}(d),h=function(t){function SuggestionValueSort(t){var e;return Object(c.a)(this,SuggestionValueSort),(e=_callSuper(this,SuggestionValueSort,["suggestion","value"])).question=t,e}return Object(a.a)(SuggestionValueSort,t),Object(l.a)(SuggestionValueSort,[{key:"name",get:function get(){return this.question.name}},{key:"title",get:function get(){return this.question.name}},{key:"tooltip",get:function get(){return this.question.title}}])}(d),f=function(t){function ResponseValueSort(t){var e;return Object(c.a)(this,ResponseValueSort),(e=_callSuper(this,ResponseValueSort,["response"])).question=t,e}return Object(a.a)(ResponseValueSort,t),Object(l.a)(ResponseValueSort,[{key:"name",get:function get(){return this.question.name}},{key:"title",get:function get(){return this.question.name}},{key:"tooltip",get:function get(){return this.question.title}}])}(d),S=function(t){function RecordSort(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Object(c.a)(this,RecordSort),(e=_callSuper(this,RecordSort,["record"])).name=t,e.title=r,e}return Object(a.a)(RecordSort,t),Object(l.a)(RecordSort)}(d),y=function(){return Object(l.a)((function SortList(t,e){var r=this;Object(c.a)(this,SortList),this.categoriesSorts=[],this.selectedCategories=[],this.latestCommit=[],this.categoriesSorts.push(new S("inserted_at")),this.categoriesSorts.push(new S("updated_at")),null==e||e.forEach((function(t){return r.categoriesSorts.push(new p(t))})),null==e||e.filter((function(t){return t.isRatingType})).forEach((function(t){return r.categoriesSorts.push(new h(t))})),null==e||e.filter((function(t){return t.isRatingType})).forEach((function(t){return r.categoriesSorts.push(new f(t))})),null==t||t.forEach((function(t){return r.categoriesSorts.push(new g(t))}))}),[{key:"selected",get:function get(){return this.selectedCategories}},{key:"noSelected",get:function get(){var t=this;return this.categoriesSorts.filter((function(e){return!t.selectedCategories.includes(e)}))}},{key:"select",value:function select(t){var e=this.findByCategory(t);e&&this.selectedCategories.push(e)}},{key:"unselect",value:function unselect(t){var e=this.findIndexSelectedCategory(t);e>-1&&this.selectedCategories.splice(e,1)}},{key:"replace",value:function replace(t,e){var r=this.findByCategory(e),o=this.findIndexSelectedCategory(t);o>-1&&this.selectedCategories.splice(o,1,r)}},{key:"clear",value:function clear(){this.selectedCategories=[]}},{key:"toggleSort",value:function toggleSort(t){var e=this.findByCategory(t);e&&e.toggleSort()}},{key:"hasChanges",get:function get(){return this.hasDifferencesWith(this.createSortCriteria())}},{key:"hasDifferencesWith",value:function hasDifferencesWith(t){return JSON.stringify(this.latestCommit)!==JSON.stringify(t)}},{key:"commit",value:function commit(){return this.latestCommit=this.createSortCriteria(),this.latestCommit}},{key:"createSortCriteria",value:function createSortCriteria(){return this.selectedCategories.map((function(t){var e=t.key,r=t.property,o=t.name,n=t.sort;return r?{entity:e,name:o,property:r,order:n}:{entity:e,name:o,order:n}}))}},{key:"complete",value:function complete(t){var e=this;this.hasDifferencesWith(t)&&(this.clear(),t.length&&(t.forEach((function(t){var r=t.entity,o=t.name,n=t.order,i=t.property,s=e.findByCategory({key:r,name:o,property:i});s&&(s.sort=n,e.selectedCategories.push(s))})),this.commit()))}},{key:"findByCategory",value:function findByCategory(t){var e=this;return this.categoriesSorts.find((function(r){return r.id===e.toId(t)}))}},{key:"findIndexSelectedCategory",value:function findIndexSelectedCategory(t){var e=this;return this.selectedCategories.findIndex((function(r){return r.id===e.toId(t)}))}},{key:"toId",value:function toId(t){return t.property?"".concat(t.key,".").concat(t.name,".").concat(t.property):"".concat(t.key,".").concat(t.name)}}])}(),m=r(65),v=r(267),C={props:{datasetMetadata:{type:Array,required:!0},datasetQuestions:{type:Array,required:!0},sortFilters:{type:Array,required:!0}},model:{prop:"sortFilters",event:"onSortFilteredChanged"},data:function data(){return{visibleDropdown:!1}},computed:{nonSelectedSortingItems:function nonSelectedSortingItems(){return this.categoriesSort.noSelected},selectedSortingItems:function selectedSortingItems(){return this.categoriesSort.selected}},methods:{onSortToggleVisibility:function onSortToggleVisibility(t){this.visibleDropdown=t},includeSortCategory:function includeSortCategory(t){this.categoriesSort.select(t)},clearSortCategory:function clearSortCategory(t){this.categoriesSort.unselect(t),this.applySort()},applySort:function applySort(){this.onSortToggleVisibility(!1),this.sort()},sort:function sort(){if(this.categoriesSort.hasChanges){var t=this.categoriesSort.commit();this.$emit("onSortFilteredChanged",t)}},updateAppliedCategoriesFromMetadataFilter:function updateAppliedCategoriesFromMetadataFilter(){this.categoriesSort&&this.categoriesSort.complete(this.sortFilters)}},watch:{visibleDropdown:function visibleDropdown(){this.visibleDropdown||(this.debounce.stop(),this.sort())},"categoriesSort.selected":{deep:!0,handler:function handler(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return t.debounce.stop(),e.next=3,t.debounce.wait();case 3:t.sort();case 4:case"end":return e.stop()}}),_callee)})))()}},sortFilters:function sortFilters(){this.updateAppliedCategoriesFromMetadataFilter()}},created:function created(){this.updateAppliedCategoriesFromMetadataFilter()},setup:function setup(t){return function useSortRecords(t){var e,r=t.datasetMetadata,o=t.datasetQuestions,i=Object(m.e)().getValue,s=Object(v.b)(null!==(e=i("sort-delay","integer"))&&void 0!==e?e:500);return{categoriesSort:Object(n.f)(new y(r,o)),debounce:s}}(t)}},_=(r(1093),r(26)),b=Object(_.a)(C,(function render(){var t=this,e=t._self._c;return e("div",{staticClass:"sort-filter"},[e("BaseDropdown",{attrs:{visible:t.visibleDropdown},on:{visibility:t.onSortToggleVisibility}},[e("span",{attrs:{slot:"dropdown-header"},slot:"dropdown-header"},[e("SortButton",{attrs:{"is-active":t.visibleDropdown,"active-sort-items":t.selectedSortingItems}})],1),t._v(" "),e("span",{staticClass:"sort-filter__container",attrs:{slot:"dropdown-content"},slot:"dropdown-content"},[t.selectedSortingItems.length?e("SortSelector",{attrs:{"sorting-items":t.categoriesSort},on:{"clear-category":t.clearSortCategory,"apply-sort":t.applySort}}):e("SortCategoriesList",{staticClass:"sort-filter__selector",attrs:{categories:t.nonSelectedSortingItems},on:{"include-category":t.includeSortCategory}})],1)])],1)}),[],!1,null,"53b26170",null);e.default=b.exports;installComponents(b,{SortButton:r(1074).default,SortCategoriesList:r(837).default,SortSelector:r(1075).default,BaseDropdown:r(780).default})},837:function(t,e,r){"use strict";r.r(e);var o=r(49),n=(r(34),r(48),r(23),r(4),r(419),r(53),r(20),r(420),r(421),r(422),r(423),r(424),r(425),r(426),r(427),r(428),r(429),r(430),r(431),r(432),r(433),r(434),r(435),r(16),{props:{categories:{type:Array,required:!0}},data:function data(){return{searchText:""}},computed:{groups:function groups(){return Object(o.a)(new Set(this.categories.map((function(t){return t.group}))))},categoriesFilteredBySearchText:function categoriesFilteredBySearchText(){var t=this;return this.categories.filter((function(e){return e.title.toLowerCase().includes(t.searchText.toLowerCase())}))},filteredGroups:function filteredGroups(){var t=this.categoriesFilteredBySearchText.map((function(t){return t.group}));return this.groups.filter((function(e){return t.includes(e)}))}},methods:{includeCategory:function includeCategory(t){this.$emit("include-category",t)},getCategoriesByGroup:function getCategoriesByGroup(t){return this.categoriesFilteredBySearchText.filter((function(e){return e.group===t}))}}}),i=(r(938),r(26)),s=Object(i.a)(n,(function render(){var t=this,e=t._self._c;return e("div",{staticClass:"sort-categories"},[e("SearchLabelComponent",{staticClass:"sort-categories__search",attrs:{placeholder:t.$t("filterBy"),searchRef:"sortFilter"},model:{value:t.searchText,callback:function callback(e){t.searchText=e},expression:"searchText"}}),t._v(" "),e("ul",{staticClass:"sort-categories__list"},[t._l(t.filteredGroups,(function(r){return[e("span",{key:r,staticClass:"sort-categories__group",domProps:{textContent:t._s(t.$t("sorting.".concat(r)))}}),t._v(" "),t._l(t.getCategoriesByGroup(r),(function(r){return e("li",{key:r.id,attrs:{title:r.tooltip}},[e("BaseButton",{staticClass:"sort-categories__item",attrs:{disabled:!r.canSort},on:{"on-click":function onClick(e){return t.includeCategory(r)}}},[e("span",[t._v(t._s(r.title))])])],1)}))]}))],2)],1)}),[],!1,null,"e12fdada",null);e.default=s.exports;installComponents(s,{SearchLabelComponent:r(803).default,BaseButton:r(259).default})},844:function(t,e,r){t.exports={}},864:function(t,e,r){r(144).register({"arrow-up":{width:41,height:40,viewBox:"0 0 41 40",data:'<path pid="0" d="M30.8 14.767l-2.582 2.43-5.926-5.633L22.267 35l-3.641-.004.025-23.371-5.881 5.538-2.57-2.441L20.525 5 30.8 14.767z" _fill="#000"/>'}})},865:function(t,e,r){r(144).register({"arrow-down":{width:41,height:40,viewBox:"0 0 41 40",data:'<path pid="0" d="M18.597 5h3.807v23.105l6.172-5.84 2.692 2.547L20.5 35 9.732 24.812l2.692-2.547 6.173 5.84V5z" _fill="#000"/>'}})},873:function(t,e,r){t.exports={}},902:function(t,e,r){t.exports={}},903:function(t,e,r){t.exports={}},938:function(t,e,r){"use strict";r(844)},963:function(t,e,r){t.exports={}},999:function(t,e,r){"use strict";r(873)}}]);