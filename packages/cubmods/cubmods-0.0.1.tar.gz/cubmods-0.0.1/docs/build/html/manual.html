
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Manual &#8212; CUBmods 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manual';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="cubmods" href="modules.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">CUBmods 0.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Manual
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="modules.html">
    cubmods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Manual
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="modules.html">
    cubmods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Manual</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="manual">
<h1>Manual<a class="headerlink" href="#manual" title="Link to this heading">#</a></h1>
<p>The package <code class="docutils literal notranslate"><span class="pre">cubmods</span></code> can be used to build models within the CUB class
given an observed sample (and, eventually, the covariance matrix)
in order to estimate the parameters. Also, for each family,
random samples can be drawn from a specified model.</p>
<p>Currently, six families have been defined and implemented:</p>
<ul class="simple">
<li><p>CUB (Combination of Uniform and Binomial)</p></li>
<li><p>CUBSH (CUB + a SHelter choice)</p></li>
<li><p>CUSH (Combination of Uniform and a SHelter choice)</p></li>
<li><p>CUSH2 (Combination of Uniform and 2 SHelter choices)</p></li>
<li><p>CUBE (Combination of Uniform and BEta-binomial)</p></li>
<li><p>IHG (Inverse HyperGeometric)</p></li>
</ul>
<p>For each family, a model can be defined with or without covariates for one or more parameters.</p>
<p>Details about each family and examples are provided in the following sections.</p>
<p>Even if each family has got its own <em>Maximum Likelihood Estimation</em> function <code class="docutils literal notranslate"><span class="pre">mle()</span></code> that
could be called directly, for example <code class="docutils literal notranslate"><span class="pre">cub.mle()</span></code>, the function <code class="docutils literal notranslate"><span class="pre">gem.estimate()</span></code> provides a
simplified and generalised procedure for MLE.</p>
<p>Similarly, even if each family has got its own <em>Random Sample Drawing</em> function <code class="docutils literal notranslate"><span class="pre">draw()</span></code> that
could be called directly, for example <code class="docutils literal notranslate"><span class="pre">cub.draw()</span></code>, the function <code class="docutils literal notranslate"><span class="pre">gem.draw()</span></code> provides a
simplified and generalised procedure to draw a random sample.</p>
<p>In this manual <code class="docutils literal notranslate"><span class="pre">gem</span></code> functions will be used for the examples.</p>
<p>Notice that, the Dissimilarity index is computed for models with covariates also:
it should be interpreted as the fraction of the sample to be changed to achive a
perfect fit to the estimated average probability distribution (see
<a class="reference external" href="intro.html">Introduction</a> Notes).</p>
<p>The last section, shows the basic usage for the tool <code class="docutils literal notranslate"><span class="pre">multicub</span></code>.</p>
<section id="gem-usage">
<span id="gem-manual"></span><h2>GeM usage<a class="headerlink" href="#gem-usage" title="Link to this heading">#</a></h2>
<p>GeM (Generalized Mixture) is the main module of <code class="docutils literal notranslate"><span class="pre">cubmods</span></code> package, which provides simplified and
generalized functions to both estimate a model from an observed sample and draw a random sample from a
specified model.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">gem.estimate()</span></code> is the main function for the estimation and
validation of a model from an observed sample, calling for the corresponding <code class="docutils literal notranslate"><span class="pre">.mle()</span></code> function of
the specified family module, with or without covariates.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">gem.draw()</span></code> is the main function for drawing a random sample from a specified model,
calling for the corresponding <code class="docutils literal notranslate"><span class="pre">.draw()</span></code> function of the corresponding family module,
with or without covariates.</p>
<p><a class="reference external" href="cubmods.html#gem-module">Reference guide</a></p>
<section id="the-formula-syntax">
<h3>The <em>formula</em> syntax<a class="headerlink" href="#the-formula-syntax" title="Link to this heading">#</a></h3>
<p>Both functions need a <code class="docutils literal notranslate"><span class="pre">formula</span></code> that is a <strong>string</strong> specifying the name of the ordinal
variable (before the tilde <code class="docutils literal notranslate"><span class="pre">~</span></code> symbol)
and of the covariates of the components (after the tilde symbol <code class="docutils literal notranslate"><span class="pre">~</span></code>).
Covariates for each component are
separated by the pipeline symbol <code class="docutils literal notranslate"><span class="pre">|</span></code>.
The <em>zero</em> symbol <code class="docutils literal notranslate"><span class="pre">0</span></code> indicates no covariates for a certain component.
The <em>one</em> symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> indicates that we want to estimate the parameter of the constant term only.
If more covariates explain a single component, the symbol <code class="docutils literal notranslate"><span class="pre">+</span></code> concatenates the names.
Qualitative variables names, must be placed between brackets <code class="docutils literal notranslate"><span class="pre">()</span></code> leaded by a <code class="docutils literal notranslate"><span class="pre">C</span></code>,
for example <code class="docutils literal notranslate"><span class="pre">C(varname)</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>No columns in the DataFrame should be named <code class="docutils literal notranslate"><span class="pre">constant</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code>.
In the column names, only letters, numbers, and underscores <code class="docutils literal notranslate"><span class="pre">_</span></code> are allowed.
Spaces <strong>SHOULD NOT BE</strong> used in the column names, but discarded (i.e. replaced di <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>)
or replaced with <code class="docutils literal notranslate"><span class="pre">_</span></code>.
Similarly, any other symbol
or special character (for instance, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">!</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, etc) <strong>SHOULD BE</strong> avoided and discarded
or replaced with underscore <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p>
</div>
<p>For example, let’s suppose we have a DataFrame where <code class="docutils literal notranslate"><span class="pre">response</span></code> is the ordinal variable,
<code class="docutils literal notranslate"><span class="pre">age</span></code> and <code class="docutils literal notranslate"><span class="pre">sex</span></code> are respectively a quantitative and a qualitative variable to explain the <em>feeling</em> component
only, in a <code class="docutils literal notranslate"><span class="pre">cub</span></code> family model. The formula will be <code class="docutils literal notranslate"><span class="pre">formula</span> <span class="pre">=</span> <span class="pre">&quot;response</span> <span class="pre">~</span> <span class="pre">0</span> <span class="pre">|</span> <span class="pre">age</span> <span class="pre">+</span> <span class="pre">C(sex)&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python will automatically order qualitative variables in alphanumeric order. So, for
instance, a variable <code class="docutils literal notranslate"><span class="pre">sex</span></code> with two categories <code class="docutils literal notranslate"><span class="pre">&quot;M&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;F&quot;</span></code> will be ordered as
<code class="docutils literal notranslate"><span class="pre">[&quot;F&quot;,</span> <span class="pre">&quot;M&quot;]</span></code> thus the dummy variabile will be equal to <code class="docutils literal notranslate"><span class="pre">0</span></code> where <code class="docutils literal notranslate"><span class="pre">sex==&quot;F&quot;</span></code> and equal
to <code class="docutils literal notranslate"><span class="pre">1</span></code> where otherwise <code class="docutils literal notranslate"><span class="pre">sex==&quot;M&quot;</span></code>. Consequently, the estimated parameters will be the
<code class="docutils literal notranslate"><span class="pre">constant</span></code> for <code class="docutils literal notranslate"><span class="pre">sex==&quot;F&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">C.sex_M</span></code> for <code class="docutils literal notranslate"><span class="pre">sex==&quot;M&quot;</span></code>. If you want a different order
for the categorical variables, you must specify it in the <em>DataFrame</em>, for instance with the
<code class="docutils literal notranslate"><span class="pre">pandas</span></code> class <code class="docutils literal notranslate"><span class="pre">Categorical</span></code>. In the example:</p>
<div class="literal-block-wrapper docutils container" id="id42">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id42" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
<span class="linenos">2</span>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">],</span>
<span class="linenos">3</span>    <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">],</span>
<span class="linenos">4</span>    <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
<span class="linenos">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that spaces are allowed between symbols and variable names in the formula but they aren’t
needed: a formula <code class="docutils literal notranslate"><span class="pre">&quot;ord</span> <span class="pre">~</span> <span class="pre">X</span> <span class="pre">|</span> <span class="pre">Y1</span> <span class="pre">+</span> <span class="pre">Y2</span> <span class="pre">|</span> <span class="pre">Z&quot;</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">&quot;ord~X|Y1+Y2|Z&quot;</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The number of fields separated by the pipeline <code class="docutils literal notranslate"><span class="pre">|</span></code> in a formula <strong>MUST BE</strong> equal to
the number of parameters specifying the model family. Therefore: two for <code class="docutils literal notranslate"><span class="pre">cub</span></code> and <code class="docutils literal notranslate"><span class="pre">cush2</span></code>,
three for <code class="docutils literal notranslate"><span class="pre">cube</span></code> and <code class="docutils literal notranslate"><span class="pre">cub</span></code> with shelter effect, one for <code class="docutils literal notranslate"><span class="pre">cush</span></code> and <code class="docutils literal notranslate"><span class="pre">ihg</span></code>.</p>
</div>
</section>
<section id="arguments-of-estimate-and-draw">
<h3>Arguments of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code><a class="headerlink" href="#arguments-of-estimate-and-draw" title="Link to this heading">#</a></h3>
<p>Within the function <code class="docutils literal notranslate"><span class="pre">estimate</span></code> the number of ordinal categories <code class="docutils literal notranslate"><span class="pre">m</span></code> is internally retrieved if not specified
(taking the maximum observed category)
but it is advisable to pass it as an argument to the call if some category has zero frequency.
Within the function <code class="docutils literal notranslate"><span class="pre">draw</span></code> instead, the number of ordinal categories <code class="docutils literal notranslate"><span class="pre">m</span></code>
will default to <code class="docutils literal notranslate"><span class="pre">7</span></code> if not otherwise specified.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame must always be passed to the function <code class="docutils literal notranslate"><span class="pre">estimate</span></code>, with the <em>kwarg</em>
(keyword argument) <code class="docutils literal notranslate"><span class="pre">df</span></code>.
It should contain, at least, a column of the observed sample and the columns of the covariates (if any).
If no <code class="docutils literal notranslate"><span class="pre">df</span></code> is passed to the function <code class="docutils literal notranslate"><span class="pre">draw</span></code> for a model without covariates
instead, an empty DataFrame will be created.</p>
<p>The number <code class="docutils literal notranslate"><span class="pre">n</span></code> of ordinal responses to be drawn will default to <code class="docutils literal notranslate"><span class="pre">500</span></code> if not otherwise specified
in the function <code class="docutils literal notranslate"><span class="pre">draw</span></code>
for models without covariates. For model with covariates instead, <code class="docutils literal notranslate"><span class="pre">n</span></code> is not effective because
the number of drawn ordinal responses will be equal to the passed DataFrame rows.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">seed</span></code> could be specified for the function <code class="docutils literal notranslate"><span class="pre">draw</span></code> to ensure reproducibility.
Notice that, for models with covariates, <code class="docutils literal notranslate"><span class="pre">seed</span></code> cannot be <code class="docutils literal notranslate"><span class="pre">0</span></code> (in case, it will be
automatically set to <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">model</span></code> is declared, the function takes <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code> as default.
Currently implemented models are: <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code> (default), <code class="docutils literal notranslate"><span class="pre">&quot;cush&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cube&quot;</span></code>,
and <code class="docutils literal notranslate"><span class="pre">&quot;ihg&quot;</span></code>. CUB models with shelter effect are automatically
implemented using <code class="docutils literal notranslate"><span class="pre">model=&quot;cub&quot;</span></code> and specifying a shelter choice with the
<em>kwarg</em> <code class="docutils literal notranslate"><span class="pre">sh</span></code>. CUSH2 models are automatically
implemented using <code class="docutils literal notranslate"><span class="pre">model=&quot;cush&quot;</span></code> and passing a list of two categories to
the <em>kwarg</em> <code class="docutils literal notranslate"><span class="pre">sh</span></code> instead of an integer, for instance <code class="docutils literal notranslate"><span class="pre">sh=[2,</span> <span class="pre">7]</span></code>.</p>
<p>To the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method, the parameters’ values (with the <em>kwargs</em> of the corresponding
family) must always be passed:
for example, <code class="docutils literal notranslate"><span class="pre">pi</span></code> and <code class="docutils literal notranslate"><span class="pre">xi</span></code> for CUB models without covariates, <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code>
for CUB models with covariates for both feeling and uncertainty, etc. See the
<code class="docutils literal notranslate"><span class="pre">.draw()</span></code> function reference of the corresponding family module for details.</p>
<p>If  <code class="docutils literal notranslate"><span class="pre">model=&quot;cub&quot;</span></code> (or nothing), then a CUB mixture model is fitted to the data to explain uncertainty,
feeling (<code class="docutils literal notranslate"><span class="pre">ordinal~Y|W</span></code>) and possible shelter effect by further passing the extra argument <code class="docutils literal notranslate"><span class="pre">sh</span></code> for the corresponding category.
Subjects’ covariates can be included by specifying covariates matrices in the
formula as <code class="docutils literal notranslate"><span class="pre">ordinal~Y|W|X</span></code>,  to explain uncertainty (Y), feeling (W) or shelter (X).
Notice that
covariates for the shelter effect can be included only if specified for both feeling and uncertainty too (GeCUB models)
because, as in the R package <code class="docutils literal notranslate"><span class="pre">CUB</span></code>, only the models without covariates and with covariates for all components
have been implemented.
Nevertheless, the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> could be used to specify a different combination of components with covariates.
For example, if we want to specify a CUB model with the covariate <code class="docutils literal notranslate"><span class="pre">cov</span></code> for uncertainty only, we could pass the
formula <code class="docutils literal notranslate"><span class="pre">ordinal</span> <span class="pre">~</span> <span class="pre">cov</span> <span class="pre">|</span> <span class="pre">1</span> <span class="pre">|</span> <span class="pre">1</span></code>: in this case, for feeling and shelter effect, the constant terms only
(<span class="math notranslate nohighlight">\(\gamma_0\)</span> and <span class="math notranslate nohighlight">\(\omega_0\)</span>) will be estimated and the values of the estimated <span class="math notranslate nohighlight">\(\xi\)</span> and
<span class="math notranslate nohighlight">\(\delta\)</span> could be computed as <span class="math notranslate nohighlight">\(\hat\xi=\mathrm{expit}(\hat\gamma_0)\)</span> and
<span class="math notranslate nohighlight">\(\hat\delta=\mathrm{expit}(\hat\omega_0)\)</span>, where <span class="math notranslate nohighlight">\(\mathrm{expit}(x) = 1 / (1 + \exp(-x))\)</span>.
See <a class="reference external" href="#cubsh-with-covariates">this example</a> for the GeCUB model.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">family=&quot;cube&quot;</span></code>, then a CUBE mixture model (Combination of Uniform and Beta-Binomial) is fitted to the data
to explain uncertainty, feeling and overdispersion. Subjects’ covariates can also be included to explain the
feeling component or all the three components by  specifying covariates matrices in the Formula as
<code class="docutils literal notranslate"><span class="pre">ordinal~Y|W|Z</span></code> to explain uncertainty (Y), feeling (W) or
overdispersion (Z). For different combinations of components with covariates, the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> can be used.
Notice that <span class="math notranslate nohighlight">\(\hat\phi=e^{\hat\alpha_0}\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">family=&quot;ihg&quot;</span></code>, then an IHG model is fitted to the data. IHG models (Inverse HyperGeometric) are a peculiar case of
CUBE models, for <span class="math notranslate nohighlight">\(\phi = 1 - \xi\)</span> <span id="id1">(<a class="reference internal" href="references.html#id16" title="Maria Iannario. Cube models for interpreting ordered categorical data with overdispersion. Quaderni di statistica, 14:137–140, 2012.">Iannario, 2012</a>)</span>. The parameter <span class="math notranslate nohighlight">\(\theta\)</span> gives the probability of observing
the first category and is therefore a direct measure of preference, attraction, pleasantness toward the
investigated item. This is the reason why <span class="math notranslate nohighlight">\(\theta\)</span> is customarily referred to as the
preference parameter of the
IHG model. Covariates for the preference parameter <span class="math notranslate nohighlight">\(\theta\)</span> have to be specified
in matrix form in the Formula as <code class="docutils literal notranslate"><span class="pre">ordinal~V</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">family=&quot;cush&quot;</span></code>, then a CUSH model is fitted to the data (Combination of Uniform and SHelter effect).
If a category corresponding to the inflation should be
passed via argument <code class="docutils literal notranslate"><span class="pre">sh</span></code> a CUSH model is called and
covariates for the shelter parameter <span class="math notranslate nohighlight">\(\delta\)</span>
are specified in matrix form Formula as <code class="docutils literal notranslate"><span class="pre">ordinal~X</span></code>.
If two category corresponding to the inflation should be
passed via argument <code class="docutils literal notranslate"><span class="pre">sh</span></code> (as a <em>list</em> or <em>array</em>) a CUSH2 model is called and
covariates for the shelters’ parameters <span class="math notranslate nohighlight">\((\delta_1,\delta_2)\)</span>
are specified in matrix form Formula as <code class="docutils literal notranslate"><span class="pre">ordinal~X1|X2</span></code>.
Notice that, to specify covariates for a
single shelter choice in a CUSH2 model,
the formula should be <code class="docutils literal notranslate"><span class="pre">ordinal~X1|0</span></code> and not <code class="docutils literal notranslate"><span class="pre">ordinal~0|X2</span></code>.</p>
<p>Extra arguments include the maximum
number of iterations <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> for the optimization algorithm,
the required error tolerance <code class="docutils literal notranslate"><span class="pre">tol</span></code>, and a dictionary of parameters of a known model
<code class="docutils literal notranslate"><span class="pre">ass_pars</span></code> (assumed parameters) to be compared with the estimates: these could be
the parameters used to draw the sample, theoretical parameters, or howsoever specified
parameters we want to (graphically) compare with the estimates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ass_pars</span></code> argument is effective for models with covariates too.
The <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method will show the average probability distribution of the model specified
with the assumed parameters.</p>
</div>
</section>
<section id="methods-of-estimate-and-draw">
<h3>Methods of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code><a class="headerlink" href="#methods-of-estimate-and-draw" title="Link to this heading">#</a></h3>
<p>For both functions, the methods <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> and <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> are always available calling the
main functions to print a summary and plot the results, respectively. For <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> arguments
and options, see <a class="reference external" href="cubmods.html#cubmods.smry.CUBsample">here</a> the <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> Class
(for object returned by <code class="docutils literal notranslate"><span class="pre">draw</span></code>)
and the extended <code class="docutils literal notranslate"><span class="pre">CUBres</span></code> Classes of the corresponding
family (for objects returned by <code class="docutils literal notranslate"><span class="pre">estimate</span></code>), defined in each family module.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> of objects returned by <code class="docutils literal notranslate"><span class="pre">estimate</span></code> function, will print a summary
of the inferential method applied to the observed sample. Along with estimated parameters,
standard errors, Wald tests, and p-values, it will show some model metrics:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Correlation</span></code>: available for CUB family models without covariates only; it is the correlation between
<span class="math notranslate nohighlight">\(\hat{\pi}\)</span> and <span class="math notranslate nohighlight">\(\hat{\xi}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dissimilarity</span></code>: the dissimilarity index that can be interpreted as the fraction of sample to be
change to achieve a perfect fit given the estimated parameters; available for all models with and
without covariates; for models with covariates, the average estimated probability is used</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Loglik(sat)</span></code>: the log-likelihood of the <em>saturated</em> model; see <a class="reference external" href="cubmods.html#cubmods.general.lsat">here</a>
and the reference paper
<span id="id2"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>; available for models without covariates only</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Loglik(MOD)</span></code>: the log-likelihood of the estimated model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Loglik(uni)</span></code>: the log-likelihood of the <em>null</em> model; see <a class="reference external" href="cubmods.html#cubmods.general.luni">here</a>
and the reference paper
<span id="id3"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Mean-loglik</span></code>: mean log-likelihood, i.e. the log-likelihood of the estimated model divided
by the number <span class="math notranslate nohighlight">\(n\)</span> of observed ordinal responses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Deviance</span></code>: Likelihood Ratio Test (LRT) between the saturated and the estimated models; available
for models without covariates only</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AIC</span></code>: Akaike Information Criterion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BIC</span></code>: Bayesian Information Criterion.</p></li>
</ul>
<p>Calling <code class="docutils literal notranslate"><span class="pre">.as_dataframe()</span></code> will return a DataFrame of parameters’ names and values for objects
of the Class <code class="docutils literal notranslate"><span class="pre">CUBsample</span></code> returned by <code class="docutils literal notranslate"><span class="pre">draw</span></code>. For objects of the extended Base Class <code class="docutils literal notranslate"><span class="pre">CUBres</span></code> returned
by <code class="docutils literal notranslate"><span class="pre">estimate</span></code> instead, will return a DataFrame with parameters’ component, name, estimated value,
standard error, Wald test statistics and p-value.</p>
<p>Calling the method <code class="docutils literal notranslate"><span class="pre">.save(fname)</span></code> the object can be saved on a file called <code class="docutils literal notranslate"><span class="pre">fname.cub.sample</span></code>
(for <code class="docutils literal notranslate"><span class="pre">draw</span></code>) or <code class="docutils literal notranslate"><span class="pre">fname.cub.fit</span></code> (for <code class="docutils literal notranslate"><span class="pre">estimate</span></code>).
Saved objects can then be loaded using the function <code class="docutils literal notranslate"><span class="pre">general.load_object(fname)</span></code>.
See <a class="reference external" href="#save-load-example">this example</a>.</p>
</section>
<section id="attributes-of-estimate-and-draw">
<h3>Attributes of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code><a class="headerlink" href="#attributes-of-estimate-and-draw" title="Link to this heading">#</a></h3>
<p>For both objects returned by <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code>, the attributes <code class="docutils literal notranslate"><span class="pre">.formula</span></code> and
<code class="docutils literal notranslate"><span class="pre">.df</span></code> are always available. The function <code class="docutils literal notranslate"><span class="pre">draw</span></code> will return the original DataFrame (if provided)
with an extra column of the drawn ordinal response called as specified in the formula.</p>
<p>Many other attributes can be called from objects of the Base Class <code class="docutils literal notranslate"><span class="pre">CUBres</span></code> returned by
<code class="docutils literal notranslate"><span class="pre">estimate</span></code>, such as the computed loglikelihood, the AIC and BIC, etc. For details,
see <a class="reference external" href="cubmods.html#cubmods.smry.CUBres">here</a> the Base Class <code class="docutils literal notranslate"><span class="pre">CUBres</span></code> reference guide.</p>
</section>
</section>
<section id="cub-family">
<h2>CUB family<a class="headerlink" href="#cub-family" title="Link to this heading">#</a></h2>
<p>Basic family of the class CUB. See the references for details:
<span id="id4"><a class="reference internal" href="references.html#id4" title="Domenico Piccolo. On the moments of a mixture of uniform and shifted binomial random variables. Quaderni di Statistica, 5(1):85–104, 2003.">Piccolo, 2003</a></span>; <span id="id5"><a class="reference internal" href="references.html#id5" title="Angela D'Elia and Domenico Piccolo. A mixture model for preferences data analysis. Computational Statistics &amp; Data Analysis, 49(3):917–934, 2005.">D'Elia and Piccolo, 2005</a></span>; <span id="id6"><a class="reference internal" href="references.html#id7" title="Domenico Piccolo. Observed information matrix for MUB models. Quaderni di Statistica, 8(1):33–78, 2006.">Piccolo, 2006</a></span>;
<span id="id7"><a class="reference internal" href="references.html#id8" title="Maria Iannario and Domenico Piccolo. A new statistical model for the analysis of customer satisfaction. Quality Technology &amp; Quantitative Management, 7(2):149–168, 2010.">Iannario and Piccolo, 2010</a></span>; <span id="id8"><a class="reference internal" href="references.html#id21" title="Maria Iannario and Domenico Piccolo. A program in R for CUB models inference. Available via Internet, URL http://www. dipstat. unina. it/CUBmodels/, Version, 2009.">Iannario and Piccolo, 2009</a></span>; <span id="id9"><a class="reference internal" href="references.html#id22" title="Maria Iannario, Domenico Piccolo, and others. Inference for CUB models: a program in R. Statistica &amp; Applicazioni, 12(2):177–204, 2014.">Iannario <em>et al.</em>, 2014</a></span>;
<span id="id10"><a class="reference internal" href="references.html#id23" title="Maria Iannario, Domenico Piccolo, and Rosaria Simone (Maintainer). Package ‘CUB’. CRAN, 2022.">Iannario <em>et al.</em>, 2022</a></span>; <span id="id11"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>.</p>
<section id="without-covariates">
<span id="cub-without-covariates"></span><h3>Without covariates<a class="headerlink" href="#without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cub00-module">Reference guide</a></p>
<p>A model of the CUB family for responses with <span class="math notranslate nohighlight">\(m\)</span> ordinal categories, without covariates is specified as</p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\boldsymbol{\theta}) = \pi \dbinom{m-1}{r-1}(1-\xi)^{r-1}\xi^{m-r}+\dfrac{1-\pi}{m},
\; r = 1,2,\ldots,m\]</div>
<p>where <span class="math notranslate nohighlight">\(\pi\)</span> and <span class="math notranslate nohighlight">\(\xi\)</span> are the parameters for respectively the <em>uncertainty</em> and the
<em>feeling</em> components.</p>
<p>Note that <span class="math notranslate nohighlight">\((1-\pi)\)</span> is the weight of the Uncertainty component and
<span class="math notranslate nohighlight">\((1-\xi)\)</span> is the Feeling component for common <em>positive wording</em>.</p>
<p>In the following example, a sample will be drawn from a CUB model of <span class="math notranslate nohighlight">\(n=500\)</span> observations of an ordinal
variable with <span class="math notranslate nohighlight">\(m=10\)</span> ordinal categories
and parameters <span class="math notranslate nohighlight">\((\pi=.7, \xi=.2)\)</span>. A <code class="docutils literal notranslate"><span class="pre">seed=1</span></code> will be set to ensure reproducibility.</p>
<p>Notice that a Dissimilarity index is computed: this should be interpreted as the fraction of the
drawn sample to be changed to achieve a perfect fit to the theoretical specified model the sample
has been drawn from.</p>
<div class="literal-block-wrapper docutils container" id="id43">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id43" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># draw a sample</span>
<span class="linenos"> 6</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0 | 0&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pi</span><span class="o">=</span><span class="mf">.7</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">10</span><span class="c1"># print the summary of the drawn sample</span>
<span class="linenos">11</span><span class="nb">print</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">12</span><span class="c1"># show the plot of the drawn sample</span>
<span class="linenos">13</span><span class="n">drawn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">14</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>=======================================================================
=====&gt;&gt;&gt; CUB model &lt;&lt;&lt;===== Drawn random sample
=======================================================================
m=10  Sample size=500  seed=1
formula: ord~0|0
-----------------------------------------------------------------------
  component parameter  value
Uncertainty        pi    0.7
    Feeling        xi    0.2
=======================================================================
Sample metrics
Mean     = 7.368000
Variance = 5.687952
Std.Dev. = 2.384943
-----------------------------------------------------------------------
Dissimilarity = 0.0650938
=======================================================================
</pre></div>
</div>
<img alt="CUB00 drawn sample" src="_images/cub00draw.png" />
<p>Notice that, since the default value of the <em>kwarg</em> <code class="docutils literal notranslate"><span class="pre">model</span></code> is
<code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code> we do not need to specify it.</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">drawn.as_dataframe()</span></code> will return a DataFrame with
the specified parameters of the theoretical model</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     component parameter  value
0  Uncertainty        pi    0.7
1      Feeling        xi    0.2
</pre></div>
</div>
<p>Using the previously drawn sample, in the next example the parameters <span class="math notranslate nohighlight">\((\hat\pi, \hat\xi)\)</span> will be estimated.</p>
<p>Note that in the function <code class="docutils literal notranslate"><span class="pre">gem.estimate</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code> needs to be a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame; the attribute <code class="docutils literal notranslate"><span class="pre">drawn.df</span></code> will return a DataFrame with <code class="docutils literal notranslate"><span class="pre">ord</span></code> as column name of the drawn ordinal response (as previuosly speficied in the formula)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formula</span></code> needs the ordinal variable name (<code class="docutils literal notranslate"><span class="pre">ord</span></code> in this case) and the covariates for each component (none in this case, so <code class="docutils literal notranslate"><span class="pre">&quot;0|0&quot;</span></code>)</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">m</span></code> is not provided, the maximum observed ordinal value will be assumed and a warning will be raised</p></li>
<li><p>with <code class="docutils literal notranslate"><span class="pre">ass_pars</span></code> dictionary, the parameters of a known model (if any) can be specified; in this case, we’ll specify the known parameters used to draw the sample</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id44">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id44" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos"> 2</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos"> 3</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord~0|0&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos"> 6</span>        <span class="s2">&quot;pi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 7</span>        <span class="s2">&quot;xi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 8</span>    <span class="p">}</span>
<span class="linenos"> 9</span><span class="p">)</span>
<span class="linenos">10</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">11</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">12</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">13</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">14</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUB model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=10  Size=500  Iterations=13  Maxiter=500  Tol=1E-04
-----------------------------------------------------------------------
Uncertainty
    Estimates  StdErr    Wald  p-value
pi      0.675  0.0340  19.872   0.0000
-----------------------------------------------------------------------
Feeling
    Estimates  StdErr    Wald  p-value
xi      0.188  0.0090  20.808   0.0000
-----------------------------------------------------------------------
Correlation   = 0.2105
=======================================================================
Dissimilarity = 0.0599
Loglik(sat)   = -994.063
Loglik(MOD)   = -1000.111
Loglik(uni)   = -1151.293
Mean-loglik   = -2.000
Deviance      = 12.096
-----------------------------------------------------------------------
AIC = 2004.22
BIC = 2012.65
=======================================================================
Elapsed time=0.00202 seconds =====&gt;&gt;&gt; Thu Sep 26 18:00:53 2024
=======================================================================
</pre></div>
</div>
<img alt="CUB 00 MLE" src="_images/cub00mle.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>See <a class="reference external" href="cubmods.html#module-cubmods.general">here</a> the reference guide
of <code class="docutils literal notranslate"><span class="pre">general</span></code> module and the reference paper
<span id="id12"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>
for details about log-likelihoods,
deviance and information criteria.</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">fit.as_dataframe()</span></code> will return a DataFrame with
parameters’ estimated values and standard errors</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     component parameter  estimate    stderr       wald        pvalue
0  Uncertainty        pi   0.67476  0.033954  19.872485  7.042905e-88
1      Feeling        xi   0.18817  0.009043  20.807551  3.697579e-96
</pre></div>
</div>
<p id="save-load-example">As an example, we can now save the <code class="docutils literal notranslate"><span class="pre">fit</span></code> object to file. By default,
it will be saved as a <code class="docutils literal notranslate"><span class="pre">pickle</span></code> file.</p>
<div class="literal-block-wrapper docutils container" id="id45">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id45" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">fit</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;cub_mle_results&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The previous code, will save a file <code class="docutils literal notranslate"><span class="pre">cub_mle_results.cub.fit</span></code>.</p>
<p>We can then load the saved file with the code</p>
<div class="literal-block-wrapper docutils container" id="id46">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id46" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">load_object</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">myfit</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span><span class="s2">&quot;cub_mle_results.cub.fit&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>and we can apply to <code class="docutils literal notranslate"><span class="pre">myfit</span></code> the same methods and attributes of the original <code class="docutils literal notranslate"><span class="pre">fit</span></code> object.</p>
</section>
<section id="with-covariates">
<span id="cub-with-covariates"></span><h3>With covariates<a class="headerlink" href="#with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cub0w-module">Reference guide (0|W)</a></p>
<p><a class="reference external" href="cubmods.html#cuby0-module">Reference guide (Y|0)</a></p>
<p><a class="reference external" href="cubmods.html#cubyw-module">Reference guide (Y|W)</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R_i=r|\pmb\theta, \pmb y_i, \pmb w_i) = \pi_i \dbinom{m-1}{r-1}(1-\xi_i)^{r-1}\xi_i^{m-r}+\dfrac{1-\pi_i}{m}
,\; r = 1,2,\ldots,m\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \pi_i = \dfrac{1}{1+\exp\{-\pmb y_i \pmb \beta\}}
    \\
    \xi_i = \dfrac{1}{1+\exp\{-\pmb w_i \pmb \gamma\}}
\end{array}
\right.
\quad \equiv \quad
\left\{
\begin{array}{l}
    \mathrm{logit}(1-\pi_i) = - \pmb y_i \pmb \beta
    \vphantom{\dfrac{1}{1+\exp\{-\pmb y_i \pmb \beta\}}}
    \\
    \mathrm{logit}(1-\xi_i) = - \pmb w_i \pmb \gamma
    \vphantom{\dfrac{1}{1+\exp\{-\pmb w_i \pmb \gamma\}}}
\end{array}
\right.\end{split}\]</div>
<p>All three combinations of covariates has been implemented for CUB family in both Python and R:
for <em>uncertainty</em> only, for <em>feeling</em> only, and for <em>both</em>.</p>
<p>Here we’ll show an example with covariates for <em>feeling</em> only.</p>
<p>First of all, we’ll draw a random sample with two covariates for the <em>feeling</em> component:
<code class="docutils literal notranslate"><span class="pre">W1</span></code> and <code class="docutils literal notranslate"><span class="pre">W2</span></code>. Note that, having two covariates, we’ll need three <span class="math notranslate nohighlight">\(\gamma\)</span> parameters,
to consider the constant term too.</p>
<div class="literal-block-wrapper docutils container" id="id47">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id47" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Draw a random sample</span>
<span class="linenos"> 8</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos"> 9</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">10</span><span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">14</span>    <span class="s2">&quot;W1&quot;</span><span class="p">:</span> <span class="n">W1</span><span class="p">,</span> <span class="s2">&quot;W2&quot;</span><span class="p">:</span> <span class="n">W2</span>
<span class="linenos">15</span><span class="p">})</span>
<span class="linenos">16</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">17</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;response ~ 0 | W1 + W2&quot;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="n">pi</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span><span class="c1"># print the summary</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>=======================================================================
=====&gt;&gt;&gt; CUB(0W) model &lt;&lt;&lt;===== Drawn random sample
=======================================================================
m=10  Sample size=1000  seed=None
formula: res~0|W1+W2
-----------------------------------------------------------------------
  component parameter  value
Uncertainty        pi    0.8
    Feeling  constant    2.3
    Feeling        W1    0.2
    Feeling        W2   -5.0
=======================================================================
Sample metrics
Mean     = 4.566000
Variance = 8.089734
Std.Dev. = 2.844246
-----------------------------------------------------------------------
Dissimilarity = 0.0307673
=======================================================================
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id48">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id48" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># plot the drawn sample</span>
<span class="linenos">2</span><span class="n">drawn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">3</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<img alt="CUB0W drawn sample" src="_images/cub0wdraw.png" />
<div class="literal-block-wrapper docutils container" id="id49">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id49" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># print the parameters&#39; values</span>
<span class="linenos">2</span><span class="nb">print</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     component parameter  value
0  Uncertainty        pi    0.8
1      Feeling  constant    2.3
2      Feeling        W1    0.2
3      Feeling        W2   -5.0
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id50">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id50" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># print the updated DataFrame</span>
<span class="linenos">2</span><span class="nb">print</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     W1        W2  res
0     6  0.374540    2
1     9  0.950714    7
2     6  0.731994    8
3     1  0.598658    8
4     1  0.156019    4
..   ..       ...  ...
995   3  0.091582    2
996   9  0.917314    9
997   4  0.136819    1
998   7  0.950237    3
999   8  0.446006    2

[1000 rows x 3 columns]
</pre></div>
</div>
<p>Finally, we’ll call <code class="docutils literal notranslate"><span class="pre">estimate</span></code> to estimate the parameters
given the observed (actually, drawn) sample.
We’ll pass the parameters used to drawn the sample with
<code class="docutils literal notranslate"><span class="pre">ass_pars</span></code> (as a dictionary) to graphically compare the
assumed and the estimated average probability distribution.</p>
<div class="literal-block-wrapper docutils container" id="id51">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id51" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># MLE estimation</span>
<span class="linenos"> 2</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos"> 3</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;res ~ 0 | W1+W2&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos"> 5</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos"> 6</span>        <span class="s2">&quot;pi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 7</span>        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="linenos"> 8</span>    <span class="p">}</span>
<span class="linenos"> 9</span><span class="p">)</span>
<span class="linenos">10</span><span class="c1"># Print MLE summary</span>
<span class="linenos">11</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">12</span><span class="c1"># plot the results</span>
<span class="linenos">13</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">14</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUB(0W) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=10  Size=1000  Iterations=18  Maxiter=500  Tol=1E-04
-----------------------------------------------------------------------
Uncertainty
          Estimates  StdErr     Wald  p-value
pi            0.800  0.0198   40.499   0.0000
-----------------------------------------------------------------------
Feeling
          Estimates  StdErr     Wald  p-value
constant      2.353  0.1001   23.514   0.0000
W1            0.194  0.0138   14.034   0.0000
W2           -5.076  0.1454  -34.909   0.0000
=======================================================================
Dissimilarity = 0.0292
Loglik(MOD)   = -1807.052
Loglik(uni)   = -2302.585
Mean-loglik   = -1.807
-----------------------------------------------------------------------
AIC = 3622.10
BIC = 3641.74
=======================================================================
Elapsed time=0.09656 seconds =====&gt;&gt;&gt; Thu Aug 15 18:31:21 2024
=======================================================================
</pre></div>
</div>
<img alt="CUB0W MLE" src="_images/cub0wmle.png" />
</section>
</section>
<section id="cubsh-family">
<h2>CUBSH family<a class="headerlink" href="#cubsh-family" title="Link to this heading">#</a></h2>
<p>Basic family of the class CUB with shelter effect.</p>
<p>See the references for details: <span id="id13"><a class="reference internal" href="references.html#id10" title="Marcella Corduas, Maria Iannario, and Domenico Piccolo. A class of statistical models for evaluating services and performances. In Statistical methods for the evaluation of educational services and quality of products, pages 99–117. Springer, 2009.">Corduas <em>et al.</em>, 2009</a></span>;
<span id="id14"><a class="reference internal" href="references.html#id9" title="Maria Iannario. Modelling shelter choices in a class of mixture models for ordinal responses. Statistical Methods &amp; Applications, 21:1–22, 2012.">Iannario, 2012</a></span>;
<span id="id15"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>.</p>
<section id="cubsh-without-covariates">
<span id="id16"></span><h3>Without covariates<a class="headerlink" href="#cubsh-without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cubsh000-module">Reference guide</a></p>
<p>A model of the CUB family with shelter effect
for responses with <span class="math notranslate nohighlight">\(m\)</span> ordinal categories, without covariates is specified as</p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\boldsymbol{\theta}) = \delta D_r^{(c)} + (1-\delta)\left(\pi b_r(\xi) + \frac{1-\pi}{m} \right)
,\; r=1,2,\ldots,m\]</div>
<p>where <span class="math notranslate nohighlight">\(\pi\)</span> and <span class="math notranslate nohighlight">\(\xi\)</span> are the parameters for respectively the <em>uncertainty</em> and the
<em>feeling</em> components, and <span class="math notranslate nohighlight">\(\delta\)</span> is the weight of the shelter effect.</p>
<p>Other parametrizations have been proposed, such as</p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\boldsymbol{\theta}) = \lambda b_r(\xi) + (1-\lambda) \left[ \eta/m + (1-\eta) D_r^{(c)} \right]
,\; r=1,2,\ldots,m\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \lambda = \pi(1-\delta)
    \\
    \eta = \dfrac{(1-\pi)(1-\delta)}{1 - \pi(1-\delta)}
\end{array}
\right.\end{split}\]</div>
<p>See <span id="id17"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span> (pp 412-413) for the parameters’ interpretation.</p>
<p>Another parametrization, particularly useful for inferential issues is</p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\boldsymbol{\theta}) = \pi_1 b_r{\xi} + \pi_2 /m  + (1-\pi_1-\pi_2) D_r^{(c)}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \pi_1 = (1-\delta)\pi
    \\
    \pi_2 = (1-\delta)(1-\pi)
\end{array}
\right.\end{split}\]</div>
<p>See the references for further details.</p>
<p>In the next example, we’ll draw an ordinal response
and then estimate the parameters given the sample.</p>
<div class="literal-block-wrapper docutils container" id="id52">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id52" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># draw a sample</span>
<span class="linenos"> 6</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0 | 0 | 0&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">m</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">pi</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="n">n</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     component parameter  value
0      Uniform       pi1   0.68
1     Binomial       pi2   0.17
2      Feeling        xi   0.40
3  Uncertainty       *pi   0.80
4      Shelter    *delta   0.15
</pre></div>
</div>
<p>Notice that:</p>
<ul class="simple">
<li><p>since <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code> is default value of the <em>kwarg</em> <code class="docutils literal notranslate"><span class="pre">model</span></code>, we do not need to specify it</p></li>
<li><p>we’ll pass to <code class="docutils literal notranslate"><span class="pre">estimate</span></code> <em>kwarg</em> values taken from the object <code class="docutils literal notranslate"><span class="pre">drawn</span></code></p></li>
</ul>
<p id="confidence-ellipsoid">The method <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> (of the <code class="docutils literal notranslate"><span class="pre">fit</span></code> object)
shows, in the parameters space, the trivariate confidence ellipsoid too, which has not
been implemented yet in the <code class="docutils literal notranslate"><span class="pre">CUB</span></code> package in R.
The plot includes the marginal bivariate confidence ellipses too. Notice that, as proven in
<span id="id18"><a class="reference internal" href="references.html#id42" title="Massimo Pierini. Modelli della classe CUB in python. Universitas Mercatorum, Rome, IT, pages 1–172, June 2024. (Bachelor's thesis L-41).">Pierini, 2024</a></span> pp 28-30, the confidence level of the marginal ellipses is greater
than the ellipsoid’s confidence level. Indeed, the radius <span class="math notranslate nohighlight">\(r\)</span> of a
standardized sphere at confidence
level <span class="math notranslate nohighlight">\((1-\alpha_3)\)</span> is equal to <span class="math notranslate nohighlight">\(r = \sqrt{ F^{-1}_{\chi^2_{(3)}}(1-\alpha_3) }\)</span>, thus
the confidence level of the bivariate marginal ellipses (which are sections of trivariate
cylinders) is <span class="math notranslate nohighlight">\((1-\alpha_2) = F_{\chi^2_{(2)}}(r^2)\)</span>.</p>
<div class="literal-block-wrapper docutils container" id="id53">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id53" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos"> 2</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos"> 3</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">sh</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="n">formula</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
<span class="linenos"> 5</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos"> 6</span>        <span class="s2">&quot;pi1&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 7</span>        <span class="s2">&quot;pi2&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos"> 8</span>        <span class="s2">&quot;xi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos"> 9</span>    <span class="p">}</span>
<span class="linenos">10</span><span class="p">)</span>
<span class="linenos">11</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">13</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">14</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">15</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUBSH model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=7  Shelter=1  Size=1500  Iterations=59  Maxiter=500  Tol=1E-04
-----------------------------------------------------------------------
Alternative parametrization
       Estimates  StdErr    Wald  p-value
pi1        0.661  0.0307  21.508   0.0000
pi2        0.174  0.0344   5.041   0.0000
xi         0.388  0.0077  50.592   0.0000
-----------------------------------------------------------------------
Uncertainty
       Estimates  StdErr    Wald  p-value
pi         0.792  0.0400  19.813   0.0000
-----------------------------------------------------------------------
Feeling
       Estimates  StdErr    Wald  p-value
xi         0.388  0.0077  50.592   0.0000
-----------------------------------------------------------------------
Shelter effect
       Estimates  StdErr    Wald  p-value
delta      0.166  0.0116  14.327   0.0000
=======================================================================
Dissimilarity = 0.0049
Loglik(sat)   = -2734.302
Loglik(MOD)   = -2734.433
Loglik(uni)   = -2918.865
Mean-loglik   = -1.823
Deviance      = 0.263
-----------------------------------------------------------------------
AIC = 5474.87
BIC = 5490.81
=======================================================================
</pre></div>
</div>
<img alt="CUBSH 00 MLE" src="_images/cubsh00mle.png" />
</section>
<section id="cubsh-with-covariates">
<span id="id19"></span><h3>With covariates<a class="headerlink" href="#cubsh-with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cubshywx-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R_i=r|\pmb\theta, \pmb y_i, \pmb w_i, \pmb x_i) = \delta_i D_r^{(c)} + (1-\delta_i)\left(\pi_i b_r(\xi_i) + \frac{1-\pi_i}{m} \right)
,\; r=1,2,\ldots,m\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \pi_i = \dfrac{1}{1+\exp\{-\pmb y_i \pmb \beta\}}
    \\
    \xi_i = \dfrac{1}{1+\exp\{-\pmb w_i \pmb \gamma\}}
    \\
    \delta_i = \dfrac{1}{1+\exp\{-\pmb x_i \pmb \omega\}}
\end{array}
\right.
\quad \equiv \quad
\left\{
\begin{array}{l}
    \mathrm{logit}(1-\pi_i) = -\pmb y_i \pmb \beta
    \vphantom{\dfrac{1}{1+\exp\{-\pmb y_i \pmb \beta\}}}
    \\
    \mathrm{logit}(1-\xi_i) = -\pmb w_i \pmb \gamma
    \vphantom{\dfrac{1}{1+\exp\{-\pmb w_i \pmb \gamma\}}}
    \\
    \mathrm{logit}(\delta_i) = \pmb x_i \pmb \omega
    \vphantom{\dfrac{1}{1+\exp\{-\pmb x_i \pmb \omega\}}}
\end{array}
\right.\end{split}\]</div>
<p>Only the model with covariates for all components (GeCUB) has been
currently defined and implemented, as in the R package <code class="docutils literal notranslate"><span class="pre">CUB</span></code>.</p>
<p>Nevertheless, thanks to the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> provided by the
<em>formula</em>, we can specify a different combination
of covariates.</p>
<p>For example, we’ll specifiy a model CUB with shelter effect,
with covariates for uncertainty only. We’ll use the function
<code class="docutils literal notranslate"><span class="pre">logit</span></code> to have better ‘control’ of the parameters values,
because <span class="math notranslate nohighlight">\(\gamma_0 = \mathrm{logit}(\xi)\)</span> and
similarly for <span class="math notranslate nohighlight">\(\pi\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<div class="literal-block-wrapper docutils container" id="id54">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id54" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">expit</span><span class="p">,</span> <span class="n">logit</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Draw a random sample</span>
<span class="linenos"> 9</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos">10</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">13</span>    <span class="s2">&quot;W1&quot;</span><span class="p">:</span> <span class="n">W1</span><span class="p">,</span>
<span class="linenos">14</span><span class="p">})</span>
<span class="linenos">15</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">16</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ W1 | 1 | 1&quot;</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">m</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">beta</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.8</span><span class="p">),</span> <span class="o">-</span><span class="mf">.2</span><span class="p">],</span>
<span class="linenos">20</span>    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.3</span><span class="p">)],</span>
<span class="linenos">21</span>    <span class="n">omega</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.12</span><span class="p">)],</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1"># MLE estimation</span>
<span class="linenos">25</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">26</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ W1 | 1 | 1&quot;</span><span class="p">,</span>
<span class="linenos">27</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">28</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">29</span>        <span class="s2">&quot;beta&quot;</span><span class="p">:[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.8</span><span class="p">),</span> <span class="o">-</span><span class="mf">.2</span><span class="p">],</span>
<span class="linenos">30</span>        <span class="s2">&quot;gamma&quot;</span><span class="p">:[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.3</span><span class="p">)],</span>
<span class="linenos">31</span>        <span class="s2">&quot;omega&quot;</span><span class="p">:[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.12</span><span class="p">)],</span>
<span class="linenos">32</span>    <span class="p">}</span>
<span class="linenos">33</span><span class="p">)</span>
<span class="linenos">34</span><span class="c1"># Print MLE summary</span>
<span class="linenos">35</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">36</span><span class="c1"># plot the results</span>
<span class="linenos">37</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">38</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUBSH(YWX) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Shelter=2  Size=1000  Iterations=25  Maxiter=500  Tol=1E-04
-----------------------------------------------------------------------
Uncertainty
          Estimates  StdErr     Wald  p-value
constant      0.992  0.3314    2.994   0.0028
W1           -0.127  0.0569   -2.228   0.0259
-----------------------------------------------------------------------
Feeling
          Estimates  StdErr     Wald  p-value
constant     -0.902  0.0381  -23.662   0.0000
-----------------------------------------------------------------------
Shelter effect
          Estimates  StdErr     Wald  p-value
constant     -2.074  0.1260  -16.462   0.0000
=======================================================================
Dissimilarity = 0.0139
Loglik(MOD)   = -2069.978
Loglik(uni)   = -2197.225
Mean-loglik   = -2.070
-----------------------------------------------------------------------
AIC = 4147.96
BIC = 4167.59
=======================================================================
Elapsed time=1.43850 seconds =====&gt;&gt;&gt; Thu Aug 15 19:39:49 2024
=======================================================================
</pre></div>
</div>
<img alt="CUBSH YWX MLE" src="_images/cubshywxmle.png" />
<p>To get the estimated values of <span class="math notranslate nohighlight">\(\hat\xi\)</span> and <span class="math notranslate nohighlight">\(\hat\delta\)</span>
we can use the function <code class="docutils literal notranslate"><span class="pre">expit</span></code> because <span class="math notranslate nohighlight">\(\hat\xi = \mathrm{expit}(\hat\gamma_0)\)</span>
and similarly for <span class="math notranslate nohighlight">\(\hat\delta\)</span>. Then, we can use the delta-method
to compute the standard errors of both <span class="math notranslate nohighlight">\(\hat\xi\)</span> and <span class="math notranslate nohighlight">\(\hat\delta\)</span>, for instance
<span class="math notranslate nohighlight">\(\widehat{es}(\xi) = \mathrm{expit}[\hat\gamma_0+\widehat{es}(\gamma_0)] - \hat\xi\)</span>.</p>
<div class="literal-block-wrapper docutils container" id="id55">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id55" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">est_xi</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos"> 2</span><span class="n">est_de</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="linenos"> 3</span><span class="n">est_xi_se</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">fit</span><span class="o">.</span><span class="n">stderrs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">est_xi</span>
<span class="linenos"> 4</span><span class="n">est_de_se</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">fit</span><span class="o">.</span><span class="n">stderrs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="n">est_de</span>
<span class="linenos"> 5</span><span class="nb">print</span><span class="p">(</span>
<span class="linenos"> 6</span>    <span class="s2">&quot;     estimates  stderr</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos"> 7</span>    <span class="sa">f</span><span class="s2">&quot;xi      </span><span class="si">{</span><span class="n">est_xi</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">est_xi_se</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos"> 9</span>    <span class="sa">f</span><span class="s2">&quot;delta   </span><span class="si">{</span><span class="n">est_de</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">est_de_se</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     estimates  stderr
xi      0.2886  0.0079
delta   0.1116  0.0131
</pre></div>
</div>
<p>which, in fact, match the values used to draw the sample.</p>
</section>
</section>
<section id="cush-family">
<h2>CUSH family<a class="headerlink" href="#cush-family" title="Link to this heading">#</a></h2>
<p>Basic family of the class CUSH with a single shelter effect.</p>
<p>See the references for details: <span id="id20"><a class="reference internal" href="references.html#id11" title="Stefania Capecchi and Domenico Piccolo. Dealing with heterogeneity in ordinal responses. Quality &amp; Quantity, 51:2375–2393, 2017.">Capecchi and Piccolo, 2017</a></span>; <span id="id21"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>.</p>
<section id="cush-without-covariates">
<span id="id22"></span><h3>Without covariates<a class="headerlink" href="#cush-without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cush0-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\pmb\theta) = \delta D_r^{(c)} + (1-\delta)/m
,\; r=1,2,\ldots,m\]</div>
<p>In the example, we’ll draw a sample from a CUSH model without covariates and
then estimate the parameter <span class="math notranslate nohighlight">\(\delta\)</span> given the observed sample.</p>
<p>Notice that, since the <code class="docutils literal notranslate"><span class="pre">model</span></code> is not the default <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>, we need to specify it.</p>
<div class="literal-block-wrapper docutils container" id="id56">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id56" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># draw a sample</span>
<span class="linenos"> 6</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">sh</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="n">m</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span>
<span class="linenos">11</span>    <span class="n">n</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">76</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos">14</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">15</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">16</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord~0&quot;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">sh</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">20</span>        <span class="s2">&quot;delta&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">21</span>    <span class="p">}</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">25</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">26</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">27</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUSH model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=7  Shelter=7  Size=1500
-----------------------------------------------------------------------
Shelter effect
       Estimates  StdErr   Wald  p-value
delta      0.124  0.0130  9.532   0.0000
=======================================================================
Dissimilarity = 0.0236
Loglik(sat)   = -2856.039
Loglik(MOD)   = -2859.923
Loglik(uni)   = -2918.865
Mean-loglik   = -1.907
Deviance      = 7.768
-----------------------------------------------------------------------
AIC = 5721.85
BIC = 5727.16
=======================================================================
Elapsed time=0.00113 seconds =====&gt;&gt;&gt; Fri Aug 16 10:44:07 2024
=======================================================================
</pre></div>
</div>
<img alt="CUSH 0 MLE" src="_images/cush0mle.png" />
</section>
<section id="cush-with-covariates">
<span id="id23"></span><h3>With covariates<a class="headerlink" href="#cush-with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cushx-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R_i=r|\pmb\theta,\pmb x_i) = \delta_i D_r^{(c)} + (1-\delta_i)/m
,\; r=1,2,\ldots,m\]</div>
<div class="math notranslate nohighlight">
\[\delta_i = \dfrac{1}{1+\exp\{ - \pmb x_i \pmb\omega \}}
\quad \equiv \quad
\mathrm{logit}(\delta_i) = \pmb x_i \pmb\omega\]</div>
<p>In the example, we’ll draw a sample from a CUSH model with covariates and
then estimate the parameter given the observed sample.</p>
<p>Notice that, since the <code class="docutils literal notranslate"><span class="pre">model</span></code> is not the default <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>, we need to specify it.</p>
<div class="literal-block-wrapper docutils container" id="id57">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id57" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">logit</span>
<span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>

<span class="c1"># Draw a random sample</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span>
<span class="p">})</span>
<span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ X&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">m</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">omega</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.05</span><span class="p">),</span> <span class="mf">.2</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># MLE estimation</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ X&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="c1"># Print MLE summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="c1"># plot the results</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUSH(X) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Shelter=5  Size=1000
-----------------------------------------------------------------------
Shelter effect
          Estimates  StdErr    Wald  p-value
constant     -3.131  0.4361  -7.180   0.0000
X             0.229  0.0629   3.642   0.0003
=======================================================================
Dissimilarity = 0.0395
Loglik(MOD)   = -2130.030
Loglik(uni)   = -2197.225
Mean-loglik   = -2.130
-----------------------------------------------------------------------
AIC = 4264.06
BIC = 4273.87
=======================================================================
Elapsed time=0.01704 seconds =====&gt;&gt;&gt; Fri Aug 16 10:54:11 2024
=======================================================================
</pre></div>
</div>
<img alt="CUSH X MLE" src="_images/cushxmle.png" />
</section>
</section>
<section id="cush2-family">
<h2>CUSH2 family<a class="headerlink" href="#cush2-family" title="Link to this heading">#</a></h2>
<p>Family of the class CUSH with two shelter effects (CUSH2).</p>
<p>This family has been introduced by <span id="id24"><a class="reference internal" href="references.html#id42" title="Massimo Pierini. Modelli della classe CUB in python. Universitas Mercatorum, Rome, IT, pages 1–172, June 2024. (Bachelor's thesis L-41).">Pierini, 2024</a></span> (pp 16-20) and first
implemented in this Python package. See <span id="id25"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span> as a reference
for the CUB class models.</p>
<p>These models are particularly useful whenever the shelter choices are not
<em>polarized</em>, i.e. they’re not at the extremes of the ordinal variable support.
In case of <em>polarized</em> responses,
finite mixtures based on the Discretized Beta distribution
(see <span id="id26"><a class="reference internal" href="references.html#id13" title="Rosaria Simone and Gerhard Tutz. Modelling uncertainty and response styles in ordinal data. Statistica Neerlandica, 72(3):224–245, 2018.">Simone and Tutz, 2018</a></span> and <span id="id27"><a class="reference internal" href="references.html#id12" title="Rosaria Simone. On finite mixtures of Discretized Beta model for ordered responses. TEST, 31(3):828–855, 2022.">Simone, 2022</a></span>)
can be used, which have not been implemented in this package yet.</p>
<section id="cush2-without-covariates">
<span id="id28"></span><h3>Without covariates<a class="headerlink" href="#cush2-without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cush200-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\pmb\theta) = \delta_1 D_r^{(c_1)} + \delta_2 D_r^{(c_2)} + (1-\delta_1-\delta_2)/m
,\; r=1,2,\ldots,m\]</div>
<p>In the example, we’ll draw a sample from a CUSH2 model without covariates and
then estimate the parameters given the observed sample.</p>
<p>Notice that, since the <code class="docutils literal notranslate"><span class="pre">model</span></code> is not the default <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>, we need to specify it.
Passing a list of two shelter categories with the <em>kwarg</em> <code class="docutils literal notranslate"><span class="pre">sh</span></code>, a CUSH2 model will be
called.</p>
<div class="literal-block-wrapper docutils container" id="id58">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id58" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># draw a sample</span>
<span class="linenos"> 6</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0 | 0&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">sh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="linenos">10</span>    <span class="n">m</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<span class="linenos">11</span>    <span class="n">delta1</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span> <span class="n">delta2</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos">15</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">16</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord~0|0&quot;</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">sh</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">sh</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">21</span>        <span class="s2">&quot;delta1&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">22</span>        <span class="s2">&quot;delta2&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">23</span>    <span class="p">}</span>
<span class="linenos">24</span><span class="p">)</span>
<span class="linenos">25</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">26</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">27</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">28</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">29</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUSH2 model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=7  Shelter=[1 4]  Size=1000
-----------------------------------------------------------------------
Shelter effects
        Estimates  StdErr    Wald  p-value
delta1      0.172  0.0149  11.512   0.0000
delta2      0.113  0.0163   6.930   0.0000
=======================================================================
Dissimilarity = 0.0176
Loglik(sat)   = -1849.206
Loglik(MOD)   = -1850.709
Loglik(uni)   = -1945.910
Mean-loglik   = -1.851
Deviance      = 3.006
-----------------------------------------------------------------------
AIC = 3705.42
BIC = 3715.23
=======================================================================
Elapsed time=0.00247 seconds =====&gt;&gt;&gt; Fri Sep 27 11:32:02 2024
=======================================================================
</pre></div>
</div>
<img alt="CUSH2 00 MLE" src="_images/cush200mle.png" />
</section>
<section id="cush2-with-covariates">
<span id="id29"></span><h3>With covariates<a class="headerlink" href="#cush2-with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cush2x0-module">Reference guide (X1|0)</a></p>
<p><a class="reference external" href="cubmods.html#cush2xx-module">Reference guide (X1|X2)</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R_i=r|\pmb\theta,\pmb x_{1i}, \pmb x_{2i}) = \delta_{1i} D_r^{(c_1)} + \delta_{2i} D_r^{(c_2)} + (1-\delta_{1i}- \delta_{2i})/m
,\; r=1,2,\ldots,m\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \delta_{1i} = \dfrac{1}{1+\exp\{ - \pmb x_{1i} \pmb\omega_1 \}}
    \\
    \delta_{2i} = \dfrac{1}{1+\exp\{ - \pmb x_{2i} \pmb\omega_2 \}}
\end{array}
\right.
\quad \equiv \quad
\left\{
\begin{array}{l}
    \mathrm{logit}(\delta_{1i}) = \pmb x_{1i} \pmb\omega_1
    \vphantom{\dfrac{1}{1+\exp\{ - \pmb x_{1i} \pmb\omega_1 \}}}
    \\
    \mathrm{logit}(\delta_{2i}) = \pmb x_{2i} \pmb\omega_2
    \vphantom{\dfrac{1}{1+\exp\{ - \pmb x_{2i} \pmb\omega_2 \}}}
\end{array}
\right.\end{split}\]</div>
<p>Two CUSH2 models with covariates have been defined and implemented:
for the first shelter choice only and for both.</p>
<p>In this example we’ll draw a sample from a CUSH2 model with
covariates for the first shelter choice only and will then
estimate the parameters with a CUSH2 model with covariates
for both shelter choices but using the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> in the
formula for the second shelter choice to estimate the
constant parameter only. This is usually not needed, but
we do it here to confirm that <span class="math notranslate nohighlight">\(\mathrm{expit}(\hat\omega_{20})=\hat\delta_2\)</span>.</p>
<p>Notice that, since the <code class="docutils literal notranslate"><span class="pre">model</span></code> is not the default <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>, we need to specify it.</p>
<div class="literal-block-wrapper docutils container" id="id59">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id59" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">logit</span><span class="p">,</span> <span class="n">expit</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Draw a random sample</span>
<span class="linenos"> 9</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos">10</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">13</span>    <span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span>
<span class="linenos">14</span><span class="p">})</span>
<span class="linenos">15</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">16</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ X | 0&quot;</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">m</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="linenos">20</span>    <span class="n">omega1</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.05</span><span class="p">),</span> <span class="mf">.2</span><span class="p">],</span>
<span class="linenos">21</span>    <span class="n">delta2</span><span class="o">=</span><span class="mf">.1</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1"># MLE estimation</span>
<span class="linenos">25</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">26</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ X | 1&quot;</span><span class="p">,</span>
<span class="linenos">27</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cush&quot;</span><span class="p">,</span>
<span class="linenos">28</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="linenos">29</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">30</span>        <span class="s2">&quot;omega1&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">31</span>        <span class="s2">&quot;omega2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
<span class="linenos">32</span>    <span class="p">}</span>
<span class="linenos">33</span><span class="p">)</span>
<span class="linenos">34</span><span class="c1"># Print MLE summary</span>
<span class="linenos">35</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">36</span><span class="c1"># plot the results</span>
<span class="linenos">37</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">38</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="n">est_de2</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos">41</span><span class="n">est_de2_es</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">fit</span><span class="o">.</span><span class="n">stderrs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">est_de2</span>
<span class="linenos">42</span><span class="nb">print</span><span class="p">(</span>
<span class="linenos">43</span>    <span class="s2">&quot;     estimates  stderr</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos">44</span>    <span class="sa">f</span><span class="s2">&quot;delta2  </span><span class="si">{</span><span class="n">est_de2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">est_de2_es</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUSH2(X1,X2) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Shelter=[2 8]  Size=1000
-----------------------------------------------------------------------
Shelter effect 1
          Estimates  StdErr     Wald  p-value
constant     -3.170  0.4216   -7.519   0.0000
X             0.207  0.0613    3.379   0.0007
-----------------------------------------------------------------------
Shelter effect 2
          Estimates  StdErr     Wald  p-value
constant     -2.276  0.1609  -14.149   0.0000
=======================================================================
Dissimilarity = 0.0305
Loglik(MOD)   = -2122.463
Loglik(uni)   = -2197.225
Mean-loglik   = -2.122
-----------------------------------------------------------------------
AIC = 4250.93
BIC = 4265.65
=======================================================================
Elapsed time=0.06553 seconds =====&gt;&gt;&gt; Fri Aug 16 11:29:11 2024
=======================================================================
</pre></div>
</div>
<img alt="CUSH2 XX MLE" src="_images/cush2xxmle.png" />
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     estimates  stderr
delta2  0.0931  0.0145
</pre></div>
</div>
<p>Notice that, as proven by <span id="id30"><a class="reference internal" href="references.html#id9" title="Maria Iannario. Modelling shelter choices in a class of mixture models for ordinal responses. Statistical Methods &amp; Applications, 21:1–22, 2012.">Iannario, 2012</a></span> (pp 7-8), CUB models with shelter effect
generate a perfect fit at <span class="math notranslate nohighlight">\(R=c\)</span>. It can be easily proven that
CUSH2 models too generate perfect fits at both <span class="math notranslate nohighlight">\(R=c_1\)</span> and <span class="math notranslate nohighlight">\(R=c_2\)</span>.
Indeed, we can also graphically see that the estimated probability distribution is
closer to the observed sample than the assumed model used to draw the sample, because
of the perfect fits generated at <span class="math notranslate nohighlight">\(R=2\)</span> and <span class="math notranslate nohighlight">\(R=8\)</span>.</p>
</section>
</section>
<section id="cube-family">
<h2>CUBE family<a class="headerlink" href="#cube-family" title="Link to this heading">#</a></h2>
<p>Family of the class CUBE (Combination of Uniform and BEtaBinomial).
CUB models are nested into CUBE models: in fact, a CUB model is equal to
a CUBE model with the overdispersion parameter <span class="math notranslate nohighlight">\(\phi=0\)</span>.
Notiche that <span class="math notranslate nohighlight">\(0\leq\phi\leq0.2\)</span> is the usual range of the overdispersion parameter.</p>
<p>See the references for details: <span id="id31"><a class="reference internal" href="references.html#id17" title="Maria Iannario. Modelling uncertainty and overdispersion in ordinal data. Communications in Statistics-Theory and Methods, 43(4):771–786, 2014.">Iannario, 2014</a></span>; <span id="id32"><a class="reference internal" href="references.html#id15" title="Domenico Piccolo. Inferential issues on cube models with covariates. Communications in Statistics-Theory and Methods, 44(23):5023–5036, 2015.">Piccolo, 2015</a></span>;
<span id="id33"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>.</p>
<section id="cube-without-covariates">
<span id="id34"></span><h3>Without covariates<a class="headerlink" href="#cube-without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cube000-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R=r|\pmb{\theta}) = \pi \beta e(\xi,\phi)+\dfrac{1-\pi}{m}
,\; r=1,2,\ldots,m\]</div>
<p>In this example, we’ll draw a sample from a CUBE model and then
will estimate the parameters given the observed sample.</p>
<p>Notice that, since the <code class="docutils literal notranslate"><span class="pre">model</span></code> is not the default <code class="docutils literal notranslate"><span class="pre">&quot;cub&quot;</span></code>, we need to specify it.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method of the object <code class="docutils literal notranslate"><span class="pre">fit</span></code> will show trivariate and bivariate confidence
regions too, as in CUBSH models. See <a class="reference external" href="#confidence-ellipsoid">here</a> for the values of confidence levels.</p>
<div class="literal-block-wrapper docutils container" id="id60">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id60" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># draw a sample</span>
<span class="linenos"> 6</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0 | 0 | 0&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">m</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">pi</span><span class="o">=</span><span class="mf">.7</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos">13</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">14</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">15</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord~0|0|0&quot;</span><span class="p">,</span>
<span class="linenos">16</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">18</span>        <span class="s2">&quot;pi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">19</span>        <span class="s2">&quot;xi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">20</span>        <span class="s2">&quot;phi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">21</span>    <span class="p">}</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">25</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">26</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">27</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUBE model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Size=500  Iterations=62  Maxiter=1000  Tol=1E-06
-----------------------------------------------------------------------
Uncertainty
     Estimates  StdErr    Wald  p-value
pi       0.577  0.0633   9.108   0.0000
-----------------------------------------------------------------------
Feeling
     Estimates  StdErr    Wald  p-value
xi       0.251  0.0217  11.560   0.0000
-----------------------------------------------------------------------
Overdispersion
     Estimates  StdErr    Wald  p-value
phi      0.111  0.0402   2.754   0.0059
=======================================================================
Dissimilarity = 0.0426
Loglik(sat)   = -1037.855
Loglik(MOD)   = -1041.100
Loglik(uni)   = -1098.612
Mean-loglik   = -2.082
Deviance      = 6.491
-----------------------------------------------------------------------
AIC = 2088.20
BIC = 2100.84
=======================================================================
Elapsed time=0.07919 seconds =====&gt;&gt;&gt; Fri Aug 16 12:18:49 2024
=======================================================================
</pre></div>
</div>
<img alt="CUBE 000 MLE" src="_images/cube000mle.png" />
</section>
<section id="cube-with-covariates">
<span id="id35"></span><h3>With covariates<a class="headerlink" href="#cube-with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#cube0w0-module">Reference guide (0|W|0)</a></p>
<p><a class="reference external" href="cubmods.html#cubeywz-module">Reference guide (Y|W|Z)</a></p>
<div class="math notranslate nohighlight">
\[\Pr(R_i=r|\pmb{\theta};\pmb y_i, \pmb w_i; \pmb z_i) = \pi_i \beta e(\xi_i,\phi_i)+\dfrac{1-\pi_i}{m},
,\; r=1,2,\ldots,m\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \pi_i = \dfrac{1}{1+\exp\{ -\pmb y_i \pmb\beta\}}
    \\
    \xi_i = \dfrac{1}{1+\exp\{ -\pmb w_i \pmb\gamma\}}
    \\
    \phi_i = \exp\{ \pmb z_i \pmb \alpha \}
\end{array}
\right.
\quad \equiv \quad
\left\{
\begin{array}{l}
    \mathrm{logit}(1-\pi_i) = -\pmb y_i \pmb\beta
    \vphantom{\dfrac{1}{1+\exp\{ -\pmb y_i \pmb\beta\}}}
    \\
    \mathrm{logit}(1-\xi_i) = -\pmb w_i \pmb\gamma
    \vphantom{\dfrac{1}{1+\exp\{ -\pmb w_i \pmb\gamma\}}}
    \\
    \log \phi_i = \pmb z_i \pmb \alpha
    \vphantom{\exp\{ \pmb z_i \pmb \alpha \}}
\end{array}
\right.\end{split}\]</div>
<p>Currently, as in the R package <code class="docutils literal notranslate"><span class="pre">CUB</span></code>, two CUBE models with covariates have been defined and implemented:
for the <em>feeling</em> only and for all components.
Nevertheless, the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> can always be used in the
formula for different combinations of covariates.</p>
<p>In this example, we’ll draw a sample with covariates for
<em>feeling</em> only and then will estimate the parameters given
the observed sample.</p>
<div class="literal-block-wrapper docutils container" id="id61">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id61" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">expit</span><span class="p">,</span> <span class="n">logit</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Draw a random sample</span>
<span class="linenos"> 9</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos">10</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">76</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">13</span>    <span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="n">W</span><span class="p">,</span>
<span class="linenos">14</span><span class="p">})</span>
<span class="linenos">15</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">16</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ 0 | W | 0&quot;</span><span class="p">,</span>
<span class="linenos">17</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">m</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="n">pi</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.3</span><span class="p">),</span> <span class="o">-</span><span class="mf">.1</span><span class="p">],</span>
<span class="linenos">22</span>    <span class="n">phi</span><span class="o">=</span><span class="mf">.12</span><span class="p">,</span>
<span class="linenos">23</span><span class="p">)</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1"># MLE estimation</span>
<span class="linenos">26</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">27</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ 0 | W | 0&quot;</span><span class="p">,</span>
<span class="linenos">28</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span>
<span class="linenos">29</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">30</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">31</span>        <span class="s2">&quot;pi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">32</span>        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">33</span>        <span class="s2">&quot;phi&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">34</span>    <span class="p">}</span>
<span class="linenos">35</span><span class="p">)</span>
<span class="linenos">36</span><span class="c1"># Print MLE summary</span>
<span class="linenos">37</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">38</span><span class="c1"># plot the results</span>
<span class="linenos">39</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">40</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUBE(0W0) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Size=1000
-----------------------------------------------------------------------
Uncertainty
          Estimates  StdErr    Wald  p-value
pi            0.815  0.0343  23.733   0.0000
-----------------------------------------------------------------------
Feeling
          Estimates  StdErr    Wald  p-value
constant     -0.770  0.1012  -7.612   0.0000
W            -0.116  0.0191  -6.052   0.0000
-----------------------------------------------------------------------
Overdisperson
          Estimates  StdErr    Wald  p-value
phi           0.150  0.0260   5.779   0.0000
=======================================================================
Dissimilarity = 0.0183
Loglik(MOD)   = -1886.654
Loglik(uni)   = -2197.225
Mean-loglik   = -1.887
-----------------------------------------------------------------------
AIC = 3781.31
BIC = 3800.94
=======================================================================
Elapsed time=2.30903 seconds =====&gt;&gt;&gt; Fri Aug 16 12:31:10 2024
=======================================================================
</pre></div>
</div>
<img alt="CUBE 0W0 MLE" src="_images/cube0w0mle.png" />
<p>Notice that the same results can be achieved using a CUBE
model with covariates for all components and passing
the symbol <code class="docutils literal notranslate"><span class="pre">1</span></code> to the <em>uncertainty</em> and <em>overdispersion</em>
components.</p>
<div class="literal-block-wrapper docutils container" id="id62">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id62" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># MLE estimation</span>
<span class="linenos"> 2</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos"> 3</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;fee ~ 1 | W | 1&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos"> 7</span>        <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
<span class="linenos"> 8</span>        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>
<span class="linenos"> 9</span>        <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
<span class="linenos">10</span>    <span class="p">}</span>
<span class="linenos">11</span><span class="p">)</span>
<span class="linenos">12</span><span class="c1"># Print MLE summary</span>
<span class="linenos">13</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">14</span><span class="c1"># plot the results</span>
<span class="linenos">15</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">16</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; CUBE(YWZ) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=9  Size=1000  Iterations=29  Maxiter=1000  Tol=1E-02
-----------------------------------------------------------------------
Uncertainty
          Estimates  StdErr     Wald  p-value
constant      1.423  0.2183    6.518   0.0000
-----------------------------------------------------------------------
Feeling
          Estimates  StdErr     Wald  p-value
constant     -0.778  0.1018   -7.639   0.0000
W            -0.117  0.0193   -6.074   0.0000
-----------------------------------------------------------------------
Overdispersion
          Estimates  StdErr     Wald  p-value
constant     -1.930  0.1756  -10.989   0.0000
=======================================================================
Dissimilarity = 0.0239
Loglik(MOD)   = -1886.690
Loglik(uni)   = -2197.225
Mean-loglik   = -1.887
-----------------------------------------------------------------------
AIC = 3781.38
BIC = 3801.01
=======================================================================
Elapsed time=50.02969 seconds =====&gt;&gt;&gt; Fri Aug 16 12:33:36 2024
=======================================================================
</pre></div>
</div>
<img alt="CUBE YWZ MLE" src="_images/cubeywzmle.png" />
<p>In fact:</p>
<div class="literal-block-wrapper docutils container" id="id63">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id63" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">est_pi</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos"> 2</span><span class="n">est_ph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="linenos"> 3</span><span class="n">est_pi_se</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">fit</span><span class="o">.</span><span class="n">stderrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">est_pi</span>
<span class="linenos"> 4</span><span class="n">est_ph_se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">estimates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">fit</span><span class="o">.</span><span class="n">stderrs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="n">est_ph</span>
<span class="linenos"> 5</span><span class="nb">print</span><span class="p">(</span>
<span class="linenos"> 6</span>    <span class="s2">&quot;     estimates  stderr</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos"> 7</span>    <span class="sa">f</span><span class="s2">&quot;pi      </span><span class="si">{</span><span class="n">est_pi</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">est_pi_se</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos"> 9</span>    <span class="sa">f</span><span class="s2">&quot;phi     </span><span class="si">{</span><span class="n">est_ph</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">est_ph_se</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>     estimates  stderr
pi      0.8058  0.0319
phi     0.1451  0.0279
</pre></div>
</div>
</section>
</section>
<section id="ihg-family">
<h2>IHG family<a class="headerlink" href="#ihg-family" title="Link to this heading">#</a></h2>
<p>Family of the class IHG (Inverse HyperGeometric).</p>
<p>See the references for details: <span id="id36"><a class="reference internal" href="references.html#id18" title="Angela D’Elia. Modelling ranks using the inverse hypergeometric distribution. Statistical modelling, 3(1):65–78, 2003.">D’Elia, 2003</a></span>; <span id="id37"><a class="reference internal" href="references.html#id19" title="A D'Elia, Domenico Piccolo, and others. The moment estimator for the IHG distribution. In S. Co. Modelli complessi e metodi computazionali intensivi per la stima e la previsione, pages 245–250. CLEUP, 2005.">D'Elia <em>et al.</em>, 2005</a></span>;
<span id="id38"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span>.</p>
<section id="ihg-without-covariates">
<span id="id39"></span><h3>Without covariates<a class="headerlink" href="#ihg-without-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#ihg0-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \Pr(R=1|\theta) = \theta
    \\
    \Pr(R=r+1|\theta) = \Pr(R=r|\theta)(1-\theta)\dfrac{m-r}{m-1-r(1-\theta)},\; r= 1,2, \ldots, m-1
\end{array}
\right.\end{split}\]</div>
<p>which is equivalent to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\Pr(R=r|\theta) = \frac{ \dbinom{m+B-r-1}{m-r} }{ \dbinom{m+B-1}{m-1} },\; r= 1,2, \ldots, m
\\
\textrm{with } B = (m-1)\theta / (1 - \theta)
\end{array}\end{split}\]</div>
<p>In this example, we’ll draw a sample from an IHG model
and the estimate the parameter from the observed sample.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>

<span class="c1"># draw a sample</span>
<span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ihg&quot;</span><span class="p">,</span>
    <span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># inferential method on drawn sample</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ihg&quot;</span><span class="p">,</span>
    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;theta&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="c1"># print the summary of MLE</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="c1"># show the plot of MLE</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; IHG model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=10  Size=500
-----------------------------------------------------------------------
Theta
       Estimates  StdErr    Wald  p-value
theta      0.200  0.0086  23.292   0.0000
=======================================================================
Dissimilarity = 0.0639
Loglik(sat)   = -1044.100
Loglik(MOD)   = -1050.513
Loglik(uni)   = -1151.293
Mean-loglik   = -2.101
Deviance      = 12.824
-----------------------------------------------------------------------
AIC = 2103.03
BIC = 2107.24
=======================================================================
Elapsed time=0.00464 seconds =====&gt;&gt;&gt; Fri Aug 16 12:47:55 2024
=======================================================================
</pre></div>
</div>
<img alt="IHG 0 MLE" src="_images/ihg0mle.png" />
</section>
<section id="ihg-with-covariates">
<span id="id40"></span><h3>With covariates<a class="headerlink" href="#ihg-with-covariates" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="cubmods.html#ihgv-module">Reference guide</a></p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{array}{l}
    \Pr(R_i=1|\pmb\theta;\pmb v_i) = \theta_i
    \\
    \Pr(R_i=r+1|\pmb\theta;\pmb v_i) = \Pr(R_i=r|\pmb\theta;\pmb v_i)(1-\theta_i)\dfrac{m-r}{m-1-r(1-\theta_i)},\; r= 1, \ldots, m-1
\end{array}
\right.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\theta_i = \dfrac{1}{1 + \exp\{ - \pmb v_i \pmb \nu \}}
\quad \equiv \quad
\mathrm{logit}(\theta_i) = \pmb v_i \pmb \nu\]</div>
<p>In this example we’ll draw a sample from an IHG with two covariates
and then will estimate the parameters given the observed sample.
Notice that IHG models without covariates are unimodals but, however,
IHG models with covariates can be bimodal, as the one in the following example.</p>
<div class="literal-block-wrapper docutils container" id="id64">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id64" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># import libraries</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span> <span class="n">estimate</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">cubmods.general</span> <span class="kn">import</span> <span class="n">logit</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Draw a random sample</span>
<span class="linenos"> 9</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos">10</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">V1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">V2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="linenos">14</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">15</span>    <span class="s2">&quot;V1&quot;</span><span class="p">:</span> <span class="n">V1</span><span class="p">,</span> <span class="s2">&quot;V2&quot;</span><span class="p">:</span> <span class="n">V2</span>
<span class="linenos">16</span><span class="p">})</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1"># draw a sample</span>
<span class="linenos">19</span><span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">20</span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ V1 + V2&quot;</span><span class="p">,</span>
<span class="linenos">22</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ihg&quot;</span><span class="p">,</span>
<span class="linenos">23</span>    <span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="linenos">24</span>    <span class="n">nu</span><span class="o">=</span><span class="p">[</span><span class="n">logit</span><span class="p">(</span><span class="mf">.1</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="linenos">25</span>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="c1"># inferential method on drawn sample</span>
<span class="linenos">28</span><span class="n">fit</span> <span class="o">=</span> <span class="n">estimate</span><span class="p">(</span>
<span class="linenos">29</span>    <span class="n">df</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<span class="linenos">30</span>    <span class="n">formula</span><span class="o">=</span><span class="n">drawn</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
<span class="linenos">31</span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ihg&quot;</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="n">ass_pars</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">33</span>        <span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="n">drawn</span><span class="o">.</span><span class="n">pars</span><span class="p">,</span>
<span class="linenos">34</span>    <span class="p">}</span>
<span class="linenos">35</span><span class="p">)</span>
<span class="linenos">36</span><span class="c1"># print the summary of MLE</span>
<span class="linenos">37</span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="linenos">38</span><span class="c1"># show the plot of MLE</span>
<span class="linenos">39</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="linenos">40</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>warnings.warn(&quot;No m given, max(ordinal) has been taken&quot;)
=======================================================================
=====&gt;&gt;&gt; IHG(V) model &lt;&lt;&lt;===== ML-estimates
=======================================================================
m=10  Size=1000
-----------------------------------------------------------------------
Theta
          Estimates  StdErr     Wald  p-value
constant     -2.368  0.0998  -23.741   0.0000
V1           -1.973  0.1438  -13.721   0.0000
V2            3.230  0.1451   22.261   0.0000
=======================================================================
Dissimilarity = 0.0455
Loglik(MOD)   = -1958.475
Loglik(uni)   = -2302.585
Mean-loglik   = -1.958
-----------------------------------------------------------------------
AIC = 3922.95
BIC = 3937.67
=======================================================================
Elapsed time=1.10664 seconds =====&gt;&gt;&gt; Fri Aug 16 12:53:12 2024
=======================================================================
</pre></div>
</div>
<img alt="IHG V MLE" src="_images/ihgvmle.png" />
</section>
</section>
<section id="multicub">
<span id="multicub-manual"></span><h2>MULTICUB<a class="headerlink" href="#multicub" title="Link to this heading">#</a></h2>
<p>See the <span id="id41"><a class="reference internal" href="references.html#id3" title="Domenico Piccolo and Rosaria Simone. The class of CUB models: statistical foundations, inferential issues and empirical evidence (with discussion and rejoinder). Statistical Methods &amp; Applications, 28:389–493, 2019.">Piccolo and Simone, 2019</a></span> as a reference.</p>
<p><a class="reference external" href="cubmods.html#multicub-module">Reference guide</a></p>
<p>With the <strong>multicub</strong> tool, parameters estimated from
multiple observed samples can be shown in a single plot.</p>
<p>In this example, we’ll draw three samples from CUBE
models and <em>manually</em> add a shelter category. Then we’ll
use the <strong>multicub</strong> tool for CUB models, CUBE models and
CUBSH models (that aren’t yet implemented in the R package <code class="docutils literal notranslate"><span class="pre">CUB</span></code>
for the <strong>multicub</strong> tool).</p>
<p>Notice that, since the samples are drawn from a “CUBE model with shelter effect”
(which has not been implemented yet), the estimated parameters’ values will
differ from the theoretical ones of the speficied CUBE model used to draw the sample.</p>
<p>The <strong>multicub</strong> tool in <code class="docutils literal notranslate"><span class="pre">cubmods</span></code> package can also show confidence
ellipses for CUB models.</p>
<div class="literal-block-wrapper docutils container" id="id65">
<div class="code-block-caption"><span class="caption-text">Script</span><a class="headerlink" href="#id65" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">cubmods.gem</span> <span class="kn">import</span> <span class="n">draw</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">cubmods.multicub</span> <span class="kn">import</span> <span class="n">multi</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># draw random samples</span>
<span class="linenos"> 8</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 9</span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
<span class="linenos">10</span>    <span class="nb">zip</span><span class="p">([</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">.3</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.15</span><span class="p">])</span>
<span class="linenos">11</span>    <span class="p">):</span>
<span class="linenos">12</span>    <span class="n">drawn</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span>
<span class="linenos">13</span>        <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;ord ~ 0 | 0 | 0&quot;</span><span class="p">,</span>
<span class="linenos">14</span>        <span class="n">m</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="linenos">15</span>        <span class="n">pi</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="n">xi</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>
<span class="linenos">16</span>        <span class="n">seed</span><span class="o">=</span><span class="mi">1976</span>
<span class="linenos">17</span>    <span class="p">)</span>
<span class="linenos">18</span>    <span class="c1"># add a shelter category at c=1</span>
<span class="linenos">19</span>    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ord</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
<span class="linenos">20</span>        <span class="n">drawn</span><span class="o">.</span><span class="n">rv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="linenos">21</span>    <span class="p">))</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1"># MULTI-CUB</span>
<span class="linenos">24</span><span class="n">multi</span><span class="p">(</span>
<span class="linenos">25</span>    <span class="n">ords</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cub&quot;</span>
<span class="linenos">26</span><span class="p">)</span>
<span class="linenos">27</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">28</span><span class="c1"># MULTI-CUBE</span>
<span class="linenos">29</span><span class="n">multi</span><span class="p">(</span>
<span class="linenos">30</span>    <span class="n">ords</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cube&quot;</span>
<span class="linenos">31</span><span class="p">)</span>
<span class="linenos">32</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">33</span><span class="c1"># MULTI-CUBSH</span>
<span class="linenos">34</span><span class="n">multi</span><span class="p">(</span>
<span class="linenos">35</span>    <span class="n">ords</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cub&quot;</span><span class="p">,</span> <span class="n">shs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos">36</span>    <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="linenos">37</span><span class="p">)</span>
<span class="linenos">38</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<img alt="MULTICUB" src="_images/multicub.png" />
<img alt="MULTICUBE" src="_images/multicube.png" />
<img alt="MULTICUBSH" src="_images/multicubsh.png" />
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="modules.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">cubmods</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gem-usage">GeM usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-formula-syntax">The <em>formula</em> syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments-of-estimate-and-draw">Arguments of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-of-estimate-and-draw">Methods of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes-of-estimate-and-draw">Attributes of <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cub-family">CUB family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cubsh-family">CUBSH family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubsh-without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cubsh-with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cush-family">CUSH family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cush-without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cush-with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cush2-family">CUSH2 family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cush2-without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cush2-with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cube-family">CUBE family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cube-without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cube-with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ihg-family">IHG family</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ihg-without-covariates">Without covariates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ihg-with-covariates">With covariates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multicub">MULTICUB</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/manual.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Massimo Pierini.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>