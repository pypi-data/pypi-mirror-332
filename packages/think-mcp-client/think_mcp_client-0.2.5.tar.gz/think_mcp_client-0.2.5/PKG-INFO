Metadata-Version: 2.4
Name: think-mcp-client
Version: 0.2.5
Summary: MCP (Model Control Protocol) å®¢æˆ·ç«¯ï¼Œç”¨äºä¸ MCP æœåŠ¡å™¨äº¤äº’
Author-email: Think Team <yezhenjie@outlook.de>
License: MIT
Requires-Python: >=3.12
Requires-Dist: mcp>=1.3.0
Requires-Dist: prompt-toolkit>=3.0.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: pyyaml>=6.0.2
Requires-Dist: rich>=10.0.0
Requires-Dist: think-llm-client>=0.4.0
Requires-Dist: typing-extensions>=4.0.0
Provides-Extra: dev
Requires-Dist: black>=23.0.0; extra == 'dev'
Requires-Dist: flake8>=6.0.0; extra == 'dev'
Requires-Dist: isort>=5.0.0; extra == 'dev'
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Description-Content-Type: text/markdown

# Think MCP Client

MCP (Model Control Protocol) å®¢æˆ·ç«¯ï¼Œç”¨äºä¸ MCP æœåŠ¡å™¨äº¤äº’ã€‚æ”¯æŒèµ„æºç®¡ç†ã€æç¤ºè¯å¤„ç†å’Œå·¥å…·è°ƒç”¨ç­‰åŠŸèƒ½ã€‚

## ç‰¹æ€§

- âœ¨ æ”¯æŒå¤šç§ MCP æœåŠ¡å™¨é…ç½®
- ğŸ–¥ï¸ æä¾›å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰å’Œ Python API
- ğŸ› ï¸ æ”¯æŒèµ„æºã€æç¤ºè¯å’Œå·¥å…·çš„äº¤äº’å¼æ“ä½œ
- ğŸ“ æ–‡æœ¬å ä½ç¬¦å¤„ç†åŠŸèƒ½ï¼ˆå¦‚ `->mcp_prompts[client]:name{params}`ï¼‰
- ğŸ” å®Œæ•´çš„ç±»å‹æ³¨è§£å’Œå¼‚æ­¥æ”¯æŒ
- ğŸ§ª å…¨é¢çš„æµ‹è¯•è¦†ç›–

## å®‰è£…æŒ‡å—

### 1. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆMacOS/Linuxï¼‰
source .venv/bin/activate

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆWindowsï¼‰
.venv\Scripts\activate
```

### 2. å®‰è£… uv

```bash
# ä½¿ç”¨ pip å®‰è£… uv
pip install uv
```

### 3. å®‰è£…é¡¹ç›®ä¾èµ–

```bash
# å®‰è£…åŸºæœ¬ä¾èµ–
uv pip install -e .

# å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
uv pip install -e ".[dev]"
```

## ä½¿ç”¨æ–¹æ³•

### 1. é…ç½®

é¦–æ¬¡è¿è¡Œæ—¶ï¼Œä¼šåœ¨ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š`~/.think_mcp_client/config/config.json`

é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š
```json
{
    "servers": {
        "default": {
            "command": "python",
            "args": ["-m", "mcp_server"],
            "env": {
                "MCP_SERVER_HOST": "localhost",
                "MCP_SERVER_PORT": "8000"
            }
        },
        "custom-server": {
            "command": "/path/to/custom/server",
            "args": ["--config", "config.yaml"],
            "env": {
                "CUSTOM_VAR": "value"
            }
        }
    }
}
```

### 2. å‘½ä»¤è¡Œä½¿ç”¨

```bash
# å¯åŠ¨ CLI
python -m think_mcp_client
```

CLI æ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š
- åˆ—å‡ºå’Œé€‰æ‹©å¯ç”¨çš„ MCP æœåŠ¡å™¨
- æµè§ˆå’Œä½¿ç”¨æç¤ºè¯ï¼ˆPromptsï¼‰
- è°ƒç”¨å·¥å…·ï¼ˆToolsï¼‰
- ç®¡ç†èµ„æºï¼ˆResourcesï¼‰
- å¤„ç†å¸¦æœ‰ MCP å ä½ç¬¦çš„æ–‡æœ¬

å‘½ä»¤è¡Œå¿«æ·é”®ï¼š
- `Tab`: è‡ªåŠ¨è¡¥å…¨
- `Ctrl+C`: ä¸­æ–­å½“å‰æ“ä½œ
- `Ctrl+D`: é€€å‡ºç¨‹åº
- `â†‘/â†“`: æµè§ˆå†å²å‘½ä»¤

### 3. Python API ä½¿ç”¨

#### åŸºæœ¬ä½¿ç”¨

```python
from think_mcp_client import MCPClientManager, MCPProcessor

# åˆ›å»ºå®¢æˆ·ç«¯ç®¡ç†å™¨
manager = MCPClientManager()

# åˆå§‹åŒ–æ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨
await manager.init_all_clients()

# è·å–ç‰¹å®šçš„å®¢æˆ·ç«¯
client = manager.get_client("default")

# åˆ—å‡ºå¯ç”¨çš„æç¤ºè¯
prompts = await client.list_prompts()
for prompt in prompts:
    print(f"æç¤ºè¯: {prompt.name} - {prompt.description}")

# åˆ—å‡ºå¯ç”¨çš„å·¥å…·
tools = await client.list_tools()
for tool in tools:
    print(f"å·¥å…·: {tool.name} - {tool.description}")

# åˆ—å‡ºå¯ç”¨çš„èµ„æº
resources = await client.list_resources()
for resource in resources:
    print(f"èµ„æº: {resource.name} - {resource.description}")
```

#### è‡ªåŠ¨åˆå§‹åŒ– MCP æœåŠ¡å™¨

1. **é…ç½®æ–‡ä»¶æ–¹å¼**

åœ¨ `~/.think_mcp_client/config/config.json` ä¸­é…ç½®å¤šä¸ªæœåŠ¡å™¨ï¼š
```json
{
    "servers": {
        "default": {
            "command": "python",
            "args": ["-m", "mcp_server"],
            "env": {
                "MCP_SERVER_HOST": "localhost",
                "MCP_SERVER_PORT": "8000"
            }
        },
        "custom-server": {
            "command": "/path/to/custom/server",
            "args": ["--config", "config.yaml"],
            "env": {
                "CUSTOM_VAR": "value"
            }
        }
    }
}
```

2. **ä»£ç æ–¹å¼**

```python
from think_mcp_client import MCPClientManager
from pathlib import Path

# ä½¿ç”¨é»˜è®¤é…ç½®è·¯å¾„
manager = MCPClientManager()

# æˆ–è€…æŒ‡å®šè‡ªå®šä¹‰é…ç½®è·¯å¾„
custom_config = Path("./my_config.json")
manager = MCPClientManager(config_path=custom_config)

# åˆå§‹åŒ–æ‰€æœ‰æœåŠ¡å™¨
await manager.init_all_clients()

# è·å–æ‰€æœ‰å·²åˆå§‹åŒ–çš„å®¢æˆ·ç«¯
clients = manager.get_all_clients()
for name, client in clients.items():
    print(f"æœåŠ¡å™¨ {name} å·²åˆå§‹åŒ–")

# æ¸…ç†æ‰€æœ‰å®¢æˆ·ç«¯ï¼ˆåœ¨ç¨‹åºç»“æŸæ—¶è°ƒç”¨ï¼‰
await manager.cleanup_all_clients()
```

3. **CLI æ–¹å¼**

ä½¿ç”¨å‘½ä»¤è¡Œæ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨ï¼š
```bash
python -m think_mcp_client
```

#### æœåŠ¡å™¨çŠ¶æ€ç®¡ç†

```python
from think_mcp_client import MCPClientManager

manager = MCPClientManager()

# åˆå§‹åŒ–ç‰¹å®šçš„æœåŠ¡å™¨
client = manager.get_client("default")
await client.init_client()

# æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
prompts = await client.list_prompts()  # å¦‚æœæœåŠ¡å™¨æœªåˆå§‹åŒ–ä¼šè‡ªåŠ¨åˆå§‹åŒ–

# æ¸…ç†ç‰¹å®šçš„æœåŠ¡å™¨
await client.cleanup()

# æˆ–è€…æ¸…ç†æ‰€æœ‰æœåŠ¡å™¨
await manager.cleanup_all_clients()
```

æ³¨æ„äº‹é¡¹ï¼š
1. æœåŠ¡å™¨ä¼šåœ¨é¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–
2. å¯ä»¥é€šè¿‡ `init_all_clients()` é¢„å…ˆåˆå§‹åŒ–æ‰€æœ‰æœåŠ¡å™¨
3. å»ºè®®åœ¨ç¨‹åºç»“æŸæ—¶è°ƒç”¨ `cleanup_all_clients()` æ¸…ç†èµ„æº
4. å¦‚æœæœåŠ¡å™¨åˆå§‹åŒ–å¤±è´¥ï¼Œä¼šè®°å½•é”™è¯¯æ—¥å¿—å¹¶è·³è¿‡è¯¥æœåŠ¡å™¨

#### å¤„ç†å¸¦å ä½ç¬¦çš„æ–‡æœ¬

```python
from think_mcp_client import MCPClientManager, MCPProcessor

# åˆ›å»ºå®¢æˆ·ç«¯ç®¡ç†å™¨å’Œå¤„ç†å™¨
manager = MCPClientManager()
processor = MCPProcessor(manager)

# å¤„ç†åŒ…å«æç¤ºè¯å ä½ç¬¦çš„æ–‡æœ¬
text = "ä½¿ç”¨æç¤ºè¯ç”Ÿæˆå†…å®¹ï¼š->mcp_prompts[default]:generate_text{topic:AI,length:short}"
result = await processor.process_text(text)

# å¤„ç†åŒ…å«å·¥å…·å ä½ç¬¦çš„æ–‡æœ¬
text = "è°ƒç”¨å·¥å…·ï¼š->mcp_tools[default]:analyze_sentiment{text:è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ–‡æœ¬}"
result = await processor.process_text(text)

# å¤„ç†åŒ…å«èµ„æºå ä½ç¬¦çš„æ–‡æœ¬
text = "è¯»å–èµ„æºï¼š->mcp_resources[default]:example.txt"
result = await processor.process_text(text)

# å¤„ç†åŒ…å«å¤šä¸ªå ä½ç¬¦çš„æ–‡æœ¬
text = """
1. æç¤ºè¯ï¼š->mcp_prompts[default]:prompt1
2. å·¥å…·ï¼š->mcp_tools[default]:tool1
3. èµ„æºï¼š->mcp_resources[default]:resource1
"""
result = await processor.process_text(text)
```

#### é”™è¯¯å¤„ç†

```python
from think_mcp_client import MCPClientManager, MCPProcessor
from think_mcp_client.exceptions import MCPClientError

try:
    manager = MCPClientManager()
    client = manager.get_client("non-existent-server")
except MCPClientError as e:
    print(f"å®¢æˆ·ç«¯é”™è¯¯: {e}")
```

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
pip install think-mcp-client
```

### åŸºæœ¬ä½¿ç”¨

MCP å®¢æˆ·ç«¯æ”¯æŒä¸¤ç§æ¨¡å¼ï¼šåŸºç¡€æ¨¡å¼å’Œ CLI æ¨¡å¼ã€‚ä½ å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶é€‰æ‹©ä½¿ç”¨å“ªç§æ¨¡å¼ã€‚

#### 1. é…ç½®æ–‡ä»¶

é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„ä¸º `~/.think_mcp_client/config/mcp_server_config.json`ï¼š

```json
{
    "mcpServers": {
        "default": {
            "command": "think-mcp-host",
            "args": [],
            "env": {}
        }
    }
}
```

#### 2. ä½¿ç”¨åŸºç¡€æ¨¡å¼

```python
from think_mcp_client import MCPClientManager, ClientType
import asyncio

async def main():
    # åˆ›å»ºåŸºç¡€æ¨¡å¼çš„å®¢æˆ·ç«¯ç®¡ç†å™¨ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
    manager = MCPClientManager(client_type=ClientType.BASE)
    
    # åˆå§‹åŒ–æ‰€æœ‰å®¢æˆ·ç«¯
    await manager.init_all_clients()
    
    try:
        # è·å–é»˜è®¤å®¢æˆ·ç«¯
        client = manager.get_client("default")
        
        # ä½¿ç”¨å®¢æˆ·ç«¯
        prompts = await client.list_prompts()
        tools = await client.list_tools()
        resources = await client.list_resources()
        
        # è°ƒç”¨å·¥å…·
        result = await client.call_tool("tool_name", {"arg1": "value1"})
        
    finally:
        # æ¸…ç†æ‰€æœ‰å®¢æˆ·ç«¯
        await manager.cleanup_all_clients()

if __name__ == "__main__":
    asyncio.run(main())
```

#### 3. ä½¿ç”¨ CLI æ¨¡å¼

```python
from think_mcp_client import MCPClientManager, ClientType
import asyncio

async def main():
    # åˆ›å»º CLI æ¨¡å¼çš„å®¢æˆ·ç«¯ç®¡ç†å™¨
    manager = MCPClientManager(client_type=ClientType.CLI)
    
    # åˆå§‹åŒ–æ‰€æœ‰å®¢æˆ·ç«¯
    await manager.init_all_clients()
    
    try:
        # è·å–é»˜è®¤å®¢æˆ·ç«¯
        client = manager.get_client("default")
        
        # å¯åŠ¨ CLI
        await client.run()
        
    finally:
        # æ¸…ç†æ‰€æœ‰å®¢æˆ·ç«¯
        await manager.cleanup_all_clients()

if __name__ == "__main__":
    asyncio.run(main())
```

#### 4. æ‰¹é‡ç®¡ç†å¤šä¸ªæœåŠ¡å™¨

ä½ å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¤šä¸ªæœåŠ¡å™¨ï¼š

```json
{
    "mcpServers": {
        "server1": {
            "command": "think-mcp-host",
            "args": ["--config", "config1.json"],
            "env": {"SERVER_ID": "1"}
        },
        "server2": {
            "command": "think-mcp-host",
            "args": ["--config", "config2.json"],
            "env": {"SERVER_ID": "2"}
        }
    }
}
```

ç„¶åç»Ÿä¸€ç®¡ç†å®ƒä»¬ï¼š

```python
async def main():
    manager = MCPClientManager(client_type=ClientType.CLI)
    await manager.init_all_clients()
    
    try:
        # è·å–æ‰€æœ‰å®¢æˆ·ç«¯
        clients = manager.get_all_clients()
        
        # å¯¹æ¯ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œæ“ä½œ
        for name, client in clients.items():
            # ä½¿ç”¨å®¢æˆ·ç«¯...
            pass
            
    finally:
        await manager.cleanup_all_clients()
```

### API æ–‡æ¡£

#### MCPClientManager

- `__init__(config_path: Optional[Path] = None, client_type: ClientType = ClientType.BASE)`
  - `config_path`: é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸º `~/.think_mcp_client/config/mcp_server_config.json`
  - `client_type`: å®¢æˆ·ç«¯ç±»å‹ï¼Œå¯é€‰ `ClientType.BASE` æˆ– `ClientType.CLI`

- `get_client(server_name: str) -> Optional[MCPClient]`: è·å–æŒ‡å®šæœåŠ¡å™¨çš„å®¢æˆ·ç«¯
- `get_all_clients() -> Dict[str, MCPClient]`: è·å–æ‰€æœ‰å®¢æˆ·ç«¯
- `init_all_clients() -> None`: åˆå§‹åŒ–æ‰€æœ‰å®¢æˆ·ç«¯
- `cleanup_all_clients() -> None`: æ¸…ç†æ‰€æœ‰å®¢æˆ·ç«¯

#### MCPClient

- `list_prompts() -> List[Prompt]`: è·å–æç¤ºè¯åˆ—è¡¨
- `get_prompt(name: str) -> str`: è·å–æŒ‡å®šæç¤ºè¯
- `list_tools() -> List[Tool]`: è·å–å·¥å…·åˆ—è¡¨
- `call_tool(name: str, arguments: Dict[str, Any]) -> Any`: è°ƒç”¨å·¥å…·
- `list_resources() -> List[Resource]`: è·å–èµ„æºåˆ—è¡¨
- `read_resource(uri: str) -> bytes`: è¯»å–èµ„æºå†…å®¹

## å¼€å‘æŒ‡å—

### ä»£ç æ ¼å¼åŒ–

```bash
# è¿è¡Œ black æ ¼å¼åŒ–ä»£ç 
black src/think_mcp_client tests

# è¿è¡Œ isort æ•´ç†å¯¼å…¥
isort src/think_mcp_client tests
```

### ç±»å‹æ£€æŸ¥

```bash
# è¿è¡Œ mypy è¿›è¡Œç±»å‹æ£€æŸ¥
mypy src/think_mcp_client
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_client.py

# è¿è¡Œå¸¦è¦†ç›–ç‡æŠ¥å‘Šçš„æµ‹è¯•
pytest --cov=think_mcp_client tests/
```

### è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ä¾èµ–é¡¹

- Python >= 3.10
- think-llm-client >= 0.2.9
- mcp >= 0.1.0
- prompt-toolkit >= 3.0.0
- rich >= 10.0.0
- pydantic >= 2.0.0
- typing-extensions >= 4.0.0
- pyyaml >= 6.0.2

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

Think Team - team@think.com
