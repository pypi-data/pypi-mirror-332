(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{7350:(e,t,l)=>{var n=l(38221),o=l(23805);e.exports=function(e,t,l){var a=!0,r=!0;if("function"!=typeof e)throw TypeError("Expected a function");return o(l)&&(a="leading"in l?!!l.leading:a,r="trailing"in l?!!l.trailing:r),n(e,t,{leading:a,maxWait:t,trailing:r})}},90923:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>B});var n=l(74848),o=l(96540),a=l(87947),r=l(53692);l(69703);var s=l(71468),i=l(36240),c=l(29838),d=l(64478),u=l(50227),g=l(45388),m=l(73486),h=l(69554),x=l(52136),f=l(80893),p=(l(33596),l(77528)),v=l(55456);let w=function(){let e=(0,s.d4)(e=>e.flow.nodes),t=(0,s.d4)(e=>e.flow.edges),l=(0,o.useRef)(null),n=(0,s.wA)(),[a,i]=(0,o.useState)([]),[d,u]=(0,o.useState)([]),g=(0,o.useCallback)(()=>{let l=e.filter(e=>e.selected),n=(0,r.AX)(l,t).filter(e=>{let t=l.every(t=>t.id!==e.source),n=l.every(t=>t.id!==e.target);return!(t||n)});i(l),u(n)},[e,t]),m=(0,o.useCallback)(()=>{let l=e.filter(e=>e.selected),o=(0,r.AX)(l,t).filter(e=>{let t=l.every(t=>t.id!==e.source),n=l.every(t=>t.id!==e.target);return!(t||n)});i(l),u(o);let a=e.filter(e=>!e.selected),s=t.filter(e=>!o.includes(e));n((0,c.CU)({nodes:a})),n((0,c.jY)({edges:s}))},[e,t,n]),h=(0,o.useCallback)(()=>{if(0===a.length||l.current)return;l.current=setTimeout(()=>{l.current=null},300);let o={x:window.innerWidth/2,y:window.innerHeight/2},r=Math.min(...a.map(e=>e.position.x)),s=Math.min(...a.map(e=>e.position.y)),i=Date.now(),u=a.map(e=>{let t="".concat(e.id,"-").concat(i),l=o.x/2+(e.position.x-r),n=o.y/2+(e.position.y-s);return(0,v._)((0,p._)({},e),{id:t,position:{x:l,y:n}})}),g=d.map(e=>{let t="".concat(e.id,"-").concat(i),l="".concat(e.source,"-").concat(i),n="".concat(e.target,"-").concat(i);return(0,v._)((0,p._)({},e),{id:t,source:l,target:n})}),m=[...e.map(e=>(0,v._)((0,p._)({},e),{selected:!1})),...u],h=[...t.map(e=>(0,v._)((0,p._)({},e),{selected:!1})),...g];n((0,c.CU)({nodes:m})),n((0,c.jY)({edges:h}))},[a,d,e,t,n]),x=(0,o.useCallback)(e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.closest(".react-flow"))&&((e.metaKey||e.ctrlKey)&&"c"===e.key?g():(e.metaKey||e.ctrlKey)&&"v"===e.key?h():(e.metaKey||e.ctrlKey)&&"x"===e.key&&m())},[g,h,m]);return(0,o.useEffect)(()=>(window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x)}),[x]),(0,o.useEffect)(()=>()=>{l.current&&clearTimeout(l.current)},[]),{cut:m,copy:g,paste:h,bufferedNodes:a,bufferedEdges:d}};var y=l(53212),b=l(5266),j=l(48850),k=l(37399),C=l(31024),N=l(72748),E=l(49517),S=l(97151),I=l(65468),A=l(66933),O=l(84994),_=l(95258);let D=()=>{let e=(0,s.d4)(e=>e.panel.isNodePanelExpanded),t=(0,s.wA)(),l=(0,s.d4)(e=>e.flow.nodes),r=(0,s.d4)(e=>e.nodeTypes.data),i=(0,a.VH)(),[c,d]=(0,o.useState)(""),[u,g]=(0,o.useState)(new Set),[m,h]=(0,o.useState)({}),x=(0,o.useRef)(null),f=(0,o.useRef)(null),[p,v]=(0,o.useState)(-1);(0,A.vC)("mod+k",l=>{if(l.preventDefault(),e&&document.activeElement===x.current){var n;null===(n=x.current)||void 0===n||n.blur()}t((0,O.iv)(!e))},{enableOnFormTags:!0},[e]),(0,A.vC)("esc",()=>{var l;e&&(null===(l=f.current)||void 0===l?void 0:l.contains(document.activeElement))&&t((0,O.iv)(!1))},{enableOnFormTags:!0},[e]),(0,o.useEffect)(()=>{let t=t=>{var l;if(!e||!(null===(l=f.current)||void 0===l?void 0:l.contains(document.activeElement)))return;let n=Array.from(f.current.querySelectorAll('div[role="button"], button, [tabindex="0"]'));switch(t.key){case"ArrowDown":t.preventDefault(),v(e=>e<n.length-1?e+1:e);break;case"ArrowUp":t.preventDefault(),v(e=>e>0?e-1:e);break;case"Enter":t.preventDefault(),p>=0&&p<n.length&&n[p].click()}};return e&&window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e,p]),(0,o.useEffect)(()=>{e||v(-1)},[e]),(0,o.useEffect)(()=>{e&&x.current&&x.current.focus()},[e]);let w=e=>{i&&((0,_.ff)(l,r,e,i,t),t((0,O.iv)(!1)))};(0,o.useEffect)(()=>{h(Object.keys(r).reduce((e,t)=>{if(0===c.trim().length)return r;let l=r[t].filter(e=>e.name.toLowerCase().includes(c.toLowerCase()));return l.length>0&&(e[t]=l,g(e=>{let l=new Set(e);return l.has(t)||l.add(t),l})),e},{}))},[r,c]);let y=e=>e.reduce((e,t)=>{let l=t.category||"Other";if(!e[l]){var n,o;e[l]={nodes:[],logo:t.logo,color:null===(n=t.visual_tag)||void 0===n?void 0:n.color,acronym:null===(o=t.visual_tag)||void 0===o?void 0:o.acronym}}return e[l].nodes.push(t),e},{});return(0,n.jsxs)("div",{ref:f,"data-node-panel":!0,"data-expanded":e,className:"".concat(e?"w-64":"w-auto h-auto"," shadow-sm rounded-xl border border-solid border-default-200 bg-background transition-width duration-300 transition-height duration-300"),children:[(0,n.jsx)(C.I,{content:(0,n.jsxs)("div",{className:"px-1 py-2",children:[(0,n.jsx)("div",{className:"text-small font-bold",children:"Keyboard Shortcuts"}),(0,n.jsxs)("div",{className:"text-tiny",children:["Press ",navigator.platform.includes("Mac")?"âŒ˜+K":"Ctrl+K"," or ",(0,n.jsx)("kbd",{children:"K"})," to toggle panel"]})]}),placement:"right",children:(0,n.jsx)(N.T,{isIconOnly:!0,size:"md",className:"bg-background",onClick:()=>{t((0,O.iv)(!e))},children:(0,n.jsx)(k.In,{icon:e?"solar:minus-square-linear":"solar:widget-add-linear",width:"80%",className:"text-default-500"})})}),e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.r,{ref:x,id:"node-search-input",type:"search",placeholder:"Search nodes...",value:c,onChange:e=>d(e.target.value),fullWidth:!0,className:"px-2 rounded",startContent:(0,n.jsx)(k.In,{icon:"akar-icons:search",className:"text-default-500"})}),(0,n.jsx)("div",{className:"mt-4 max-h-[calc(100vh-16rem)] overflow-auto",id:"node-type-accordion",children:(0,n.jsx)(S.D,{selectionMode:"multiple",selectedKeys:Array.from(u),onSelectionChange:e=>g(new Set(Array.from(e))),children:Object.keys(m).filter(e=>"Input/Output"!==e).map(e=>{let t=m[e],l=t.some(e=>e.category);return(0,n.jsx)(I.R,{title:e,textValue:e,children:l?(0,n.jsx)(S.D,{selectionMode:"multiple",children:Object.entries(y(t)).map(e=>{let[t,{nodes:l,logo:o,color:a,acronym:r}]=e;return(0,n.jsx)(I.R,{textValue:t,title:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-8 flex-shrink-0",children:o?(0,n.jsx)("img",{src:o,alt:"".concat(t," Logo"),className:"max-h-5 max-w-5"}):(0,n.jsx)("div",{className:"node-acronym-tag float-left text-white px-2 py-1 rounded-full text-xs inline-block",style:{backgroundColor:a},children:r})}),(0,n.jsx)("span",{children:t})]}),children:l.map(e=>(0,n.jsx)("div",{className:"flex items-center cursor-pointer p-2 hover:bg-default-100 ml-4",onClick:()=>w(e.name),children:(0,n.jsx)("span",{className:"flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-foreground",title:e.config.title,children:e.config.title})},e.name))},t)})}):m[e].map(e=>(0,n.jsxs)("div",{className:"flex items-center cursor-pointer p-2 hover:bg-default-100",onClick:()=>w(e.name),children:[(0,n.jsx)("div",{className:"w-16 flex-shrink-0",children:e.logo?(0,n.jsx)("img",{src:e.logo,alt:"Node Logo",className:"max-h-7 max-w-7"}):(0,n.jsx)("div",{className:"node-acronym-tag float-left text-white px-2 py-1 rounded-full text-xs inline-block",style:{backgroundColor:e.visual_tag.color},children:e.visual_tag.acronym})}),(0,n.jsx)("span",{className:"flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-foreground",title:e.config.title,children:e.config.title})]},e.name))},e)})})})]})]})};var L=l(7651),K=l(2404),T=l.n(K),M=l(46421),V=l(7350),Y=l.n(V),z=l(88781);let F={custom:f.A},R=e=>e.reduce((e,t)=>{let l=t.category||"Other";if(!e[l]){var n,o;e[l]={nodes:[],logo:t.logo,color:null===(n=t.visual_tag)||void 0===n?void 0:n.color,acronym:null===(o=t.visual_tag)||void 0===o?void 0:o.acronym}}return e[l].nodes.push(t),e},{}),W=e=>{let{workflowData:t,workflowID:l,onDownloadImageInit:f}=e,p=(0,s.wA)(),v=(0,s.d4)(e=>e.flow.projectName),C=(0,s.d4)(e=>e.nodeTypes.data),{nodeTypes:N,isLoading:E}=(0,_.Tj)({nodeTypesConfig:C,readOnly:!1,includeCoalesceNode:!0});(0,o.useEffect)(()=>{t&&p((0,c.R$)({nodeTypes:C,definition:t.definition,workflowID:l,name:t.name}))},[p,t,l,C]);let S=(0,s.d4)(e=>e.flow.nodes,T()),I=(0,s.d4)(e=>e.flow.edges,T()),A=(0,s.d4)(e=>e.flow.nodeConfigs,T()),K=(0,s.d4)(e=>e.flow.selectedNode),V=(0,s.d4)(e=>e.flow.selectedEdgeId),W=(0,b.y)();(0,o.useEffect)(()=>{(S.length>0||I.length>0||Object.keys(A).length>0)&&W()},[S,I,A,W]);let[B,P]=(0,o.useState)(null),[Q,U]=(0,o.useState)({horizontal:null,vertical:null}),[q,H]=(0,o.useState)(null),[Z,G]=(0,o.useState)(null),[J,X]=(0,o.useState)(!1),[$,ee]=(0,o.useState)(null),[et,el]=(0,o.useState)({x:0,y:0}),[en,eo]=(0,o.useState)(new Set),[ea,er]=(0,o.useState)(new Set(["AI","Code Execution","Logic","Experimental","Integrations"])),es=(0,y.y)(e=>e.mode),{getIntersectingNodes:ei,getNodes:ec,updateNode:ed,getViewport:eu}=(0,a.VH)(),eg=(0,o.useCallback)(e=>{let{sourceNode:t,targetNode:l,edgeId:n}=e;if(!B)return;let o=(t.position.x+l.position.x)/2,a=(t.position.y+l.position.y)/2,r=B.flowToScreenPosition({x:o,y:a});el({x:r.x,y:r.y}),ee({sourceNode:t,targetNode:l,edgeId:n}),X(!0)},[B]),{onNodesChange:em,onEdgesChange:eh,onConnect:ex,onNodeDragStop:ef}=(0,_.dW)({dispatch:p,nodes:S,setHelperLines:U}),ep=(0,_.Bf)({edges:I,hoveredNode:q,hoveredEdge:Z,selectedEdgeId:V,handlePopoverOpen:eg}),ev=(0,_.ml)({nodes:S,mode:es}),ew=(0,_.Fu)({nodes:ev}),ey=(0,o.useCallback)((e,t)=>{G(t.id)},[G]),eb=(0,o.useCallback)(()=>{G(null)},[G]),ej=(0,o.useCallback)(e=>{P(e),e.setViewport({x:0,y:0,zoom:.8})},[]),ek=(0,o.useCallback)((e,t)=>{p((0,c.Qi)({nodeId:t.id}))},[p]),eC=(0,o.useCallback)((e,t)=>{p((0,c.Yy)({edgeId:t.id}))},[p]),eN=(0,o.useCallback)(()=>{K&&p((0,c.Qi)({nodeId:null})),V&&p((0,c.Yy)({edgeId:null})),p((0,O.iv)(!1))},[p,K,V]),eE=(0,o.useCallback)(e=>{e.forEach(e=>{p((0,c.AC)({nodeId:e.id})),K===e.id&&p((0,c.Qi)({nodeId:null}))})},[p,K]),eS=(0,o.useCallback)(e=>{let t=e.target,l=t.tagName.toLowerCase();if(t.isContentEditable||"input"===l||"textarea"===l||"select"===l)return;let n=document.querySelector("[data-node-panel]"),o=(null==n?void 0:n.getAttribute("data-expanded"))==="true",a=null==n?void 0:n.contains(document.activeElement);if("Delete"===e.key||"Backspace"===e.key){let e=S.filter(e=>e.selected);e.length>0&&eE(e);return}if(o&&a)return;let r=e.shiftKey?45:15;if(B){let{x:t,y:l,zoom:n}=B.getViewport();switch(e.key){case"ArrowLeft":B.setViewport({x:t+r,y:l,zoom:n});break;case"ArrowRight":B.setViewport({x:t-r,y:l,zoom:n});break;case"ArrowUp":B.setViewport({x:t,y:l+r,zoom:n});break;case"ArrowDown":B.setViewport({x:t,y:l-r,zoom:n})}}},[S,eE,B]),eI=(0,o.useCallback)(()=>{let e=(0,L.B)(S,I);p((0,c.CU)({nodes:e}))},[S,I,p]);(0,o.useEffect)(()=>(window.addEventListener("keydown",eS),()=>{window.removeEventListener("keydown",eS)}),[eS]),(0,x.K)(K,S,N,C,p,eI);let{cut:eA,copy:eO,paste:e_,bufferedNodes:eD}=w();w();let eL=(0,o.useCallback)((e,t)=>{H(t.id)},[H]),eK=(0,o.useCallback)(()=>{H(null)},[H]),eT=(0,o.useCallback)((e,t,l,n)=>{(0,_.HB)(S,C,e,t,l,n,p,()=>X(!1))},[S,C,B,p,X]),eM=(0,o.useCallback)(Y()((e,t)=>{(0,M.tJ)(e,t,S,p,ei,ec,ed)},16),[S,p,ei]),eV=(0,o.useCallback)((e,t)=>{(0,M.Lm)(e,t,S,I,p,ei,ec,ed),ef(e,t)},[S,I,p,ei,ec,ed,ef]),eY=e=>{eo(t=>{let l=new Set(t);return l.has(e)?l.delete(e):l.add(e),l})},ez=e=>{er(t=>{let l=new Set(t);return l.has(e)?l.delete(e):l.add(e),l})},eF=(0,o.useCallback)(()=>{let e=ec(),t=(0,r.Jo)(e),l=t.width||1,n=t.height||1,o=Math.min(1080/l,607.5/n),a=(0,r.R4)(t,1200,675,o,o,.05*Math.min(l,n));(0,z.$E)(document.querySelector(".react-flow__viewport"),{backgroundColor:"transparent",width:1200,height:675,style:{width:"".concat(1200,"px"),height:"".concat(675,"px"),transform:"translate(".concat(a.x,"px, ").concat(a.y,"px) scale(").concat(a.zoom,")")}}).then(e=>{let t=document.createElement("a");t.href=e,t.download="".concat(v,".png"),t.click()}).catch(e=>{console.error("Failed to download image",e)})},[ec,v]);return((0,o.useEffect)(()=>{f&&f(eF)},[eF,f]),E)?(0,n.jsx)(j.A,{}):(0,n.jsxs)("div",{style:{position:"relative",height:"100%"},children:[J&&$&&(0,n.jsx)("div",{style:{position:"absolute",left:"".concat(et.x,"px"),top:"".concat(et.y,"px"),transform:"translate(-50%, -50%)",zIndex:1e3},children:(0,n.jsxs)(u.A,{isOpen:J,onOpenChange:e=>{e||X(!1)},placement:"bottom",children:[(0,n.jsx)(g.b,{children:(0,n.jsx)("div",{})}),(0,n.jsx)(m.y,{"aria-label":"Add node options",closeOnSelect:!1,onAction:e=>{let t=e.toString();if(t.startsWith("toggle-category-")){ez(t.replace("toggle-category-",""));return}if(t.startsWith("toggle-")){eY(t.replace("toggle-",""));return}eT(t,$.sourceNode,$.targetNode,$.edgeId),X(!1)},children:C&&Object.keys(C).filter(e=>"Input/Output"!==e).map(e=>{let t=C[e],l=t.some(e=>e.category);return(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)(h.Y,{className:"font-bold opacity-70 flex items-center gap-2",startContent:(0,n.jsx)(k.In,{icon:ea.has(e)?"solar:alt-arrow-down-linear":"solar:alt-arrow-right-linear",className:"text-default-500"}),children:e},"toggle-category-".concat(e)),ea.has(e)&&("Integrations"===e?Object.entries(R(t)).map(e=>{let[t,{nodes:l}]=e;return(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)(h.Y,{className:"font-semibold pl-4 flex items-center gap-2",startContent:(0,n.jsx)(k.In,{icon:en.has(t)?"solar:alt-arrow-down-linear":"solar:alt-arrow-right-linear",className:"text-default-500"}),children:t},"toggle-".concat(t)),en.has(t)&&l.map(e=>{var t,l;return(0,n.jsx)(h.Y,{className:"pl-8",startContent:e.logo?(0,n.jsx)("img",{src:e.logo,alt:"".concat(e.config.title," Logo"),className:"w-5 h-5"}):(0,n.jsx)("div",{className:"node-acronym-tag text-white px-2 py-1 rounded-full text-xs",style:{backgroundColor:null===(t=e.visual_tag)||void 0===t?void 0:t.color},children:null===(l=e.visual_tag)||void 0===l?void 0:l.acronym}),children:e.config.title},e.name)})]},t)}):l?Object.entries(R(t)).map(e=>{let[t,{nodes:l}]=e;return(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)(h.Y,{className:"font-semibold opacity-70 pl-4",isReadOnly:!0,children:t},"".concat(t,"-header")),l.map(e=>{var t,l;return(0,n.jsx)(h.Y,{className:"pl-8",startContent:e.logo?(0,n.jsx)("img",{src:e.logo,alt:"".concat(e.config.title," Logo"),className:"w-5 h-5"}):(0,n.jsx)("div",{className:"node-acronym-tag text-white px-2 py-1 rounded-full text-xs",style:{backgroundColor:null===(t=e.visual_tag)||void 0===t?void 0:t.color},children:null===(l=e.visual_tag)||void 0===l?void 0:l.acronym}),children:e.config.title},e.name)})]},t)}):t.map(e=>{var t,l;return(0,n.jsx)(h.Y,{className:"pl-4",startContent:e.logo?(0,n.jsx)("img",{src:e.logo,alt:"".concat(e.config.title," Logo"),className:"w-5 h-5"}):(0,n.jsx)("div",{className:"node-acronym-tag text-white px-2 py-1 rounded-full text-xs",style:{backgroundColor:null===(t=e.visual_tag)||void 0===t?void 0:t.color},children:null===(l=e.visual_tag)||void 0===l?void 0:l.acronym}),children:e.config.title},e.name)}))]},e)})})]})}),(0,n.jsxs)("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[(0,n.jsx)("div",{style:{height:"100%",overflow:"auto",position:"relative",zIndex:1},children:(0,n.jsxs)(a.Gc,{nodes:ew,edges:ep,onNodesChange:em,onEdgesChange:eh,onConnect:ex,nodeTypes:N,edgeTypes:F,fitView:!0,onInit:ej,onNodeClick:ek,onEdgeClick:eC,onPaneClick:eN,onNodesDelete:eE,proOptions:{hideAttribution:!0},panOnDrag:"hand"===es&&!S.filter(Boolean).some(e=>e.selected),panOnScroll:!0,zoomOnScroll:!0,minZoom:.1,maxZoom:2,selectionMode:"pointer"===es?r.Qc.Full:r.Qc.Partial,selectNodesOnDrag:"pointer"===es,selectionOnDrag:"pointer"===es,selectionKeyCode:"pointer"===es?null:"Shift",multiSelectionKeyCode:"pointer"===es?null:"Shift",deleteKeyCode:"Delete",nodesConnectable:!0,connectionMode:r.WZ.Loose,onNodeMouseEnter:eL,onNodeMouseLeave:eK,onEdgeMouseEnter:ey,onEdgeMouseLeave:eb,snapToGrid:!1,onNodeDrag:eM,onNodeDragStop:eV,children:[(0,n.jsx)(a.VS,{}),!1,(0,n.jsx)(i.A,{handleLayout:eI,handleDownloadImage:eF})]})}),K&&(0,n.jsx)("div",{className:"absolute top-0 right-0 h-full bg-white border-l border-gray-200",style:{zIndex:2},children:(0,n.jsx)(d.A,{nodeID:K,readOnly:!1},K)}),(0,n.jsx)("div",{className:"border-gray-200 absolute top-4 left-4",style:{zIndex:2},children:(0,n.jsx)(D,{})})]})]})},B=e=>{let{workflowData:t,workflowID:l,onDownloadImageInit:o}=e;return(0,n.jsx)(a.Ln,{children:(0,n.jsx)(W,{workflowData:t,workflowID:l,onDownloadImageInit:o})})}}}]);