name: Ten Tusscher et al. 2004 (Endo)
description: ''
dois:
- https://doi.org/10.1152/ajpheart.00794.2003
variables:
  V: -86.709
  Xr1: 0.00448
  Xr2: 0.476
  Xs: 0.0087
  m: 0.00155
  h: 0.7573
  j: 0.7225
  d: 3.164e-05
  f: 0.8009
  f2: 0.9778
  fCass: 0.9953
  s: 0.3212
  r: 2.235e-08
  Ca_i: 0.00013
  Ca_SR: 3.715
  Ca_ss: 0.00036
  R_prime: 0.9068
  Na_i: 10.355
  K_i: 138.4
parameters:
  calcium_pump_current_K_pCa: 0.0005
  calcium_pump_current_g_pCa: 0.1238
  environment_time: 0.0
  L_type_Ca_current_g_CaL: 0.0398
  calcium_background_current_g_bca: 0.000592
  calcium_dynamics_Buf_c: 0.2
  calcium_dynamics_Buf_sr: 10.0
  calcium_dynamics_Buf_ss: 0.4
  calcium_dynamics_Ca_o: 2.0
  calcium_dynamics_EC: 1.5
  calcium_dynamics_K_buf_c: 0.001
  calcium_dynamics_K_buf_sr: 0.3
  calcium_dynamics_K_buf_ss: 0.00025
  calcium_dynamics_K_up: 0.00025
  calcium_dynamics_V_leak: 0.00036
  calcium_dynamics_V_rel: 0.102
  calcium_dynamics_V_sr: 1094.0
  calcium_dynamics_V_ss: 54.68
  calcium_dynamics_V_xfer: 0.0038
  calcium_dynamics_Vmax_up: 0.006375
  calcium_dynamics_k1_prime: 0.15
  calcium_dynamics_k2_prime: 0.045
  calcium_dynamics_k3: 0.06
  calcium_dynamics_k4: 0.005
  calcium_dynamics_max_sr: 2.5
  calcium_dynamics_min_sr: 1.0
  fast_sodium_current_g_Na: 14.838
  inward_rectifier_potassium_current_g_K1: 5.405
  membrane_Cm: 185.0
  membrane_F: 96.485
  membrane_R: 8.314
  membrane_T: 310.0
  membrane_V_c: 16404.0
  membrane_pace: 0.0
  membrane_stim_amplitude: -52.0
  potassium_dynamics_K_o: 5.4
  potassium_pump_current_g_pK: 0.0146
  rapid_time_dependent_potassium_current_g_Kr: 0.153
  reversal_potentials_P_kna: 0.03
  slow_time_dependent_potassium_current_g_Ks: 0.392
  sodium_background_current_g_bna: 0.00029
  sodium_calcium_exchanger_current_K_NaCa: 1000.0
  sodium_calcium_exchanger_current_K_sat: 0.1
  sodium_calcium_exchanger_current_Km_Ca: 1.38
  sodium_calcium_exchanger_current_Km_Nai: 87.5
  sodium_calcium_exchanger_current_alpha: 2.5
  sodium_calcium_exchanger_current_gamma: 0.35
  sodium_dynamics_Na_o: 140.0
  sodium_potassium_pump_current_K_mNa: 40.0
  sodium_potassium_pump_current_K_mk: 1.0
  sodium_potassium_pump_current_P_NaK: 2.724
  transient_outward_current_g_to: 0.073
diffusivity:
  V: 1.0
source: |-
  // L_type_Ca_current_d_gate
  const Real L_type_Ca_current_d_gate_alpha_d = 1.4 / (1.0 + exp((-35.0 - V) / 13.0)) + 0.25;
  const Real L_type_Ca_current_d_gate_beta_d = 1.4 / (1.0 + exp((V + 5.0) / 5.0));
  const Real L_type_Ca_current_d_gate_d_inf = 1.0 / (1.0 + exp((-8.0 - V) / 7.5));
  const Real L_type_Ca_current_d_gate_gamma_d = 1.0 / (1.0 + exp((50.0 - V) / 20.0));
  const Real L_type_Ca_current_d_gate_tau_d = 1.0 * L_type_Ca_current_d_gate_alpha_d * L_type_Ca_current_d_gate_beta_d + L_type_Ca_current_d_gate_gamma_d;
  *_new_d = d + dt*((L_type_Ca_current_d_gate_d_inf - d) / L_type_Ca_current_d_gate_tau_d);

  // L_type_Ca_current_f2_gate
  const Real L_type_Ca_current_f2_gate_f2_inf = 0.67 / (1.0 + exp((V + 35.0) / 7.0)) + 0.33;
  const Real L_type_Ca_current_f2_gate_tau_f2 = 562.0 * exp(-pow(V + 27.0, 2.0) / 240.0) + 31.0 / (1.0 + exp((25.0 - V) / 10.0)) + 80.0 / (1.0 + exp((V + 30.0) / 10.0));
  *_new_f2 = f2 + dt*((L_type_Ca_current_f2_gate_f2_inf - f2) / L_type_Ca_current_f2_gate_tau_f2);

  // L_type_Ca_current_fCass_gate
  const Real L_type_Ca_current_fCass_gate_fCass_inf = 0.6 / (1.0 + pow(Ca_ss / 0.05, 2.0)) + 0.4;
  const Real L_type_Ca_current_fCass_gate_tau_fCass = 80.0 / (1.0 + pow(Ca_ss / 0.05, 2.0)) + 2.0;
  *_new_fCass = fCass + dt*((L_type_Ca_current_fCass_gate_fCass_inf - fCass) / L_type_Ca_current_fCass_gate_tau_fCass);

  // L_type_Ca_current_f_gate
  const Real L_type_Ca_current_f_gate_f_inf = 1.0 / (1.0 + exp((V + 20.0) / 7.0));
  const Real L_type_Ca_current_f_gate_tau_f = 1102.5 * exp(-pow(V + 27.0, 2.0) / 225.0) + 200.0 / (1.0 + exp((13.0 - V) / 10.0)) + 180.0 / (1.0 + exp((V + 30.0) / 10.0)) + 20.0;
  *_new_f = f + dt*((L_type_Ca_current_f_gate_f_inf - f) / L_type_Ca_current_f_gate_tau_f);

  // calcium_pump_current
  const Real calcium_pump_current_i_p_Ca = calcium_pump_current_g_pCa * Ca_i / (Ca_i + calcium_pump_current_K_pCa);

  // fast_sodium_current_h_gate
  const Real fast_sodium_current_h_gate_alpha_h = ((V < -40.0) ? 0.057 * exp(-(V + 80.0) / 6.8) : 0.0);
  const Real fast_sodium_current_h_gate_beta_h = ((V < -40.0) ? 2.7 * exp(0.079 * V) + 310000.0 * exp(0.3485 * V) : 0.77 / (0.13 * (1.0 + exp((V + 10.66) / -11.1))));
  const Real fast_sodium_current_h_gate_h_inf = 1.0 / pow(1.0 + exp((V + 71.55) / 7.43), 2.0);
  const Real fast_sodium_current_h_gate_tau_h = 1.0 / (fast_sodium_current_h_gate_alpha_h + fast_sodium_current_h_gate_beta_h);
  *_new_h = h + dt*((fast_sodium_current_h_gate_h_inf - h) / fast_sodium_current_h_gate_tau_h);

  // fast_sodium_current_j_gate
  const Real fast_sodium_current_j_gate_alpha_j = ((V < -40.0) ? (-25428.0 * exp(0.2444 * V) - 6.948e-06 * exp(-0.04391 * V)) * (V + 37.78) / 1.0 / (1.0 + exp(0.311 * (V + 79.23))) : 0.0);
  const Real fast_sodium_current_j_gate_beta_j = ((V < -40.0) ? 0.02424 * exp(-0.01052 * V) / (1.0 + exp(-0.1378 * (V + 40.14))) : 0.6 * exp(0.057 * V) / (1.0 + exp(-0.1 * (V + 32.0))));
  const Real fast_sodium_current_j_gate_j_inf = 1.0 / pow(1.0 + exp((V + 71.55) / 7.43), 2.0);
  const Real fast_sodium_current_j_gate_tau_j = 1.0 / (fast_sodium_current_j_gate_alpha_j + fast_sodium_current_j_gate_beta_j);
  *_new_j = j + dt*((fast_sodium_current_j_gate_j_inf - j) / fast_sodium_current_j_gate_tau_j);

  // fast_sodium_current_m_gate
  const Real fast_sodium_current_m_gate_alpha_m = 1.0 / (1.0 + exp((-60.0 - V) / 5.0));
  const Real fast_sodium_current_m_gate_beta_m = 0.1 / (1.0 + exp((V + 35.0) / 5.0)) + 0.1 / (1.0 + exp((V - 50.0) / 200.0));
  const Real fast_sodium_current_m_gate_m_inf = 1.0 / pow(1.0 + exp((-56.86 - V) / 9.03), 2.0);
  const Real fast_sodium_current_m_gate_tau_m = 1.0 * fast_sodium_current_m_gate_alpha_m * fast_sodium_current_m_gate_beta_m;
  *_new_m = m + dt*((fast_sodium_current_m_gate_m_inf - m) / fast_sodium_current_m_gate_tau_m);

  // rapid_time_dependent_potassium_current_Xr1_gate
  const Real rapid_time_dependent_potassium_current_Xr1_gate_alpha_xr1 = 450.0 / (1.0 + exp((-45.0 - V) / 10.0));
  const Real rapid_time_dependent_potassium_current_Xr1_gate_beta_xr1 = 6.0 / (1.0 + exp((V + 30.0) / 11.5));
  const Real rapid_time_dependent_potassium_current_Xr1_gate_xr1_inf = 1.0 / (1.0 + exp((-26.0 - V) / 7.0));
  const Real rapid_time_dependent_potassium_current_Xr1_gate_tau_xr1 = 1.0 * rapid_time_dependent_potassium_current_Xr1_gate_alpha_xr1 * rapid_time_dependent_potassium_current_Xr1_gate_beta_xr1;
  *_new_Xr1 = Xr1 + dt*((rapid_time_dependent_potassium_current_Xr1_gate_xr1_inf - Xr1) / rapid_time_dependent_potassium_current_Xr1_gate_tau_xr1);

  // rapid_time_dependent_potassium_current_Xr2_gate
  const Real rapid_time_dependent_potassium_current_Xr2_gate_alpha_xr2 = 3.0 / (1.0 + exp((-60.0 - V) / 20.0));
  const Real rapid_time_dependent_potassium_current_Xr2_gate_beta_xr2 = 1.12 / (1.0 + exp((V - 60.0) / 20.0));
  const Real rapid_time_dependent_potassium_current_Xr2_gate_xr2_inf = 1.0 / (1.0 + exp((V + 88.0) / 24.0));
  const Real rapid_time_dependent_potassium_current_Xr2_gate_tau_xr2 = 1.0 * rapid_time_dependent_potassium_current_Xr2_gate_alpha_xr2 * rapid_time_dependent_potassium_current_Xr2_gate_beta_xr2;
  *_new_Xr2 = Xr2 + dt*((rapid_time_dependent_potassium_current_Xr2_gate_xr2_inf - Xr2) / rapid_time_dependent_potassium_current_Xr2_gate_tau_xr2);

  // slow_time_dependent_potassium_current_Xs_gate
  const Real slow_time_dependent_potassium_current_Xs_gate_alpha_xs = 1400.0 / sqrt(1.0 + exp((5.0 - V) / 6.0));
  const Real slow_time_dependent_potassium_current_Xs_gate_beta_xs = 1.0 / (1.0 + exp((V - 35.0) / 15.0));
  const Real slow_time_dependent_potassium_current_Xs_gate_xs_inf = 1.0 / (1.0 + exp((-5.0 - V) / 14.0));
  const Real slow_time_dependent_potassium_current_Xs_gate_tau_xs = 1.0 * slow_time_dependent_potassium_current_Xs_gate_alpha_xs * slow_time_dependent_potassium_current_Xs_gate_beta_xs + 80.0;
  *_new_Xs = Xs + dt*((slow_time_dependent_potassium_current_Xs_gate_xs_inf - Xs) / slow_time_dependent_potassium_current_Xs_gate_tau_xs);

  // transient_outward_current_r_gate
  const Real transient_outward_current_r_gate_r_inf = 1.0 / (1.0 + exp((20.0 - V) / 6.0));
  const Real transient_outward_current_r_gate_tau_r = 9.5 * exp(-pow(V + 40.0, 2.0) / 1800.0) + 0.8;
  *_new_r = r + dt*((transient_outward_current_r_gate_r_inf - r) / transient_outward_current_r_gate_tau_r);

  // transient_outward_current_s_gate
  const Real transient_outward_current_s_gate_s_inf = 1.0 / (1.0 + exp((V + 28.0) / 5.0));
  const Real transient_outward_current_s_gate_tau_s = 1000.0 * exp(-pow(V + 67.0, 2.0) / 1000.0) + 8.0;
  *_new_s = s + dt*((transient_outward_current_s_gate_s_inf - s) / transient_outward_current_s_gate_tau_s);

  // calcium_dynamics
  const Real calcium_dynamics_f_JCa_i_free = 1.0 / (1.0 + calcium_dynamics_Buf_c * calcium_dynamics_K_buf_c / pow(Ca_i + calcium_dynamics_K_buf_c, 2.0));
  const Real calcium_dynamics_f_JCa_sr_free = 1.0 / (1.0 + calcium_dynamics_Buf_sr * calcium_dynamics_K_buf_sr / pow(Ca_SR + calcium_dynamics_K_buf_sr, 2.0));
  const Real calcium_dynamics_f_JCa_ss_free = 1.0 / (1.0 + calcium_dynamics_Buf_ss * calcium_dynamics_K_buf_ss / pow(Ca_ss + calcium_dynamics_K_buf_ss, 2.0));
  const Real calcium_dynamics_i_leak = calcium_dynamics_V_leak * (Ca_SR - Ca_i);
  const Real calcium_dynamics_i_up = calcium_dynamics_Vmax_up / (1.0 + pow(calcium_dynamics_K_up, 2.0) / pow(Ca_i, 2.0));
  const Real calcium_dynamics_i_xfer = calcium_dynamics_V_xfer * (Ca_ss - Ca_i);
  const Real calcium_dynamics_kcasr = calcium_dynamics_max_sr - (calcium_dynamics_max_sr - calcium_dynamics_min_sr) / (1.0 + pow(calcium_dynamics_EC / Ca_SR, 2.0));
  const Real calcium_dynamics_k1 = calcium_dynamics_k1_prime / calcium_dynamics_kcasr;
  const Real calcium_dynamics_k2 = calcium_dynamics_k2_prime * calcium_dynamics_kcasr;
  const Real calcium_dynamics_O = calcium_dynamics_k1 * pow(Ca_ss, 2.0) * R_prime / (calcium_dynamics_k3 + calcium_dynamics_k1 * pow(Ca_ss, 2.0));
  *_new_R_prime = R_prime + dt*(-calcium_dynamics_k2 * Ca_ss * R_prime + calcium_dynamics_k4 * (1.0 - R_prime));
  const Real calcium_dynamics_i_rel = calcium_dynamics_V_rel * calcium_dynamics_O * (Ca_SR - Ca_ss);
  const Real calcium_dynamics_ddt_Ca_sr_total = calcium_dynamics_i_up - (calcium_dynamics_i_rel + calcium_dynamics_i_leak);
  *_new_Ca_SR = Ca_SR + dt*(calcium_dynamics_ddt_Ca_sr_total * calcium_dynamics_f_JCa_sr_free);

  // membrane
  const Real membrane_i_Stim = membrane_pace * membrane_stim_amplitude;

  // reversal_potentials
  const Real reversal_potentials_E_Ca = 0.5 * membrane_R * membrane_T / membrane_F * log(calcium_dynamics_Ca_o / Ca_i);
  const Real reversal_potentials_E_K = membrane_R * membrane_T / membrane_F * log(potassium_dynamics_K_o / K_i);

  // sodium_potassium_pump_current
  const Real sodium_potassium_pump_current_i_NaK = sodium_potassium_pump_current_P_NaK * potassium_dynamics_K_o / (potassium_dynamics_K_o + sodium_potassium_pump_current_K_mk) * Na_i / (Na_i + sodium_potassium_pump_current_K_mNa) / (1.0 + 0.1245 * exp(-0.1 * V * membrane_F / (membrane_R * membrane_T)) + 0.0353 * exp(-V * membrane_F / (membrane_R * membrane_T)));

  // transient_outward_current
  const Real transient_outward_current_i_to = transient_outward_current_g_to * r * s * (V - reversal_potentials_E_K);

  // *remaining*
  const Real L_type_Ca_current_i_CaL = L_type_Ca_current_g_CaL * d * f * f2 * fCass * 4.0 * (V - 15.0) * pow(membrane_F, 2.0) / (membrane_R * membrane_T) * (0.25 * Ca_ss * exp(2.0 * (V - 15.0) * membrane_F / (membrane_R * membrane_T)) - calcium_dynamics_Ca_o) / (exp(2.0 * (V - 15.0) * membrane_F / (membrane_R * membrane_T)) - 1.0);
  const Real calcium_background_current_i_b_Ca = calcium_background_current_g_bca * (V - reversal_potentials_E_Ca);
  const Real inward_rectifier_potassium_current_alpha_K1 = 0.1 / (1.0 + exp(0.06 * (V - reversal_potentials_E_K - 200.0)));
  const Real inward_rectifier_potassium_current_beta_K1 = (3.0 * exp(0.0002 * (V - reversal_potentials_E_K + 100.0)) + exp(0.1 * (V - reversal_potentials_E_K - 10.0))) / (1.0 + exp(-0.5 * (V - reversal_potentials_E_K)));
  const Real potassium_pump_current_i_p_K = potassium_pump_current_g_pK * (V - reversal_potentials_E_K) / (1.0 + exp((25.0 - V) / 5.98));
  const Real rapid_time_dependent_potassium_current_i_Kr = rapid_time_dependent_potassium_current_g_Kr * sqrt(potassium_dynamics_K_o / 5.4) * Xr1 * Xr2 * (V - reversal_potentials_E_K);
  const Real reversal_potentials_E_Ks = membrane_R * membrane_T / membrane_F * log((potassium_dynamics_K_o + reversal_potentials_P_kna * sodium_dynamics_Na_o) / (K_i + reversal_potentials_P_kna * Na_i));
  const Real reversal_potentials_E_Na = membrane_R * membrane_T / membrane_F * log(sodium_dynamics_Na_o / Na_i);
  const Real sodium_calcium_exchanger_current_i_NaCa = sodium_calcium_exchanger_current_K_NaCa * (exp(sodium_calcium_exchanger_current_gamma * V * membrane_F / (membrane_R * membrane_T)) * pow(Na_i, 3.0) * calcium_dynamics_Ca_o - exp((sodium_calcium_exchanger_current_gamma - 1.0) * V * membrane_F / (membrane_R * membrane_T)) * pow(sodium_dynamics_Na_o, 3.0) * Ca_i * sodium_calcium_exchanger_current_alpha) / ((pow(sodium_calcium_exchanger_current_Km_Nai, 3.0) + pow(sodium_dynamics_Na_o, 3.0)) * (sodium_calcium_exchanger_current_Km_Ca + calcium_dynamics_Ca_o) * (1.0 + sodium_calcium_exchanger_current_K_sat * exp((sodium_calcium_exchanger_current_gamma - 1.0) * V * membrane_F / (membrane_R * membrane_T))));
  const Real calcium_dynamics_ddt_Ca_i_total = -(calcium_background_current_i_b_Ca + calcium_pump_current_i_p_Ca - 2.0 * sodium_calcium_exchanger_current_i_NaCa) * membrane_Cm / (2.0 * membrane_V_c * membrane_F) + (calcium_dynamics_i_leak - calcium_dynamics_i_up) * calcium_dynamics_V_sr / membrane_V_c + calcium_dynamics_i_xfer;
  const Real calcium_dynamics_ddt_Ca_ss_total = -L_type_Ca_current_i_CaL * membrane_Cm / (2.0 * calcium_dynamics_V_ss * membrane_F) + calcium_dynamics_i_rel * calcium_dynamics_V_sr / calcium_dynamics_V_ss - calcium_dynamics_i_xfer * membrane_V_c / calcium_dynamics_V_ss;
  const Real fast_sodium_current_i_Na = fast_sodium_current_g_Na * pow(m, 3.0) * h * j * (V - reversal_potentials_E_Na);
  const Real inward_rectifier_potassium_current_xK1_inf = inward_rectifier_potassium_current_alpha_K1 / (inward_rectifier_potassium_current_alpha_K1 + inward_rectifier_potassium_current_beta_K1);
  const Real slow_time_dependent_potassium_current_i_Ks = slow_time_dependent_potassium_current_g_Ks * pow(Xs, 2.0) * (V - reversal_potentials_E_Ks);
  const Real sodium_background_current_i_b_Na = sodium_background_current_g_bna * (V - reversal_potentials_E_Na);
  *_new_Ca_i = Ca_i + dt*(calcium_dynamics_ddt_Ca_i_total * calcium_dynamics_f_JCa_i_free);
  *_new_Ca_ss = Ca_ss + dt*(calcium_dynamics_ddt_Ca_ss_total * calcium_dynamics_f_JCa_ss_free);
  const Real inward_rectifier_potassium_current_i_K1 = inward_rectifier_potassium_current_g_K1 * inward_rectifier_potassium_current_xK1_inf * sqrt(potassium_dynamics_K_o / 5.4) * (V - reversal_potentials_E_K);
  *_new_Na_i = Na_i + dt*(-(fast_sodium_current_i_Na + sodium_background_current_i_b_Na + 3.0 * sodium_potassium_pump_current_i_NaK + 3.0 * sodium_calcium_exchanger_current_i_NaCa) / (membrane_V_c * membrane_F) * membrane_Cm);
  *_new_V = V + dt*(-(inward_rectifier_potassium_current_i_K1 + transient_outward_current_i_to + rapid_time_dependent_potassium_current_i_Kr + slow_time_dependent_potassium_current_i_Ks + L_type_Ca_current_i_CaL + sodium_potassium_pump_current_i_NaK + fast_sodium_current_i_Na + sodium_background_current_i_b_Na + sodium_calcium_exchanger_current_i_NaCa + calcium_background_current_i_b_Ca + potassium_pump_current_i_p_K + calcium_pump_current_i_p_Ca + membrane_i_Stim) + _diffuse_V);
  *_new_K_i = K_i + dt*(-(inward_rectifier_potassium_current_i_K1 + transient_outward_current_i_to + rapid_time_dependent_potassium_current_i_Kr + slow_time_dependent_potassium_current_i_Ks + potassium_pump_current_i_p_K + membrane_i_Stim - 2.0 * sodium_potassium_pump_current_i_NaK) / (membrane_V_c * membrane_F) * membrane_Cm);
