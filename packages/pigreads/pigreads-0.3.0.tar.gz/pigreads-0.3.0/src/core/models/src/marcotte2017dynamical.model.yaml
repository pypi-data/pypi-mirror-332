name: Smoothed Karma (Marcotte & Grigoriev 2017)
description: |
  Smoothed version of the Karma model as published by Marcotte & Grigoriev in 2017.
dois:
  - https://doi.org/10.1063/1.5003259
  - https://doi.org/10.1063/1.4915143
  - https://doi.org/10.1103/PhysRevLett.71.1103
  - https://doi.org/10.1063/1.166024
variables:
  u: 0.
  v: 0.
diffusivity:
  u: 4.0062
  v: 0.20031
  # u: 1.
  # v: 0.05
parameters:
  beta: 1.389
  eps: 0.01
  ustar: 1.5415
source: |
  const Real e = exp(2. * (1.2571 * (u - 1.)));
  const Real V = eps * (beta * ((1. + (e - 1.) / (e + 1.)) / 2.) + (1. + (exp(2. * (1.2571 * (v - 1.))) - 1.) / (exp(2. * (1.2571 * (v - 1.))) + 1.)) / 2. * (v - 1.) - v);
  const Real U = (ustar - v * v * v * v) * (1. - (exp(2. * (u - 3.)) - 1.) / (exp(2. * (u - 3.)) + 1.)) * u * u / 2. - u;

  *_new_u = u + dt * (U + _diffuse_u);
  *_new_v = v + dt * (V + _diffuse_v);
