{"version":3,"file":"9404.327461123ac209e9.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/dialogs/area-filter/area-filter-dialog.ts"],"sourcesContent":["import \"@material/mwc-list/mwc-list\";\nimport { mdiDrag, mdiEye, mdiEyeOff } from \"@mdi/js\";\nimport type { CSSResultGroup } from \"lit\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { repeat } from \"lit/directives/repeat\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { AreaFilterValue } from \"../../components/ha-area-filter\";\nimport \"../../components/ha-button\";\nimport \"../../components/ha-dialog\";\nimport \"../../components/ha-icon-button\";\nimport \"../../components/ha-list-item\";\nimport \"../../components/ha-sortable\";\nimport { areaCompare } from \"../../data/area_registry\";\nimport { haStyleDialog } from \"../../resources/styles\";\nimport type { HomeAssistant } from \"../../types\";\nimport type { HassDialog } from \"../make-dialog-manager\";\nimport type { AreaFilterDialogParams } from \"./show-area-filter-dialog\";\n\n@customElement(\"dialog-area-filter\")\nexport class DialogAreaFilter\n  extends LitElement\n  implements HassDialog<AreaFilterDialogParams>\n{\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _dialogParams?: AreaFilterDialogParams;\n\n  @state() private _hidden: string[] = [];\n\n  @state() private _areas: string[] = [];\n\n  public showDialog(dialogParams: AreaFilterDialogParams): void {\n    this._dialogParams = dialogParams;\n    this._hidden = dialogParams.initialValue?.hidden ?? [];\n    const order = dialogParams.initialValue?.order ?? [];\n    const allAreas = Object.keys(this.hass!.areas);\n    this._areas = allAreas.concat().sort(areaCompare(this.hass!.areas, order));\n  }\n\n  public closeDialog() {\n    this._dialogParams = undefined;\n    this._hidden = [];\n    this._areas = [];\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n    return true;\n  }\n\n  private _submit(): void {\n    const order = this._areas.filter((area) => !this._hidden.includes(area));\n    const value: AreaFilterValue = {\n      hidden: this._hidden,\n      order,\n    };\n    this._dialogParams?.submit?.(value);\n    this.closeDialog();\n  }\n\n  private _cancel(): void {\n    this._dialogParams?.cancel?.();\n    this.closeDialog();\n  }\n\n  private _areaMoved(ev: CustomEvent): void {\n    ev.stopPropagation();\n    const { oldIndex, newIndex } = ev.detail;\n\n    const areas = this._areas.concat();\n\n    const option = areas.splice(oldIndex, 1)[0];\n    areas.splice(newIndex, 0, option);\n\n    this._areas = areas;\n  }\n\n  protected render() {\n    if (!this._dialogParams || !this.hass) {\n      return nothing;\n    }\n\n    const allAreas = this._areas;\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this._cancel}\n        .heading=${this._dialogParams.title ??\n        this.hass.localize(\"ui.components.area-filter.title\")}\n      >\n        <ha-sortable\n          draggable-selector=\".draggable\"\n          handle-selector=\".handle\"\n          @item-moved=${this._areaMoved}\n        >\n          <mwc-list class=\"areas\">\n            ${repeat(\n              allAreas,\n              (area) => area,\n              (area, _idx) => {\n                const isVisible = !this._hidden.includes(area);\n                const name = this.hass!.areas[area]?.name || area;\n                return html`\n                  <ha-list-item\n                    class=${classMap({\n                      hidden: !isVisible,\n                      draggable: isVisible,\n                    })}\n                    hasMeta\n                    graphic=\"icon\"\n                    noninteractive\n                  >\n                    ${isVisible\n                      ? html`<ha-svg-icon\n                          class=\"handle\"\n                          .path=${mdiDrag}\n                          slot=\"graphic\"\n                        ></ha-svg-icon>`\n                      : nothing}\n                    ${name}\n                    <ha-icon-button\n                      tabindex=\"0\"\n                      class=\"action\"\n                      .path=${isVisible ? mdiEye : mdiEyeOff}\n                      slot=\"meta\"\n                      .label=${this.hass!.localize(\n                        `ui.components.area-filter.${\n                          isVisible ? \"hide\" : \"show\"\n                        }`,\n                        { area: name }\n                      )}\n                      .area=${area}\n                      @click=${this._toggle}\n                    ></ha-icon-button>\n                  </ha-list-item>\n                `;\n              }\n            )}\n          </mwc-list>\n        </ha-sortable>\n        <ha-button slot=\"secondaryAction\" dialogAction=\"cancel\">\n          ${this.hass.localize(\"ui.common.cancel\")}\n        </ha-button>\n        <ha-button @click=${this._submit} slot=\"primaryAction\">\n          ${this.hass.localize(\"ui.common.submit\")}\n        </ha-button>\n      </ha-dialog>\n    `;\n  }\n\n  private _toggle(ev) {\n    const area = ev.target.area;\n    const hidden = [...(this._hidden ?? [])];\n    if (hidden.includes(area)) {\n      hidden.splice(hidden.indexOf(area), 1);\n    } else {\n      hidden.push(area);\n    }\n    this._hidden = hidden;\n    const nonHiddenAreas = this._areas.filter(\n      (ar) => !this._hidden.includes(ar)\n    );\n    const hiddenAreas = this._areas.filter((ar) => this._hidden.includes(ar));\n    this._areas = [...nonHiddenAreas, ...hiddenAreas];\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyleDialog,\n      css`\n        ha-dialog {\n          /* Place above other dialogs */\n          --dialog-z-index: 104;\n          --dialog-content-padding: 0;\n        }\n        ha-list-item {\n          overflow: visible;\n        }\n        .hidden {\n          color: var(--disabled-text-color);\n        }\n        .handle {\n          cursor: move; /* fallback if grab cursor is unsupported */\n          cursor: grab;\n        }\n        .actions {\n          display: flex;\n          flex-direction: row;\n        }\n        ha-icon-button {\n          display: block;\n          margin: -12px;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-area-filter\": DialogAreaFilter;\n  }\n}\n"],"names":["DialogAreaFilter","_decorate","customElement","_initialize","_LitElement","F","constructor","args","d","kind","decorators","property","attribute","key","value","state","dialogParams","_dialogParams$initial","_dialogParams$initial2","_dialogParams$initial3","_dialogParams$initial4","this","_dialogParams","_hidden","initialValue","hidden","order","allAreas","Object","keys","hass","areas","_areas","concat","sort","areaCompare","undefined","fireEvent","dialog","localName","_this$_dialogParams","_this$_dialogParams$s","filter","area","includes","submit","call","closeDialog","_this$_dialogParams2","_this$_dialogParams2$","cancel","ev","stopPropagation","oldIndex","newIndex","detail","option","splice","_this$_dialogParams$t","nothing","html","_t","_","_cancel","title","localize","_areaMoved","repeat","_idx","_areas$area","isVisible","name","_t2","classMap","draggable","_t3","_toggle","_submit","_this$_hidden","target","indexOf","push","nonHiddenAreas","ar","hiddenAreas","static","haStyleDialog","css","_t4","LitElement"],"mappings":"4YAoBA,IACaA,GAAgBC,EAAAA,EAAAA,GAAA,EAD5BC,EAAAA,EAAAA,IAAc,wBAAqB,SAAAC,EAAAC,GAgLnC,OAAAC,EAhLD,cAC6BD,EAG7BE,WAAAA,IAAAC,GAAA,SAAAA,GAAAJ,EAAA,QAH6BK,EAAA,EAAAC,KAAA,QAAAC,WAAA,EAI1BC,EAAAA,EAAAA,IAAS,CAAEC,WAAW,KAAQC,IAAA,OAAAC,WAAA,IAAAL,KAAA,QAAAC,WAAA,EAE9BK,EAAAA,EAAAA,OAAOF,IAAA,gBAAAC,WAAA,IAAAL,KAAA,QAAAC,WAAA,EAEPK,EAAAA,EAAAA,OAAOF,IAAA,UAAAC,KAAAA,GAAA,MAA6B,EAAE,IAAAL,KAAA,QAAAC,WAAA,EAEtCK,EAAAA,EAAAA,OAAOF,IAAA,SAAAC,KAAAA,GAAA,MAA4B,EAAE,IAAAL,KAAA,SAAAI,IAAA,aAAAC,MAEtC,SAAkBE,GAA4C,IAAAC,EAAAC,EAAAC,EAAAC,EAC5DC,KAAKC,cAAgBN,EACrBK,KAAKE,QAA2C,QAApCN,EAA4B,QAA5BC,EAAGF,EAAaQ,oBAAY,IAAAN,OAAA,EAAzBA,EAA2BO,cAAM,IAAAR,EAAAA,EAAI,GACpD,MAAMS,EAAwC,QAAnCP,EAA4B,QAA5BC,EAAGJ,EAAaQ,oBAAY,IAAAJ,OAAA,EAAzBA,EAA2BM,aAAK,IAAAP,EAAAA,EAAI,GAC5CQ,EAAWC,OAAOC,KAAKR,KAAKS,KAAMC,OACxCV,KAAKW,OAASL,EAASM,SAASC,MAAKC,EAAAA,EAAAA,GAAYd,KAAKS,KAAMC,MAAOL,GACrE,GAAC,CAAAjB,KAAA,SAAAI,IAAA,cAAAC,MAED,WAKE,OAJAO,KAAKC,mBAAgBc,EACrBf,KAAKE,QAAU,GACfF,KAAKW,OAAS,IACdK,EAAAA,EAAAA,GAAUhB,KAAM,gBAAiB,CAAEiB,OAAQjB,KAAKkB,aACzC,CACT,GAAC,CAAA9B,KAAA,SAAAI,IAAA,UAAAC,MAED,WAAwB,IAAA0B,EAAAC,EACtB,MAAMf,EAAQL,KAAKW,OAAOU,QAAQC,IAAUtB,KAAKE,QAAQqB,SAASD,KAC5D7B,EAAyB,CAC7BW,OAAQJ,KAAKE,QACbG,SAEgB,QAAlBc,EAAAnB,KAAKC,qBAAa,IAAAkB,GAAQ,QAARC,EAAlBD,EAAoBK,cAAM,IAAAJ,GAA1BA,EAAAK,KAAAN,EAA6B1B,GAC7BO,KAAK0B,aACP,GAAC,CAAAtC,KAAA,SAAAI,IAAA,UAAAC,MAED,WAAwB,IAAAkC,EAAAC,EACJ,QAAlBD,EAAA3B,KAAKC,qBAAa,IAAA0B,GAAQ,QAARC,EAAlBD,EAAoBE,cAAM,IAAAD,GAA1BA,EAAAH,KAAAE,GACA3B,KAAK0B,aACP,GAAC,CAAAtC,KAAA,SAAAI,IAAA,aAAAC,MAED,SAAmBqC,GACjBA,EAAGC,kBACH,MAAM,SAAEC,EAAQ,SAAEC,GAAaH,EAAGI,OAE5BxB,EAAQV,KAAKW,OAAOC,SAEpBuB,EAASzB,EAAM0B,OAAOJ,EAAU,GAAG,GACzCtB,EAAM0B,OAAOH,EAAU,EAAGE,GAE1BnC,KAAKW,OAASD,CAChB,GAAC,CAAAtB,KAAA,SAAAI,IAAA,SAAAC,MAED,WAAmB,IAAA4C,EACjB,IAAKrC,KAAKC,gBAAkBD,KAAKS,KAC/B,OAAO6B,EAAAA,GAGT,MAAMhC,EAAWN,KAAKW,OAEtB,OAAO4B,EAAAA,EAAAA,IAAIC,IAAAA,EAAAC,CAAA;;;kBAAA;mBAAA;;;;;wBAAA;;;cAAA;;;;YAAA;;4BAAA;YAAA;;;OAGGzC,KAAK0C,QACoB,QADbL,EACXrC,KAAKC,cAAc0C,aAAK,IAAAN,EAAAA,EACnCrC,KAAKS,KAAKmC,SAAS,mCAKH5C,KAAK6C,YAGfC,EAAAA,EAAAA,GACAxC,GACCgB,GAASA,IACV,CAACA,EAAMyB,KAAS,IAAAC,EACd,MAAMC,GAAajD,KAAKE,QAAQqB,SAASD,GACnC4B,GAA6B,QAAtBF,EAAAhD,KAAKS,KAAMC,MAAMY,UAAK,IAAA0B,OAAA,EAAtBA,EAAwBE,OAAQ5B,EAC7C,OAAOiB,EAAAA,EAAAA,IAAIY,IAAAA,EAAAV,CAAA;;4BAAA;;;;;sBAAA;sBAAA;;;;8BAAA;;+BAAA;8BAAA;+BAAA;;;oBAECW,EAAAA,EAAAA,GAAS,CACfhD,QAAS6C,EACTI,UAAWJ,IAMXA,GACEV,EAAAA,EAAAA,IAAIe,IAAAA,EAAAb,CAAA;;kCAAA;;0CAjHS,qMAsHbH,EAAAA,GACFY,EAIQD,EA3HO,uzBA6HNjD,KAAKS,KAAMmC,SAClB,8BACEK,EAAY,OAAS,QAEvB,CAAE3B,KAAM4B,IAEF5B,EACCtB,KAAKuD,QAAO,IAS/BvD,KAAKS,KAAKmC,SAAS,oBAEH5C,KAAKwD,QACrBxD,KAAKS,KAAKmC,SAAS,oBAI7B,GAAC,CAAAxD,KAAA,SAAAI,IAAA,UAAAC,MAED,SAAgBqC,GAAI,IAAA2B,EAClB,MAAMnC,EAAOQ,EAAG4B,OAAOpC,KACjBlB,EAAS,IAAiB,QAAhBqD,EAAIzD,KAAKE,eAAO,IAAAuD,EAAAA,EAAI,IAChCrD,EAAOmB,SAASD,GAClBlB,EAAOgC,OAAOhC,EAAOuD,QAAQrC,GAAO,GAEpClB,EAAOwD,KAAKtC,GAEdtB,KAAKE,QAAUE,EACf,MAAMyD,EAAiB7D,KAAKW,OAAOU,QAChCyC,IAAQ9D,KAAKE,QAAQqB,SAASuC,KAE3BC,EAAc/D,KAAKW,OAAOU,QAAQyC,GAAO9D,KAAKE,QAAQqB,SAASuC,KACrE9D,KAAKW,OAAS,IAAIkD,KAAmBE,EACvC,GAAC,CAAA3E,KAAA,MAAA4E,QAAA,EAAAxE,IAAA,SAAAC,MAED,WACE,MAAO,CACLwE,EAAAA,IACAC,EAAAA,EAAAA,IAAGC,IAAAA,EAAA1B,CAAA;;;;;;;;;;;;;;;;;;;;;;;;UA0BP,IAAC,GA7KO2B,EAAAA,G"}