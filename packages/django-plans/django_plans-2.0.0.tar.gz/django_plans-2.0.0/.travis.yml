language: python
python:
  - "3.6"
  - "3.7"
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
services:
  - postgresql
env:
  - DJANGO_VERSION=2.0.*
  - DJANGO_VERSION=2.1.*
  - DJANGO_VERSION=2.2.*
  - DJANGO_VERSION=3.0.*
# command to install dependencies
install:
  - "pip install -q -e ."
  - "pip install flake8"
  - "pip install -q -r demo/requirements.txt"
  - "pip install -q Django==$DJANGO_VERSION"
  - "pip install codecov"

# command to run tests
script:
  - flake8
  - "cd demo && python manage.py makemigrations && coverage run manage.py test plans"

after_success:
  - codecov
